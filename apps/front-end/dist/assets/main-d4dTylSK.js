const Xs=JSON.parse(`{"app.title":"Simple Front","status.disconnected":"desconectado","status.ready":"listo","status.ws_error":"error de ws","status.connected":"conectado {ws} ws | viendo {accounts} cuenta(s)","tabs.login":"Login","tabs.trade":"Trade","tabs.risk":"Risk","tabs.admin":"Admin","menu.login_config":"Login / Configuración","menu.strategies":"Estrategias","menu.oms":"OMS","menu.ccxt_commands":"Comandos CCXT","menu.post_trading":"Post Trading","menu.system_monitor":"Consola del Sistema","menu.risk":"Riesgo","menu.admin":"Administración","menu.admin_oms_crud":"OMS CRUD","menu.api_keys":"API Keys","density.compact":"Compacto","density.normal":"Normal","density.spacious":"Espaciado","login.title":"Login","login.base_url":"URL Base","login.language":"Idioma","login.mode":"Modo","login.mode_api_key":"API Key","login.mode_user_password":"Usuario + Contraseña","login.api_key":"API Key","login.show":"mostrar","login.hide":"ocultar","login.user_name":"Usuario","login.password":"Contraseña","login.api_key_id_optional":"API Key ID (opcional)","login.authenticate":"Autenticar","trade.connection":"Conexión","trade.filter_accounts":"Filtrar Cuentas","trade.view_accounts":"Cuentas a ver","common.select_all":"Seleccionar todas","common.clear":"Limpiar","common.refresh":"Actualizar","common.previous":"Anterior","common.next":"Siguiente","common.page":"Página","common.page_size":"Items/Pág.","common.items_per_page":"Items/Página","common.start_date":"Fecha inicio","common.end_date":"Fecha fin","common.filter":"Filtrar","common.copy":"Copiar","common.export_csv":"Exportar CSV","common.export_excel":"Exportar Excel","common.export_json":"Exportar JSON","common.export_html":"Exportar HTML","common.send":"Enviar","common.change":"Cambiar","common.apply":"Aplicar","common.cancel":"Cancelar","common.close":"Cerrar","common.account_id":"ID de Cuenta","common.account_id_placeholder":"ej: 1","common.create":"Crear","common.load":"Cargar","common.save":"Guardar","common.no_data":"sin datos","common.enable":"Activar","common.disable":"Desactivar","common.optional":"opcional","common.value_or_null":"valor o null","trade.connect_ws":"Conectar WS","trade.disconnect_ws":"Desconectar","trade.refresh_tables":"Actualizar tablas","trade.load_accounts":"Recargar cuentas","trade.commands":"Comandos","cmd.send_order":"Enviar orden","cmd.cancel_order":"Cancelar orden","cmd.change_order":"Modificar orden","cmd.position_change":"Cambiar posición","cmd.position_close":"Cerrar posición","cmd.position_close_by":"Cerrar posición por close by","cmd.merge_positions":"Fusionar posiciones","cmd.load_symbols":"Cargar símbolos","cmd.cancel_ids":"Cancelar IDs","cmd.cancel_all_open":"Cancelar todas abiertas","cmd.run_ccxt":"Ejecutar CCXT","cmd.direct_ccxt":"Llamada CCXT directa","cmd.field.strategy":"Estrategia","cmd.field.symbol":"Símbolo","cmd.field.side":"Lado","cmd.field.type":"Tipo","cmd.field.qty":"Cantidad","cmd.field.price":"Precio","cmd.field.stop_loss":"OMS Stop Loss","cmd.field.stop_gain":"OMS Stop Gain","cmd.field.comment":"Comentario","cmd.field.params_json":"Parámetros adicionales JSON (CCXT)","cmd.field.reduce_only":"reduce_only","cmd.field.post_only":"post_only","cmd.field.time_in_force":"Time in Force","cmd.field.trigger_price":"Trigger Price","cmd.field.stop_price":"Stop Price","cmd.field.take_profit_price":"Take Profit Price","cmd.field.trailing_amount":"Trailing Amount","cmd.field.trailing_percent":"Trailing Percent","cmd.field.order_ids_csv":"Order IDs (1 o CSV)","cmd.field.account_id_cancel_all":"Account ID (Cancel All)","cmd.field.strategy_ids_csv_cancel_all":"Strategy IDs CSV (Cancel All, opcional)","cmd.field.order_id":"Order ID","cmd.field.new_qty":"New Qty","cmd.field.new_price":"New Price","cmd.field.position_id":"Position ID","cmd.field.position_id_a":"ID de Posición A","cmd.field.position_id_b":"ID de Posición B","cmd.field.close_by_qty":"Cantidad de Close By","cmd.field.source_position_id":"ID de Posición Origen","cmd.field.target_position_id":"ID de Posición Destino","cmd.field.stop_mode":"Modo de Stop","cmd.field.mode":"Modo","cmd.field.func":"Función","cmd.field.args_json":"Args JSON","cmd.field.kwargs_json":"Kwargs JSON","cmd.field.core_func":"Core Func","cmd.field.body_json":"Body JSON","cmd.field.result_json":"Result JSON","cmd.field.new_strategy_name":"nuevo nombre (opcional)","cmd.placeholder.required_for_limit":"obligatorio para limit","trade.strategies":"Estrategias","trade.create_strategy":"Agregar estrategia","trade.my_strategies":"Mis estrategias","trade.load_strategies":"Cargar estrategias","trade.name":"Nombre","trade.client_strategy_id":"ID de Estrategia del Cliente","trade.accounts":"Cuentas","trade.col_strategy_id":"Estrategia ID","trade.col_name":"Nombre","trade.col_client_strategy_id":"ID Estrategia Cliente","trade.col_status":"Estado","trade.col_account_ids":"Cuentas","trade.col_save":"Guardar","trade.col_toggle":"Alternar","admin.create_strategy":"Crear estrategia","risk.save_permission":"Guardar permiso","admin.title":"Admin","admin.create_account":"Crear cuenta","admin.create_user_key":"Crear usuario + API Key","admin.add_api_key":"Agregar API Key","admin.create_api_key":"Crear API Key","admin.api_key_auto_generate_placeholder":"vacío = generar automáticamente","admin.load_accounts":"Cargar cuentas","admin.load_users":"Cargar usuarios","admin.load_users_keys":"Cargar usuarios+claves","admin.accounts":"Cuentas","admin.users":"Usuarios","admin.users_keys":"Usuarios / API Keys","admin.oms_load_error":"Error al cargar Admin OMS","admin.oms_save_error":"Error al guardar","admin.oms_delete_error":"Error al eliminar","admin.oms_unlock_before_save":"Active 'Desbloquear modo peligroso' antes de guardar.","admin.oms_unlock_before_delete":"Active 'Desbloquear modo peligroso' antes de eliminar.","admin.oms_select_rows":"Seleccione una o más filas con el checkbox de la izquierda.","admin.oms_unlock_label":"Desbloquear modo peligroso","admin.oms_save_success":"Guardado con éxito ({count} fila(s)).","admin.oms_delete_success":"Eliminado con éxito ({count} fila(s)).","admin.oms_confirm_save":"Guardar {count} fila(s) en la base?","admin.oms_confirm_delete":"ELIMINAR {count} fila(s) de la base?","admin.api_key_created":"API Key creada. user_id={user_id} api_key_id={api_key_id} key={key}","admin.api_key_create_error":"Error al crear API Key","risk.title":"Risk","risk.account_controls":"Controles de riesgo por cuenta","risk.strategy_controls":"Controles de riesgo por estrategia","risk.api_permissions":"Permisos de API Key","risk.permission_rows":"Filas de permisos por API Key","risk.load_permissions":"Cargar permisos","risk.allow_new_positions":"Permitir nuevas posiciones","risk.block_new_positions":"Bloquear nuevas posiciones","risk.set_active":"Definir activa","risk.block_account":"Bloquear cuenta","risk.allow_strategy_opens":"Permitir apertura por estrategia","risk.block_strategy_opens":"Bloquear apertura por estrategia","risk.account_state_rows":"Estado de riesgo por cuenta","risk.strategy_state_rows":"Estado de riesgo por estrategia","risk.comment_required":"el comentario de riesgo es obligatorio","risk.comment_required_short":"motivo obligatorio","risk.strategy_id_invalid":"strategy_id inválido","trade.no_strategy_option":"0 - sin estrategia","positions.title":"Monitor de posiciones","positions.open_positions":"Posiciones abiertas","positions.open_orders":"Órdenes abiertas","positions.deals":"Deals","positions.history_positions":"Histórico de posiciones","positions.history_orders":"Histórico de Órdenes","positions.symbol_list":"Lista de símbolos","oms.close_selected_positions":"Cerrar seleccionadas","oms.cancel_selected_orders":"Cancelar seleccionadas","oms.select_open_positions_first":"Seleccione una o más posiciones abiertas primero.","oms.select_open_orders_first":"Seleccione una o más órdenes abiertas primero.","oms.bulk_close_positions_ok":"Cerrar posiciones seleccionadas: ok","oms.bulk_close_positions_partial":"Cerrar posiciones seleccionadas finalizado con errores","oms.bulk_close_positions_failed":"Error al cerrar posiciones seleccionadas","oms.bulk_cancel_orders_ok":"Cancelar órdenes seleccionadas: ok","oms.bulk_cancel_orders_partial":"Cancelar órdenes seleccionadas finalizado con errores","oms.bulk_cancel_orders_failed":"Error al cancelar órdenes seleccionadas","oms.col_id":"ID","oms.col_account_id":"Cuenta","oms.col_symbol":"Símbolo","oms.col_side":"Lado","oms.col_qty":"Cant","oms.col_status":"Estado","oms.col_price":"Precio","oms.col_updated_at":"Actualizado En","oms.col_avg_price":"Precio Medio","oms.col_stop_loss":"Stop Loss","oms.col_stop_gain":"Stop Gain","oms.col_state":"Estado","oms.col_comment":"Comentario","oms.col_opened_at":"Abierto En","oms.col_actions":"Acciones","oms.col_order_type":"Tipo Orden","oms.col_filled_qty":"Cant Llenada","oms.col_exchange_order_id":"ID Orden Exchange","oms.col_order_id":"ID Orden","oms.col_position_id":"ID Posición","oms.col_exchange_trade_id":"ID Trade Exchange","oms.col_executed_at":"Ejecutado En","oms.col_strategy_id":"ID Estrategia","oms.col_reason":"Motivo","oms.col_closed_at":"Cerrado En","oms.col_created_at":"Creado En","oms.col_client_order_id":"ID Orden Cliente","oms.col_avg_fill_price":"Precio Medio Ejec.","oms.col_command_id":"ID Comando","oms.col_fee":"Tarifa","oms.col_fee_currency":"Moneda Tarifa","oms.col_pnl":"PnL","oms.col_reconciled":"Reconciliado","oms.col_market_id":"ID de Mercado","oms.col_base":"Base","oms.col_quote":"Cotización","oms.col_market_type":"Tipo","oms.col_market_active":"Activo","oms.col_price_decimals":"Decimales Precio","oms.col_qty_decimals":"Decimales Cantidad","oms.col_price_min":"Precio Mínimo","oms.col_price_max":"Precio Máximo","oms.col_qty_min":"Cantidad Mínima","oms.col_qty_max":"Cantidad Máxima","oms.col_cost_min":"Costo Mínimo","oms.col_cost_max":"Costo Máximo","oms.col_tick_size":"Tick Size","oms.col_step_size":"Step Size","oms.col_previous_position_id":"ID posición anterior","system.ccxt_orders":"Órdenes CCXT","system.ccxt_trades":"Trades CCXT","system.ws_events":"Eventos WS","system.ui_logs":"Logs de UI","system.ui_logs_clear_view":"Limpiar vista","system.ui_logs_clear_db":"Borrar base local","system.col_seq":"Seq","system.col_at":"En","system.col_kind":"Tipo","system.col_payload":"Payload","system.col_level":"Nivel","system.col_message":"Mensaje","system.col_exchange_id":"Exchange","system.col_observed_at":"Observado En","system.col_raw":"Raw","post_trading.title":"Post Trading","post_trading.account_ids":"IDs de Cuenta CSV","post_trading.reconciled":"Reconciliado","post_trading.kinds":"Tipos","post_trading.order_statuses":"Estados de Orden CSV","post_trading.target_strategy_id":"ID Estrategia Objetivo","post_trading.target_position_id":"ID Posición Objetivo","post_trading.preview":"Preview","post_trading.apply":"Aplicar Reassign","post_trading.col_kind":"Tipo","post_trading.col_edit_replace_state":"Estado de reemplazo por edición","post_trading.col_edit_replace_at":"Fecha de reemplazo por edición","post_trading.col_replace_origin_order_id":"Orden origen del reemplazo","post_trading.col_replace_orphan_order_id":"Orden huérfana del reemplazo","post_trading.preview_result":"Preview: deals={deals} orders={orders}","post_trading.apply_result":"Aplicado: deals_updated={deals} orders_updated={orders}","post_trading.select_rows":"Seleccione una o más filas para aplicar el reassign.","post_trading.preview_error":"Error en preview","post_trading.apply_error":"Error al aplicar reassign","closeby.title":"Close By","closeby.source_position_id":"Posición de Origen ID","closeby.target_open_position":"Posición Abierta de Destino","closeby.source_prefix":"Origen","closeby.account":"cuenta","menu.user":"Usuario","user.profile":"Mi Perfil","user.tab_profile":"Perfil","user.tab_api_keys":"API Keys","user.user_id":"ID de Usuario","user.user_name":"Nombre de Usuario","user.role":"Rol","user.status":"Estado","user.current_api_key_id":"API Key Actual","user.save_profile":"Guardar Perfil","user.change_password":"Cambiar Contraseña","user.current_password":"Contraseña Actual","user.new_password":"Nueva Contraseña","user.save_password":"Guardar Contraseña","user.api_keys":"Mis API Keys","user.api_key_permissions":"Permisos por API Key","user.new_api_key_optional":"Nueva API Key (opcional)","user.create_api_key":"Crear API Key","user.load_api_keys":"Recargar API Keys","user.profile_updated":"Perfil actualizado con éxito.","user.profile_update_error":"Error al actualizar perfil","user.password_updated":"Contraseña actualizada con éxito.","user.password_update_error":"Error al actualizar contraseña","user.api_key_created":"API Key creada. id={api_key_id} key={key}","user.api_key_created_success":"API Key creada con éxito.","user.api_key_create_error":"Error al crear API Key","user.api_key_status_updated":"Estado de API Key actualizado.","user.api_key_status_update_error":"Error al actualizar estado de API Key","user.reloaded":"Datos de usuario recargados.","user.load_error":"Error al cargar datos de usuario","menu.post_trading_external_orders":"Órdenes Externas","post_trading.external_orders":"Órdenes Externas","post_trading.reconcile_scope":"Alcance de Reconciliación","post_trading.scope_short":"Corto","post_trading.scope_hourly":"Horario","post_trading.scope_long":"Largo","post_trading.scope_period":"Período","post_trading.reconcile":"Reconciliar","post_trading.reconcile_ok":"Reconciliación disparada: {count} cuenta(s).","post_trading.reconcile_error":"Error al reconciliar","post_trading.target_strategy_required":"Complete el ID de estrategia destino (> 0) en las filas seleccionadas.","admin.system_status":"Estado del Sistema","admin.refresh_status":"Actualizar estado","admin.clear_oms_cache":"Limpiar cache OMS","admin.clear_oms_cache_ok":"Cache OMS limpiado ({scope}, antes={count}).","admin.clear_oms_cache_error":"Error al limpiar cache OMS","admin.api_status":"API","admin.dispatcher_status":"Dispatcher","admin.status_error":"Error al consultar estado","post_trading.period_requires_date_range":"Para alcance Período, complete Fecha Inicio y Fecha Fin.","admin.api_key_permissions":"Permisos por API Key","admin.col_user_status":"Estado del Usuario","admin.col_api_key_id":"ID de API Key","admin.col_api_key_status":"Estado de API Key","risk.can_read":"Leer","risk.can_trade":"Operar","risk.can_close_position":"Cerrar Posicion","risk.can_risk_manage":"Gestionar Riesgo","risk.can_block_new_positions":"Bloquear Nuevas Posiciones","risk.can_block_account":"Bloquear Cuenta","risk.restrict_to_strategies":"Restringir a Estrategias","risk.strategy_ids":"IDs de Estrategia"}`),Ve={"pt-BR":JSON.parse(`{"app.title":"Simple Front","status.disconnected":"desconectado","status.ready":"pronto","status.ws_error":"erro de ws","status.connected":"conectado {ws} ws | visualizando {accounts} conta(s)","tabs.login":"Login","tabs.trade":"Trade","tabs.risk":"Risk","tabs.admin":"Admin","menu.login_config":"Login / Configuração","menu.strategies":"Estratégias","menu.oms":"OMS","menu.ccxt_commands":"Comandos CCXT","menu.post_trading":"Pós Trading","menu.system_monitor":"Console do Sistema","menu.risk":"Risco","menu.admin":"Administração","menu.admin_oms_crud":"OMS CRUD","menu.api_keys":"API Keys","menu.user":"Usuário","density.compact":"Compacto","density.normal":"Normal","density.spacious":"Espaçado","login.title":"Login","login.base_url":"Base URL","login.language":"Idioma","login.mode":"Modo","login.mode_api_key":"API Key","login.mode_user_password":"Usuário + Senha","login.api_key":"API Key","login.show":"mostrar","login.hide":"ocultar","login.user_name":"Usuário","login.password":"Senha","login.api_key_id_optional":"API Key ID (opcional)","login.authenticate":"Autenticar","user.profile":"Meu Perfil","user.tab_profile":"Perfil","user.tab_api_keys":"API Keys","user.user_id":"ID do Usuário","user.user_name":"Nome do Usuário","user.role":"Perfil","user.status":"Status","user.current_api_key_id":"API Key Atual","user.save_profile":"Salvar Perfil","user.change_password":"Alterar Senha","user.current_password":"Senha Atual","user.new_password":"Nova Senha","user.save_password":"Salvar Senha","user.api_keys":"Minhas API Keys","user.api_key_permissions":"Permissões por API Key","user.new_api_key_optional":"Nova API Key (opcional)","user.create_api_key":"Criar API Key","user.load_api_keys":"Recarregar API Keys","user.profile_updated":"Perfil atualizado com sucesso.","user.profile_update_error":"Erro ao atualizar perfil","user.password_updated":"Senha atualizada com sucesso.","user.password_update_error":"Erro ao atualizar senha","user.api_key_created":"API Key criada. id={api_key_id} key={key}","user.api_key_created_success":"API Key criada com sucesso.","user.api_key_create_error":"Erro ao criar API Key","user.api_key_status_updated":"Status da API Key atualizado.","user.api_key_status_update_error":"Erro ao atualizar status da API Key","user.reloaded":"Dados do usuário recarregados.","user.load_error":"Erro ao carregar dados do usuário","trade.connection":"Conexão","trade.filter_accounts":"Filtrar Contas","trade.view_accounts":"Contas para visualizar","common.select_all":"Selecionar todas","common.clear":"Limpar","common.refresh":"Atualizar","common.previous":"Anterior","common.next":"Próxima","common.page":"Página","common.page_size":"Itens/Pág.","common.items_per_page":"Itens/Página","common.start_date":"Data início","common.end_date":"Data fim","common.filter":"Filtrar","common.copy":"Copiar","common.export_csv":"Exportar CSV","common.export_excel":"Exportar Excel","common.export_json":"Exportar JSON","common.export_html":"Exportar HTML","common.send":"Enviar","common.change":"Alterar","common.apply":"Aplicar","common.cancel":"Cancelar","common.close":"Fechar","common.account_id":"ID da Conta","common.account_id_placeholder":"ex: 1","common.create":"Criar","common.load":"Carregar","common.save":"Salvar","common.no_data":"sem dados","common.enable":"Ativar","common.disable":"Desativar","common.optional":"opcional","common.value_or_null":"valor ou null","trade.connect_ws":"Conectar WS","trade.disconnect_ws":"Desconectar","trade.refresh_tables":"Atualizar tabelas","trade.load_accounts":"Recarregar contas","trade.commands":"Comandos","cmd.send_order":"Enviar ordem","cmd.cancel_order":"Cancelar ordem","cmd.change_order":"Alterar ordem","cmd.position_change":"Alterar posição","cmd.position_close":"Fechar posição","cmd.position_close_by":"Fechar posição com posição","cmd.merge_positions":"Mesclar posições","cmd.load_symbols":"Carregar símbolos","cmd.cancel_ids":"Cancelar IDs","cmd.cancel_all_open":"Cancelar todas abertas","cmd.run_ccxt":"Executar CCXT","cmd.direct_ccxt":"Chamada CCXT direta","cmd.field.strategy":"Estratégia","cmd.field.symbol":"Símbolo","cmd.field.side":"Lado","cmd.field.type":"Tipo","cmd.field.qty":"Quantidade","cmd.field.price":"Preço","cmd.field.stop_loss":"OMS Stop Loss","cmd.field.stop_gain":"OMS Stop Gain","cmd.field.comment":"Comentário","cmd.field.params_json":"Parâmetros adicionais JSON (CCXT)","cmd.field.reduce_only":"reduce_only","cmd.field.post_only":"post_only","cmd.field.time_in_force":"Tempo em Força (TIF)","cmd.field.trigger_price":"Preço de Disparo","cmd.field.stop_price":"Preço de Stop","cmd.field.take_profit_price":"Preço de Take Profit","cmd.field.trailing_amount":"Valor do Trailing","cmd.field.trailing_percent":"Percentual do Trailing","cmd.field.order_ids_csv":"IDs de Ordem (1 ou CSV)","cmd.field.account_id_cancel_all":"ID da Conta (Cancelar Todas)","cmd.field.strategy_ids_csv_cancel_all":"IDs de Estratégia CSV (Cancelar Todas, opcional)","cmd.field.order_id":"ID da Ordem","cmd.field.new_qty":"Nova Quantidade","cmd.field.new_price":"Novo Preço","cmd.field.position_id":"ID da Posição","cmd.field.position_id_a":"ID da Posição A","cmd.field.position_id_b":"ID da Posição B","cmd.field.close_by_qty":"Quantidade do Close By","cmd.field.source_position_id":"ID da Posição de Origem","cmd.field.target_position_id":"ID da Posição de Destino","cmd.field.stop_mode":"Modo de Stop","cmd.field.mode":"Modo","cmd.field.func":"Função","cmd.field.args_json":"Args JSON","cmd.field.kwargs_json":"Kwargs JSON","cmd.field.core_func":"Função Core","cmd.field.body_json":"Body JSON","cmd.field.result_json":"JSON de Resultado","cmd.field.new_strategy_name":"Novo nome (opcional)","cmd.placeholder.required_for_limit":"obrigatório para limit","trade.strategies":"Estratégias","trade.create_strategy":"Adicionar estratégia","trade.my_strategies":"Minhas estratégias","trade.load_strategies":"Carregar estratégias","trade.name":"Nome","trade.client_strategy_id":"ID da Estratégia do Cliente","trade.accounts":"Contas","trade.col_strategy_id":"Estratégia ID","trade.col_name":"Nome","trade.col_client_strategy_id":"ID Estratégia Cliente","trade.col_status":"Status","trade.col_account_ids":"Contas","trade.col_save":"Salvar","trade.col_toggle":"Alternar","admin.create_strategy":"Criar estratégia","risk.save_permission":"Salvar permissão","admin.title":"Admin","admin.create_account":"Criar conta","admin.create_user_key":"Criar usuário + API Key","admin.add_api_key":"Adicionar API Key","admin.create_api_key":"Criar API Key","admin.api_key_auto_generate_placeholder":"vazio = gerar automaticamente","admin.load_accounts":"Carregar contas","admin.load_users":"Carregar usuários","admin.load_users_keys":"Carregar usuários+chaves","admin.accounts":"Contas","admin.users":"Usuários","admin.users_keys":"Usuários / API Keys","admin.oms_load_error":"Erro ao carregar Admin OMS","admin.oms_save_error":"Erro ao salvar","admin.oms_delete_error":"Erro ao deletar","admin.oms_unlock_before_save":"Ative 'Destravar modo perigoso' antes de salvar.","admin.oms_unlock_before_delete":"Ative 'Destravar modo perigoso' antes de deletar.","admin.oms_select_rows":"Selecione uma ou mais linhas no checkbox da esquerda.","admin.oms_unlock_label":"Destravar modo perigoso","admin.oms_save_success":"Salvo com sucesso ({count} linha(s)).","admin.oms_delete_success":"Removido com sucesso ({count} linha(s)).","admin.oms_confirm_save":"Salvar {count} linha(s) no banco?","admin.oms_confirm_delete":"DELETAR {count} linha(s) do banco?","admin.api_key_created":"API Key criada. user_id={user_id} api_key_id={api_key_id} key={key}","admin.api_key_create_error":"Erro ao criar API Key","risk.title":"Risk","risk.account_controls":"Controles de risco por conta","risk.strategy_controls":"Controles de risco por estratégia","risk.api_permissions":"Permissões de API Key","risk.permission_rows":"Linhas de permissão por API Key","risk.load_permissions":"Carregar permissões","risk.allow_new_positions":"Permitir novas posições","risk.block_new_positions":"Bloquear novas posições","risk.set_active":"Definir ativa","risk.block_account":"Bloquear conta","risk.allow_strategy_opens":"Permitir abertura por estratégia","risk.block_strategy_opens":"Bloquear abertura por estratégia","risk.account_state_rows":"Estado de risco por conta","risk.strategy_state_rows":"Estado de risco por estratégia","risk.comment_required":"comentário de risco é obrigatório","risk.comment_required_short":"motivo obrigatório","risk.strategy_id_invalid":"strategy_id inválido","trade.no_strategy_option":"0 - sem estratégia","positions.title":"Monitor de posições","positions.open_positions":"Posições abertas","positions.open_orders":"Ordens abertas","positions.deals":"Negócios","positions.history_positions":"Histórico de posições","positions.history_orders":"Histórico de ordens","positions.symbol_list":"Lista de símbolos","oms.close_selected_positions":"Fechar selecionadas","oms.cancel_selected_orders":"Cancelar selecionadas","oms.select_open_positions_first":"Selecione uma ou mais posições abertas primeiro.","oms.select_open_orders_first":"Selecione uma ou mais ordens abertas primeiro.","oms.bulk_close_positions_ok":"Fechar posições selecionadas: ok","oms.bulk_close_positions_partial":"Fechar posições selecionadas finalizado com erros","oms.bulk_close_positions_failed":"Falha ao fechar posições selecionadas","oms.bulk_cancel_orders_ok":"Cancelar ordens selecionadas: ok","oms.bulk_cancel_orders_partial":"Cancelar ordens selecionadas finalizado com erros","oms.bulk_cancel_orders_failed":"Falha ao cancelar ordens selecionadas","oms.col_id":"ID","oms.col_account_id":"Conta","oms.col_symbol":"Símbolo","oms.col_side":"Lado","oms.col_qty":"Quantidade","oms.col_status":"Status","oms.col_price":"Preço","oms.col_updated_at":"Atualizado Em","oms.col_avg_price":"Preço Médio","oms.col_stop_loss":"Stop Loss","oms.col_stop_gain":"Stop Gain","oms.col_state":"Estado","oms.col_comment":"Comentário","oms.col_opened_at":"Aberto Em","oms.col_actions":"Ações","oms.col_order_type":"Tipo Ordem","oms.col_filled_qty":"Qtd Preenchida","oms.col_exchange_order_id":"ID Ordem Exchange","oms.col_order_id":"ID Ordem","oms.col_position_id":"ID Posição","oms.col_exchange_trade_id":"ID Trade Exchange","oms.col_executed_at":"Executado Em","oms.col_strategy_id":"ID Estratégia","oms.col_reason":"Motivo","oms.col_closed_at":"Fechado Em","oms.col_created_at":"Criado Em","oms.col_client_order_id":"ID Ordem Cliente","oms.col_avg_fill_price":"Preço Médio Exec.","oms.col_command_id":"ID Comando","oms.col_fee":"Taxa","oms.col_fee_currency":"Moeda Taxa","oms.col_pnl":"PnL","oms.col_reconciled":"Reconciliado","oms.col_market_id":"ID do Mercado","oms.col_base":"Base","oms.col_quote":"Cotação","oms.col_market_type":"Tipo","oms.col_market_active":"Ativo","oms.col_price_decimals":"Casas Preço","oms.col_qty_decimals":"Casas Quantidade","oms.col_price_min":"Preço Mínimo","oms.col_price_max":"Preço Máximo","oms.col_qty_min":"Quantidade Mínima","oms.col_qty_max":"Quantidade Máxima","oms.col_cost_min":"Custo Mínimo","oms.col_cost_max":"Custo Máximo","oms.col_tick_size":"Tick Size","oms.col_step_size":"Step Size","oms.col_previous_position_id":"Posição ID anterior","system.ccxt_orders":"Ordens CCXT","system.ccxt_trades":"Trades CCXT","system.ws_events":"Eventos WS","system.ui_logs":"Logs da UI","system.ui_logs_clear_view":"Limpar visualização","system.ui_logs_clear_db":"Apagar banco local","system.col_seq":"Seq","system.col_at":"Em","system.col_kind":"Tipo","system.col_payload":"Payload","system.col_level":"Nível","system.col_message":"Mensagem","system.col_exchange_id":"Exchange","system.col_observed_at":"Observado Em","system.col_raw":"Raw","post_trading.title":"Pós Trading","post_trading.account_ids":"IDs de Conta CSV","post_trading.reconciled":"Reconciliado","post_trading.kinds":"Tipos","post_trading.order_statuses":"Status de Ordens CSV","post_trading.target_strategy_id":"ID Estratégia Alvo","post_trading.target_position_id":"ID Posição Alvo","post_trading.preview":"Preview","post_trading.apply":"Aplicar Reassign","post_trading.col_kind":"Tipo","post_trading.col_edit_replace_state":"Estado do replace por edição","post_trading.col_edit_replace_at":"Data do replace por edição","post_trading.col_replace_origin_order_id":"Ordem origem do replace","post_trading.col_replace_orphan_order_id":"Ordem órfã do replace","post_trading.preview_result":"Preview: deals={deals} orders={orders}","post_trading.apply_result":"Aplicado: deals_updated={deals} orders_updated={orders}","post_trading.select_rows":"Selecione uma ou mais linhas para aplicar o reassign.","post_trading.preview_error":"Erro no preview","post_trading.apply_error":"Erro ao aplicar reassign","closeby.title":"Close By","closeby.source_position_id":"Posição de Origem ID","closeby.target_open_position":"Posição Aberta de Destino","closeby.source_prefix":"Origem","closeby.account":"conta","menu.post_trading_external_orders":"Ordens Externas","post_trading.external_orders":"Ordens Externas","post_trading.reconcile_scope":"Escopo de Reconciliação","post_trading.scope_short":"Curto","post_trading.scope_hourly":"Horário","post_trading.scope_long":"Longo","post_trading.scope_period":"Período","post_trading.reconcile":"Reconciliar","post_trading.reconcile_ok":"Reconciliação disparada: {count} conta(s).","post_trading.reconcile_error":"Erro ao reconciliar","post_trading.target_strategy_required":"Preencha o ID da estratégia alvo (> 0) nas linhas selecionadas.","admin.system_status":"Estado do Sistema","admin.refresh_status":"Atualizar estado","admin.clear_oms_cache":"Limpar cache OMS","admin.clear_oms_cache_ok":"Cache OMS limpo ({scope}, antes={count}).","admin.clear_oms_cache_error":"Erro ao limpar cache OMS","admin.api_status":"API","admin.dispatcher_status":"Dispatcher","admin.status_error":"Erro ao consultar estado","post_trading.period_requires_date_range":"Para scope Período, preencha Data Início e Data Fim.","admin.api_key_permissions":"Permissoes por API Key","admin.col_user_status":"Status do Usuario","admin.col_api_key_id":"ID da API Key","admin.col_api_key_status":"Status da API Key","risk.can_read":"Ler","risk.can_trade":"Negociar","risk.can_close_position":"Fechar Posicao","risk.can_risk_manage":"Gerenciar Risco","risk.can_block_new_positions":"Bloquear Novas Posicoes","risk.can_block_account":"Bloquear Conta","risk.restrict_to_strategies":"Restringir as Estrategias","risk.strategy_ids":"IDs de Estrategia"}`),"en-US":JSON.parse(`{"app.title":"Simple Front","status.disconnected":"disconnected","status.ready":"ready","status.ws_error":"ws error","status.connected":"connected {ws} ws | viewing {accounts} account(s)","tabs.login":"Login","tabs.trade":"Trade","tabs.risk":"Risk","tabs.admin":"Admin","menu.login_config":"Login / Config","menu.strategies":"Strategies","menu.oms":"OMS","menu.ccxt_commands":"CCXT Commands","menu.post_trading":"Post Trading","menu.system_monitor":"System Console","menu.risk":"Risk","menu.admin":"Administrator","menu.admin_oms_crud":"OMS CRUD","menu.api_keys":"API Keys","density.compact":"Compact","density.normal":"Normal","density.spacious":"Spacious","login.title":"Login","login.base_url":"Base URL","login.language":"Language","login.mode":"Mode","login.mode_api_key":"API Key","login.mode_user_password":"User + Password","login.api_key":"API Key","login.show":"show","login.hide":"hide","login.user_name":"User Name","login.password":"Password","login.api_key_id_optional":"API Key ID (optional)","login.authenticate":"Authenticate","user.profile":"My Profile","user.tab_profile":"Profile","user.tab_api_keys":"API Keys","user.user_id":"User ID","user.user_name":"User Name","user.role":"Role","user.status":"Status","user.current_api_key_id":"Current API Key","user.save_profile":"Save Profile","user.change_password":"Change Password","user.current_password":"Current Password","user.new_password":"New Password","user.save_password":"Save Password","user.api_keys":"My API Keys","user.api_key_permissions":"Permissions by API Key","user.new_api_key_optional":"New API Key (optional)","user.create_api_key":"Create API Key","user.load_api_keys":"Reload API Keys","user.profile_updated":"Profile updated successfully.","user.profile_update_error":"Failed to update profile","user.password_updated":"Password updated successfully.","user.password_update_error":"Failed to update password","user.api_key_created":"API Key created. id={api_key_id} key={key}","user.api_key_created_success":"API Key created successfully.","user.api_key_create_error":"Failed to create API Key","user.api_key_status_updated":"API Key status updated.","user.api_key_status_update_error":"Failed to update API Key status","user.reloaded":"User data reloaded.","user.load_error":"Failed to load user data","trade.connection":"Connection","trade.filter_accounts":"Filter Accounts","trade.view_accounts":"View Accounts","common.select_all":"Select All","common.clear":"Clear","common.refresh":"Refresh","common.previous":"Previous","common.next":"Next","common.page":"Page","common.page_size":"Items/Page","common.items_per_page":"Items/Page","common.start_date":"Start Date","common.end_date":"End Date","common.filter":"Filter","common.copy":"Copy","common.export_csv":"Export CSV","common.export_excel":"Export Excel","common.export_json":"Export JSON","common.export_html":"Export HTML","common.send":"Send","common.change":"Change","common.apply":"Apply","common.cancel":"Cancel","common.close":"Close","common.account_id":"Account ID","common.account_id_placeholder":"e.g. 1","common.create":"Create","common.load":"Load","common.save":"Save","common.no_data":"no data","common.enable":"Enable","common.disable":"Disable","common.optional":"optional","common.value_or_null":"value or null","trade.connect_ws":"Connect WS","trade.disconnect_ws":"Disconnect","trade.refresh_tables":"Refresh Tables","trade.load_accounts":"Reload Accounts","trade.commands":"Commands","cmd.send_order":"Send Order","cmd.cancel_order":"Cancel Order","cmd.change_order":"Change Order","cmd.position_change":"Position Change","cmd.position_close":"Position Close","cmd.position_close_by":"Position Close By","cmd.merge_positions":"Merge Positions","cmd.load_symbols":"Load Symbols","cmd.cancel_ids":"Cancel IDs","cmd.cancel_all_open":"Cancel All Open","cmd.run_ccxt":"Run CCXT","cmd.direct_ccxt":"Direct CCXT Call","cmd.field.strategy":"Strategy","cmd.field.symbol":"Symbol","cmd.field.side":"Side","cmd.field.type":"Type","cmd.field.qty":"Qty","cmd.field.price":"Price","cmd.field.stop_loss":"OMS Stop Loss","cmd.field.stop_gain":"OMS Stop Gain","cmd.field.comment":"Comment","cmd.field.params_json":"Additional JSON Parameters (CCXT)","cmd.field.reduce_only":"reduce_only","cmd.field.post_only":"post_only","cmd.field.time_in_force":"Time in Force","cmd.field.trigger_price":"Trigger Price","cmd.field.stop_price":"Stop Price","cmd.field.take_profit_price":"Take Profit Price","cmd.field.trailing_amount":"Trailing Amount","cmd.field.trailing_percent":"Trailing Percent","cmd.field.order_ids_csv":"Order IDs (1 or CSV)","cmd.field.account_id_cancel_all":"Account ID (Cancel All)","cmd.field.strategy_ids_csv_cancel_all":"Strategy IDs CSV (Cancel All, optional)","cmd.field.order_id":"Order ID","cmd.field.new_qty":"New Qty","cmd.field.new_price":"New Price","cmd.field.position_id":"Position ID","cmd.field.position_id_a":"Position ID A","cmd.field.position_id_b":"Position ID B","cmd.field.close_by_qty":"Close By Qty","cmd.field.source_position_id":"Source Position ID","cmd.field.target_position_id":"Target Position ID","cmd.field.stop_mode":"Stop Mode","cmd.field.mode":"Mode","cmd.field.func":"Func","cmd.field.args_json":"Args JSON","cmd.field.kwargs_json":"Kwargs JSON","cmd.field.core_func":"Core Func","cmd.field.body_json":"Body JSON","cmd.field.result_json":"Result JSON","cmd.field.new_strategy_name":"new name (optional)","cmd.placeholder.required_for_limit":"required for limit","trade.strategies":"Strategies","trade.create_strategy":"Add Strategy","trade.my_strategies":"My Strategies","trade.load_strategies":"Load Strategies","trade.name":"Name","trade.client_strategy_id":"Client Strategy ID","trade.accounts":"Accounts","trade.col_strategy_id":"Strategy ID","trade.col_name":"Name","trade.col_client_strategy_id":"Client Strategy ID","trade.col_status":"Status","trade.col_account_ids":"Accounts","trade.col_save":"Save","trade.col_toggle":"Toggle","admin.create_strategy":"Create Strategy","risk.save_permission":"Save Permission","admin.title":"Admin","admin.create_account":"Create Account","admin.create_user_key":"Create User + API Key","admin.add_api_key":"Add API Key","admin.create_api_key":"Create API Key","admin.api_key_auto_generate_placeholder":"empty = auto-generate","admin.load_accounts":"Load Accounts","admin.load_users":"Load Users","admin.load_users_keys":"Load Users+Keys","admin.accounts":"Accounts","admin.users":"Users","admin.users_keys":"Users / API Keys","admin.oms_load_error":"Failed to load Admin OMS","admin.oms_save_error":"Save failed","admin.oms_delete_error":"Delete failed","admin.oms_unlock_before_save":"Enable 'Unlock dangerous mode' before saving.","admin.oms_unlock_before_delete":"Enable 'Unlock dangerous mode' before deleting.","admin.oms_select_rows":"Select one or more rows using the left checkbox.","admin.oms_unlock_label":"Unlock dangerous mode","admin.oms_save_success":"Saved successfully ({count} row(s)).","admin.oms_delete_success":"Deleted successfully ({count} row(s)).","admin.oms_confirm_save":"Save {count} row(s) to database?","admin.oms_confirm_delete":"DELETE {count} row(s) from database?","admin.api_key_created":"API Key created. user_id={user_id} api_key_id={api_key_id} key={key}","admin.api_key_create_error":"Failed to create API Key","risk.title":"Risk","risk.account_controls":"Account Risk Controls","risk.strategy_controls":"Strategy Risk Controls","risk.api_permissions":"API Key Permissions","risk.permission_rows":"API Key Permission Rows","risk.load_permissions":"Load Permissions","risk.allow_new_positions":"Allow New Positions","risk.block_new_positions":"Block New Positions","risk.set_active":"Set Active","risk.block_account":"Block Account","risk.allow_strategy_opens":"Allow Strategy Opens","risk.block_strategy_opens":"Block Strategy Opens","risk.account_state_rows":"Account Risk State","risk.strategy_state_rows":"Strategy Risk State","risk.comment_required":"risk comment is required","risk.comment_required_short":"required reason","risk.strategy_id_invalid":"invalid strategy_id","trade.no_strategy_option":"0 - no strategy","positions.title":"Position Monitor","positions.open_positions":"Open Positions","positions.open_orders":"Open Orders","positions.deals":"Deals","positions.history_positions":"History Positions","positions.history_orders":"History Orders","positions.symbol_list":"Symbol List","oms.close_selected_positions":"Close Selected","oms.cancel_selected_orders":"Cancel Selected","oms.select_open_positions_first":"Select one or more open positions first.","oms.select_open_orders_first":"Select one or more open orders first.","oms.bulk_close_positions_ok":"Close selected positions: ok","oms.bulk_close_positions_partial":"Close selected positions finished with errors","oms.bulk_close_positions_failed":"Close selected positions failed","oms.bulk_cancel_orders_ok":"Cancel selected orders: ok","oms.bulk_cancel_orders_partial":"Cancel selected orders finished with errors","oms.bulk_cancel_orders_failed":"Cancel selected orders failed","oms.col_id":"ID","oms.col_account_id":"Account","oms.col_symbol":"Symbol","oms.col_side":"Side","oms.col_qty":"Qty","oms.col_status":"Status","oms.col_price":"Price","oms.col_updated_at":"Updated At","oms.col_avg_price":"Avg Price","oms.col_stop_loss":"Stop Loss","oms.col_stop_gain":"Stop Gain","oms.col_state":"State","oms.col_comment":"Comment","oms.col_opened_at":"Opened At","oms.col_actions":"Actions","oms.col_order_type":"Order Type","oms.col_filled_qty":"Filled Qty","oms.col_exchange_order_id":"Exchange Order ID","oms.col_order_id":"Order ID","oms.col_position_id":"Position ID","oms.col_exchange_trade_id":"Exchange Trade ID","oms.col_executed_at":"Executed At","oms.col_strategy_id":"Strategy ID","oms.col_reason":"Reason","oms.col_closed_at":"Closed At","oms.col_created_at":"Created At","oms.col_client_order_id":"Client Order ID","oms.col_avg_fill_price":"Avg Fill Price","oms.col_command_id":"Command ID","oms.col_fee":"Fee","oms.col_fee_currency":"Fee Ccy","oms.col_pnl":"PnL","oms.col_reconciled":"Reconciled","oms.col_market_id":"Market ID","oms.col_base":"Base","oms.col_quote":"Quote","oms.col_market_type":"Type","oms.col_market_active":"Active","oms.col_price_decimals":"Price Decimals","oms.col_qty_decimals":"Qty Decimals","oms.col_price_min":"Min Price","oms.col_price_max":"Max Price","oms.col_qty_min":"Min Qty","oms.col_qty_max":"Max Qty","oms.col_cost_min":"Min Cost","oms.col_cost_max":"Max Cost","oms.col_tick_size":"Tick Size","oms.col_step_size":"Step Size","oms.col_previous_position_id":"Previous Position ID","system.ccxt_orders":"CCXT Orders","system.ccxt_trades":"CCXT Trades","system.ws_events":"WS Events","system.ui_logs":"UI Logs","system.ui_logs_clear_view":"Clear View","system.ui_logs_clear_db":"Clear Local DB","system.col_seq":"Seq","system.col_at":"At","system.col_kind":"Kind","system.col_payload":"Payload","system.col_level":"Level","system.col_message":"Message","system.col_exchange_id":"Exchange","system.col_observed_at":"Observed At","system.col_raw":"Raw","post_trading.title":"Post Trading","post_trading.account_ids":"Account IDs CSV","post_trading.reconciled":"Reconciled","post_trading.kinds":"Kinds","post_trading.order_statuses":"Order Statuses CSV","post_trading.target_strategy_id":"Target Strategy ID","post_trading.target_position_id":"Target Position ID","post_trading.preview":"Preview","post_trading.apply":"Apply Reassign","post_trading.col_kind":"Kind","post_trading.col_edit_replace_state":"Edit Replace State","post_trading.col_edit_replace_at":"Edit Replace At","post_trading.col_replace_origin_order_id":"Replace Origin Order","post_trading.col_replace_orphan_order_id":"Replace Orphan Order","post_trading.preview_result":"Preview: deals={deals} orders={orders}","post_trading.apply_result":"Applied: deals_updated={deals} orders_updated={orders}","post_trading.select_rows":"Select one or more rows to apply reassign.","post_trading.preview_error":"Preview failed","post_trading.apply_error":"Apply reassign failed","closeby.title":"Close By","closeby.source_position_id":"Source Position ID","closeby.target_open_position":"Target Open Position","closeby.source_prefix":"Source","closeby.account":"account","menu.user":"User","menu.post_trading_external_orders":"External Orders","post_trading.external_orders":"External Orders","post_trading.reconcile_scope":"Reconcile Scope","post_trading.scope_short":"Short","post_trading.scope_hourly":"Hourly","post_trading.scope_long":"Long","post_trading.scope_period":"Period","post_trading.reconcile":"Reconcile","post_trading.reconcile_ok":"Reconcile triggered: {count} account(s).","post_trading.reconcile_error":"Reconcile failed","post_trading.target_strategy_required":"Fill target strategy ID (> 0) on selected rows.","admin.system_status":"System Status","admin.refresh_status":"Refresh status","admin.clear_oms_cache":"Clear OMS cache","admin.clear_oms_cache_ok":"OMS cache cleared ({scope}, before={count}).","admin.clear_oms_cache_error":"Failed to clear OMS cache","admin.api_status":"API","admin.dispatcher_status":"Dispatcher","admin.status_error":"Failed to query status","post_trading.period_requires_date_range":"For Period scope, fill Start Date and End Date.","admin.api_key_permissions":"API Key Permissions","admin.col_user_status":"User Status","admin.col_api_key_id":"API Key ID","admin.col_api_key_status":"API Key Status","risk.can_read":"Read","risk.can_trade":"Trade","risk.can_close_position":"Close Position","risk.can_risk_manage":"Risk Manage","risk.can_block_new_positions":"Block New Positions","risk.can_block_account":"Block Account","risk.restrict_to_strategies":"Restrict To Strategies","risk.strategy_ids":"Strategy IDs"}`),es:Xs};var Ys=()=>({checkValidity(t){const e=t.input,o={message:"",isValid:!0,invalidKeys:[]};if(!e)return o;let s=!0;if("checkValidity"in e&&(s=e.checkValidity()),s)return o;if(o.isValid=!1,"validationMessage"in e&&(o.message=e.validationMessage),!("validity"in e))return o.invalidKeys.push("customError"),o;for(const i in e.validity){if(i==="valid")continue;const r=i;e.validity[r]&&o.invalidKeys.push(r)}return o}});var Jo=class extends Event{constructor(){super("wa-invalid",{bubbles:!0,cancelable:!1,composed:!0})}};var Zs=Object.defineProperty,ei=Object.getOwnPropertyDescriptor,Qo=t=>{throw TypeError(t)},w=(t,e,o,s)=>{for(var i=s>1?void 0:s?ei(e,o):e,r=t.length-1,n;r>=0;r--)(n=t[r])&&(i=(s?n(e,o,i):n(i))||i);return s&&i&&Zs(e,o,i),i},Xo=(t,e,o)=>e.has(t)||Qo("Cannot "+o),ti=(t,e,o)=>(Xo(t,e,"read from private field"),e.get(t)),oi=(t,e,o)=>e.has(t)?Qo("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),si=(t,e,o,s)=>(Xo(t,e,"write to private field"),e.set(t,o),o);const gt=globalThis,so=gt.ShadowRoot&&(gt.ShadyCSS===void 0||gt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,io=Symbol(),vo=new WeakMap;let Yo=class{constructor(e,o,s){if(this._$cssResult$=!0,s!==io)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=o}get styleSheet(){let e=this.o;const o=this.t;if(so&&e===void 0){const s=o!==void 0&&o.length===1;s&&(e=vo.get(o)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&vo.set(o,e))}return e}toString(){return this.cssText}};const ii=t=>new Yo(typeof t=="string"?t:t+"",void 0,io),te=(t,...e)=>{const o=t.length===1?t[0]:e.reduce((s,i,r)=>s+(n=>{if(n._$cssResult$===!0)return n.cssText;if(typeof n=="number")return n;throw Error("Value passed to 'css' function must be a 'css' function result: "+n+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[r+1],t[0]);return new Yo(o,t,io)},ri=(t,e)=>{if(so)t.adoptedStyleSheets=e.map(o=>o instanceof CSSStyleSheet?o:o.styleSheet);else for(const o of e){const s=document.createElement("style"),i=gt.litNonce;i!==void 0&&s.setAttribute("nonce",i),s.textContent=o.cssText,t.appendChild(s)}},So=so?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let o="";for(const s of e.cssRules)o+=s.cssText;return ii(o)})(t):t;const{is:ai,defineProperty:ni,getOwnPropertyDescriptor:ci,getOwnPropertyNames:li,getOwnPropertySymbols:di,getPrototypeOf:ui}=Object,It=globalThis,ko=It.trustedTypes,mi=ko?ko.emptyScript:"",_i=It.reactiveElementPolyfillSupport,Ke=(t,e)=>t,yt={toAttribute(t,e){switch(e){case Boolean:t=t?mi:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let o=t;switch(e){case Boolean:o=t!==null;break;case Number:o=t===null?null:Number(t);break;case Object:case Array:try{o=JSON.parse(t)}catch{o=null}}return o}},ro=(t,e)=>!ai(t,e),Ao={attribute:!0,type:String,converter:yt,reflect:!1,useDefault:!1,hasChanged:ro};Symbol.metadata??=Symbol("metadata"),It.litPropertyMetadata??=new WeakMap;let $e=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,o=Ao){if(o.state&&(o.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((o=Object.create(o)).wrapped=!0),this.elementProperties.set(e,o),!o.noAccessor){const s=Symbol(),i=this.getPropertyDescriptor(e,s,o);i!==void 0&&ni(this.prototype,e,i)}}static getPropertyDescriptor(e,o,s){const{get:i,set:r}=ci(this.prototype,e)??{get(){return this[o]},set(n){this[o]=n}};return{get:i,set(n){const c=i?.call(this);r?.call(this,n),this.requestUpdate(e,c,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Ao}static _$Ei(){if(this.hasOwnProperty(Ke("elementProperties")))return;const e=ui(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ke("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ke("properties"))){const o=this.properties,s=[...li(o),...di(o)];for(const i of s)this.createProperty(i,o[i])}const e=this[Symbol.metadata];if(e!==null){const o=litPropertyMetadata.get(e);if(o!==void 0)for(const[s,i]of o)this.elementProperties.set(s,i)}this._$Eh=new Map;for(const[o,s]of this.elementProperties){const i=this._$Eu(o,s);i!==void 0&&this._$Eh.set(i,o)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const o=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const i of s)o.unshift(So(i))}else e!==void 0&&o.push(So(e));return o}static _$Eu(e,o){const s=o.attribute;return s===!1?void 0:typeof s=="string"?s:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,o=this.constructor.elementProperties;for(const s of o.keys())this.hasOwnProperty(s)&&(e.set(s,this[s]),delete this[s]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return ri(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,o,s){this._$AK(e,s)}_$ET(e,o){const s=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,s);if(i!==void 0&&s.reflect===!0){const r=(s.converter?.toAttribute!==void 0?s.converter:yt).toAttribute(o,s.type);this._$Em=e,r==null?this.removeAttribute(i):this.setAttribute(i,r),this._$Em=null}}_$AK(e,o){const s=this.constructor,i=s._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const r=s.getPropertyOptions(i),n=typeof r.converter=="function"?{fromAttribute:r.converter}:r.converter?.fromAttribute!==void 0?r.converter:yt;this._$Em=i;const c=n.fromAttribute(o,r.type);this[i]=c??this._$Ej?.get(i)??c,this._$Em=null}}requestUpdate(e,o,s,i=!1,r){if(e!==void 0){const n=this.constructor;if(i===!1&&(r=this[e]),s??=n.getPropertyOptions(e),!((s.hasChanged??ro)(r,o)||s.useDefault&&s.reflect&&r===this._$Ej?.get(e)&&!this.hasAttribute(n._$Eu(e,s))))return;this.C(e,o,s)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,o,{useDefault:s,reflect:i,wrapped:r},n){s&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,n??o??this[e]),r!==!0||n!==void 0)||(this._$AL.has(e)||(this.hasUpdated||s||(o=void 0),this._$AL.set(e,o)),i===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(o){Promise.reject(o)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[i,r]of this._$Ep)this[i]=r;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,r]of s){const{wrapped:n}=r,c=this[i];n!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,r,c)}}let e=!1;const o=this._$AL;try{e=this.shouldUpdate(o),e?(this.willUpdate(o),this._$EO?.forEach(s=>s.hostUpdate?.()),this.update(o)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(o)}willUpdate(e){}_$AE(e){this._$EO?.forEach(o=>o.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(o=>this._$ET(o,this[o])),this._$EM()}updated(e){}firstUpdated(e){}};$e.elementStyles=[],$e.shadowRootOptions={mode:"open"},$e[Ke("elementProperties")]=new Map,$e[Ke("finalized")]=new Map,_i?.({ReactiveElement:$e}),(It.reactiveElementVersions??=[]).push("2.1.2");const ao=globalThis,Co=t=>t,bt=ao.trustedTypes,xo=bt?bt.createPolicy("lit-html",{createHTML:t=>t}):void 0,Zo="$lit$",me=`lit$${Math.random().toFixed(9).slice(2)}$`,es="?"+me,pi=`<${es}>`,Ce=document,We=()=>Ce.createComment(""),Ge=t=>t===null||typeof t!="object"&&typeof t!="function",no=Array.isArray,gi=t=>no(t)||typeof t?.[Symbol.iterator]=="function",Ft=`[ 	
\f\r]`,qe=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Lo=/-->/g,Eo=/>/g,fe=RegExp(`>|${Ft}(?:([^\\s"'>=/]+)(${Ft}*=${Ft}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Io=/'/g,Po=/"/g,ts=/^(?:script|style|textarea|title)$/i,hi=t=>(e,...o)=>({_$litType$:t,strings:e,values:o}),J=hi(1),xe=Symbol.for("lit-noChange"),q=Symbol.for("lit-nothing"),$o=new WeakMap,ve=Ce.createTreeWalker(Ce,129);function os(t,e){if(!no(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return xo!==void 0?xo.createHTML(e):e}const fi=(t,e)=>{const o=t.length-1,s=[];let i,r=e===2?"<svg>":e===3?"<math>":"",n=qe;for(let c=0;c<o;c++){const u=t[c];let g,f,y=-1,v=0;for(;v<u.length&&(n.lastIndex=v,f=n.exec(u),f!==null);)v=n.lastIndex,n===qe?f[1]==="!--"?n=Lo:f[1]!==void 0?n=Eo:f[2]!==void 0?(ts.test(f[2])&&(i=RegExp("</"+f[2],"g")),n=fe):f[3]!==void 0&&(n=fe):n===fe?f[0]===">"?(n=i??qe,y=-1):f[1]===void 0?y=-2:(y=n.lastIndex-f[2].length,g=f[1],n=f[3]===void 0?fe:f[3]==='"'?Po:Io):n===Po||n===Io?n=fe:n===Lo||n===Eo?n=qe:(n=fe,i=void 0);const I=n===fe&&t[c+1].startsWith("/>")?" ":"";r+=n===qe?u+pi:y>=0?(s.push(g),u.slice(0,y)+Zo+u.slice(y)+me+I):u+me+(y===-2?c:I)}return[os(t,r+(t[o]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),s]};class Je{constructor({strings:e,_$litType$:o},s){let i;this.parts=[];let r=0,n=0;const c=e.length-1,u=this.parts,[g,f]=fi(e,o);if(this.el=Je.createElement(g,s),ve.currentNode=this.el.content,o===2||o===3){const y=this.el.content.firstChild;y.replaceWith(...y.childNodes)}for(;(i=ve.nextNode())!==null&&u.length<c;){if(i.nodeType===1){if(i.hasAttributes())for(const y of i.getAttributeNames())if(y.endsWith(Zo)){const v=f[n++],I=i.getAttribute(y).split(me),$=/([.?@])?(.*)/.exec(v);u.push({type:1,index:r,name:$[2],strings:I,ctor:$[1]==="."?bi:$[1]==="?"?wi:$[1]==="@"?vi:Pt}),i.removeAttribute(y)}else y.startsWith(me)&&(u.push({type:6,index:r}),i.removeAttribute(y));if(ts.test(i.tagName)){const y=i.textContent.split(me),v=y.length-1;if(v>0){i.textContent=bt?bt.emptyScript:"";for(let I=0;I<v;I++)i.append(y[I],We()),ve.nextNode(),u.push({type:2,index:++r});i.append(y[v],We())}}}else if(i.nodeType===8)if(i.data===es)u.push({type:2,index:r});else{let y=-1;for(;(y=i.data.indexOf(me,y+1))!==-1;)u.push({type:7,index:r}),y+=me.length-1}r++}}static createElement(e,o){const s=Ce.createElement("template");return s.innerHTML=e,s}}function Be(t,e,o=t,s){if(e===xe)return e;let i=s!==void 0?o._$Co?.[s]:o._$Cl;const r=Ge(e)?void 0:e._$litDirective$;return i?.constructor!==r&&(i?._$AO?.(!1),r===void 0?i=void 0:(i=new r(t),i._$AT(t,o,s)),s!==void 0?(o._$Co??=[])[s]=i:o._$Cl=i),i!==void 0&&(e=Be(t,i._$AS(t,e.values),i,s)),e}class yi{constructor(e,o){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=o}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:o},parts:s}=this._$AD,i=(e?.creationScope??Ce).importNode(o,!0);ve.currentNode=i;let r=ve.nextNode(),n=0,c=0,u=s[0];for(;u!==void 0;){if(n===u.index){let g;u.type===2?g=new Ye(r,r.nextSibling,this,e):u.type===1?g=new u.ctor(r,u.name,u.strings,this,e):u.type===6&&(g=new Si(r,this,e)),this._$AV.push(g),u=s[++c]}n!==u?.index&&(r=ve.nextNode(),n++)}return ve.currentNode=Ce,i}p(e){let o=0;for(const s of this._$AV)s!==void 0&&(s.strings!==void 0?(s._$AI(e,s,o),o+=s.strings.length-2):s._$AI(e[o])),o++}}class Ye{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,o,s,i){this.type=2,this._$AH=q,this._$AN=void 0,this._$AA=e,this._$AB=o,this._$AM=s,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const o=this._$AM;return o!==void 0&&e?.nodeType===11&&(e=o.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,o=this){e=Be(this,e,o),Ge(e)?e===q||e==null||e===""?(this._$AH!==q&&this._$AR(),this._$AH=q):e!==this._$AH&&e!==xe&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):gi(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==q&&Ge(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ce.createTextNode(e)),this._$AH=e}$(e){const{values:o,_$litType$:s}=e,i=typeof s=="number"?this._$AC(e):(s.el===void 0&&(s.el=Je.createElement(os(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===i)this._$AH.p(o);else{const r=new yi(i,this),n=r.u(this.options);r.p(o),this.T(n),this._$AH=r}}_$AC(e){let o=$o.get(e.strings);return o===void 0&&$o.set(e.strings,o=new Je(e)),o}k(e){no(this._$AH)||(this._$AH=[],this._$AR());const o=this._$AH;let s,i=0;for(const r of e)i===o.length?o.push(s=new Ye(this.O(We()),this.O(We()),this,this.options)):s=o[i],s._$AI(r),i++;i<o.length&&(this._$AR(s&&s._$AB.nextSibling,i),o.length=i)}_$AR(e=this._$AA.nextSibling,o){for(this._$AP?.(!1,!0,o);e!==this._$AB;){const s=Co(e).nextSibling;Co(e).remove(),e=s}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Pt{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,o,s,i,r){this.type=1,this._$AH=q,this._$AN=void 0,this.element=e,this.name=o,this._$AM=i,this.options=r,s.length>2||s[0]!==""||s[1]!==""?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=q}_$AI(e,o=this,s,i){const r=this.strings;let n=!1;if(r===void 0)e=Be(this,e,o,0),n=!Ge(e)||e!==this._$AH&&e!==xe,n&&(this._$AH=e);else{const c=e;let u,g;for(e=r[0],u=0;u<r.length-1;u++)g=Be(this,c[s+u],o,u),g===xe&&(g=this._$AH[u]),n||=!Ge(g)||g!==this._$AH[u],g===q?e=q:e!==q&&(e+=(g??"")+r[u+1]),this._$AH[u]=g}n&&!i&&this.j(e)}j(e){e===q?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class bi extends Pt{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===q?void 0:e}}class wi extends Pt{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==q)}}class vi extends Pt{constructor(e,o,s,i,r){super(e,o,s,i,r),this.type=5}_$AI(e,o=this){if((e=Be(this,e,o,0)??q)===xe)return;const s=this._$AH,i=e===q&&s!==q||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,r=e!==q&&(s===q||i);i&&this.element.removeEventListener(this.name,this,s),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class Si{constructor(e,o,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=o,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){Be(this,e)}}const ki=ao.litHtmlPolyfillSupport;ki?.(Je,Ye),(ao.litHtmlVersions??=[]).push("3.3.2");const Ai=(t,e,o)=>{const s=o?.renderBefore??e;let i=s._$litPart$;if(i===void 0){const r=o?.renderBefore??null;s._$litPart$=i=new Ye(e.insertBefore(We(),r),r,void 0,o??{})}return i._$AI(t),i};const co=globalThis;let He=class extends $e{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const o=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Ai(o,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return xe}};He._$litElement$=!0,He.finalized=!0,co.litElementHydrateSupport?.({LitElement:He});const Ci=co.litElementPolyfillSupport;Ci?.({LitElement:He});(co.litElementVersions??=[]).push("4.2.2");const Ee=t=>(e,o)=>{o!==void 0?o.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)};const xi={attribute:!0,type:String,converter:yt,reflect:!1,hasChanged:ro},Li=(t=xi,e,o)=>{const{kind:s,metadata:i}=o;let r=globalThis.litPropertyMetadata.get(i);if(r===void 0&&globalThis.litPropertyMetadata.set(i,r=new Map),s==="setter"&&((t=Object.create(t)).wrapped=!0),r.set(o.name,t),s==="accessor"){const{name:n}=o;return{set(c){const u=e.get.call(this);e.set.call(this,c),this.requestUpdate(n,u,t,!0,c)},init(c){return c!==void 0&&this.C(n,void 0,t,c),c}}}if(s==="setter"){const{name:n}=o;return function(c){const u=this[n];e.call(this,c),this.requestUpdate(n,u,t,!0,c)}}throw Error("Unsupported decorator location: "+s)};function L(t){return(e,o)=>typeof o=="object"?Li(t,e,o):((s,i,r)=>{const n=i.hasOwnProperty(r);return i.constructor.createProperty(r,s),n?Object.getOwnPropertyDescriptor(i,r):void 0})(t,e,o)}function $t(t){return L({...t,state:!0,attribute:!1})}const Ei=(t,e,o)=>(o.configurable=!0,o.enumerable=!0,Reflect.decorate&&typeof e!="object"&&Object.defineProperty(t,e,o),o);function Ie(t,e){return(o,s,i)=>{const r=n=>n.renderRoot?.querySelector(t)??null;return Ei(o,s,{get(){return r(this)}})}}var Ii=te`
  :host {
    box-sizing: border-box !important;
  }

  :host *,
  :host *::before,
  :host *::after {
    box-sizing: inherit !important;
  }

  [hidden] {
    display: none !important;
  }
`,ht,oe=class extends He{constructor(){super(),oi(this,ht,!1),this.initialReflectedProperties=new Map,this.didSSR=!!this.shadowRoot,this.customStates={set:(e,o)=>{if(this.internals?.states)try{o?this.internals.states.add(e):this.internals.states.delete(e)}catch(s){if(String(s).includes("must start with '--'"))console.error("Your browser implements an outdated version of CustomStateSet. Consider using a polyfill");else throw s}},has:e=>{if(!this.internals?.states)return!1;try{return this.internals.states.has(e)}catch{return!1}}};try{this.internals=this.attachInternals()}catch{console.error("Element internals are not supported in your browser. Consider using a polyfill")}this.customStates.set("wa-defined",!0);let t=this.constructor;for(let[e,o]of t.elementProperties)o.default==="inherit"&&o.initial!==void 0&&typeof e=="string"&&this.customStates.set(`initial-${e}-${o.initial}`,!0)}static get styles(){const t=Array.isArray(this.css)?this.css:this.css?[this.css]:[];return[Ii,...t]}attributeChangedCallback(t,e,o){ti(this,ht)||(this.constructor.elementProperties.forEach((s,i)=>{s.reflect&&this[i]!=null&&this.initialReflectedProperties.set(i,this[i])}),si(this,ht,!0)),super.attributeChangedCallback(t,e,o)}willUpdate(t){super.willUpdate(t),this.initialReflectedProperties.forEach((e,o)=>{t.has(o)&&this[o]==null&&(this[o]=e)})}firstUpdated(t){super.firstUpdated(t),this.didSSR&&this.shadowRoot?.querySelectorAll("slot").forEach(e=>{e.dispatchEvent(new Event("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))})}update(t){try{super.update(t)}catch(e){if(this.didSSR&&!this.hasUpdated){const o=new Event("lit-hydration-error",{bubbles:!0,composed:!0,cancelable:!1});o.error=e,this.dispatchEvent(o)}throw e}}relayNativeEvent(t,e){t.stopImmediatePropagation(),this.dispatchEvent(new t.constructor(t.type,{...t,...e}))}};ht=new WeakMap;w([L()],oe.prototype,"dir",2);w([L()],oe.prototype,"lang",2);w([L({type:Boolean,reflect:!0,attribute:"did-ssr"})],oe.prototype,"didSSR",2);var Pi=()=>({observedAttributes:["custom-error"],checkValidity(t){const e={message:"",isValid:!0,invalidKeys:[]};return t.customError&&(e.message=t.customError,e.isValid=!1,e.invalidKeys=["customError"]),e}}),ne=class extends oe{constructor(){super(),this.name=null,this.disabled=!1,this.required=!1,this.assumeInteractionOn=["input"],this.validators=[],this.valueHasChanged=!1,this.hasInteracted=!1,this.customError=null,this.emittedEvents=[],this.emitInvalid=t=>{t.target===this&&(this.hasInteracted=!0,this.dispatchEvent(new Jo))},this.handleInteraction=t=>{const e=this.emittedEvents;e.includes(t.type)||e.push(t.type),e.length===this.assumeInteractionOn?.length&&(this.hasInteracted=!0)},this.addEventListener("invalid",this.emitInvalid)}static get validators(){return[Pi()]}static get observedAttributes(){const t=new Set(super.observedAttributes||[]);for(const e of this.validators)if(e.observedAttributes)for(const o of e.observedAttributes)t.add(o);return[...t]}connectedCallback(){super.connectedCallback(),this.updateValidity(),this.assumeInteractionOn.forEach(t=>{this.addEventListener(t,this.handleInteraction)})}firstUpdated(...t){super.firstUpdated(...t),this.updateValidity()}willUpdate(t){if(t.has("customError")&&(this.customError||(this.customError=null),this.setCustomValidity(this.customError||"")),t.has("value")||t.has("disabled")){const e=this.value;if(Array.isArray(e)){if(this.name){const o=new FormData;for(const s of e)o.append(this.name,s);this.setValue(o,o)}}else this.setValue(e,e)}t.has("disabled")&&(this.customStates.set("disabled",this.disabled),(this.hasAttribute("disabled")||!this.matches(":disabled"))&&this.toggleAttribute("disabled",this.disabled)),this.updateValidity(),super.willUpdate(t)}get labels(){return this.internals.labels}getForm(){return this.internals.form}set form(t){t?this.setAttribute("form",t):this.removeAttribute("form")}get form(){return this.internals.form}get validity(){return this.internals.validity}get willValidate(){return this.internals.willValidate}get validationMessage(){return this.internals.validationMessage}checkValidity(){return this.updateValidity(),this.internals.checkValidity()}reportValidity(){return this.updateValidity(),this.hasInteracted=!0,this.internals.reportValidity()}get validationTarget(){return this.input||void 0}setValidity(...t){const e=t[0],o=t[1];let s=t[2];s||(s=this.validationTarget),this.internals.setValidity(e,o,s||void 0),this.requestUpdate("validity"),this.setCustomStates()}setCustomStates(){const t=!!this.required,e=this.internals.validity.valid,o=this.hasInteracted;this.customStates.set("required",t),this.customStates.set("optional",!t),this.customStates.set("invalid",!e),this.customStates.set("valid",e),this.customStates.set("user-invalid",!e&&o),this.customStates.set("user-valid",e&&o)}setCustomValidity(t){if(!t){this.customError=null,this.setValidity({});return}this.customError=t,this.setValidity({customError:!0},t,this.validationTarget)}formResetCallback(){this.resetValidity(),this.hasInteracted=!1,this.valueHasChanged=!1,this.emittedEvents=[],this.updateValidity()}formDisabledCallback(t){this.disabled=t,this.updateValidity()}formStateRestoreCallback(t,e){this.value=t,e==="restore"&&this.resetValidity(),this.updateValidity()}setValue(...t){const[e,o]=t;this.internals.setFormValue(e,o)}get allValidators(){const t=this.constructor.validators||[],e=this.validators||[];return[...t,...e]}resetValidity(){this.setCustomValidity(""),this.setValidity({})}updateValidity(){if(this.disabled||this.hasAttribute("disabled")||!this.willValidate){this.resetValidity();return}const t=this.allValidators;if(!t?.length)return;const e={customError:!!this.customError},o=this.validationTarget||this.input||void 0;let s="";for(const i of t){const{isValid:r,message:n,invalidKeys:c}=i.checkValidity(this);r||(s||(s=n),c?.length>=0&&c.forEach(u=>e[u]=!0))}s||(s=this.validationMessage),this.setValidity(e,s,o)}};ne.formAssociated=!0;w([L({reflect:!0})],ne.prototype,"name",2);w([L({type:Boolean})],ne.prototype,"disabled",2);w([L({state:!0,attribute:!1})],ne.prototype,"valueHasChanged",2);w([L({state:!0,attribute:!1})],ne.prototype,"hasInteracted",2);w([L({attribute:"custom-error",reflect:!0})],ne.prototype,"customError",2);w([L({attribute:!1,state:!0,type:Object})],ne.prototype,"validity",1);var $i=te`
  @layer wa-component {
    :host {
      display: inline-block;

      /* Workaround because Chrome doesn't like :host(:has()) below
       * https://issues.chromium.org/issues/40062355
       * Firefox doesn't like this nested rule, so both are needed */
      &:has(wa-badge) {
        position: relative;
      }
    }

    /* Apply relative positioning only when needed to position wa-badge
     * This avoids creating a new stacking context for every button */
    :host(:has(wa-badge)) {
      position: relative;
    }
  }

  .button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    user-select: none;
    -webkit-user-select: none;
    white-space: nowrap;
    vertical-align: middle;
    transition-property: background, border, box-shadow, color, opacity;
    transition-duration: var(--wa-transition-fast);
    transition-timing-function: var(--wa-transition-easing);
    cursor: pointer;
    padding: 0 var(--wa-form-control-padding-inline);
    font-family: inherit;
    font-size: inherit;
    font-weight: var(--wa-font-weight-action);
    line-height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
    height: var(--wa-form-control-height);
    width: 100%;

    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    border-radius: var(--wa-form-control-border-radius);
    border-style: var(--wa-border-style);
    border-width: var(--wa-border-width-s);
  }

  /* Appearance modifiers */
  :host([appearance='plain']) {
    .button {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: transparent;
      border-color: transparent;
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
        background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='outlined']) {
    .button {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: transparent;
      border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
        background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='filled']) {
    .button {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
      border-color: transparent;
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
        background-color: color-mix(
          in oklab,
          var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
          var(--wa-color-mix-hover)
        );
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='filled-outlined']) {
    .button {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
      border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
        background-color: color-mix(
          in oklab,
          var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
          var(--wa-color-mix-hover)
        );
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='accent']) {
    .button {
      color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
      background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
      border-color: transparent;
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        background-color: color-mix(
          in oklab,
          var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
          var(--wa-color-mix-hover)
        );
      }
    }
    .button:not(.disabled):not(.loading):active {
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
        var(--wa-color-mix-active)
      );
    }
  }

  /* Focus states */
  .button:focus {
    outline: none;
  }

  .button:focus-visible {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }

  /* Disabled state */
  :host([disabled]) {
    opacity: 0.5;
    cursor: not-allowed;

    /* When disabled, prevent mouse events from bubbling up from children */
    .button {
      pointer-events: none;
    }
  }

  /* Keep it last so Safari doesn't stop parsing this block */
  .button::-moz-focus-inner {
    border: 0;
  }

  /* Icon buttons */
  .button.is-icon-button {
    outline-offset: 2px;
    width: var(--wa-form-control-height);
    aspect-ratio: 1;
  }

  .button.is-icon-button:has(wa-icon) {
    width: auto;
  }

  /* Pill modifier */
  :host([pill]) .button {
    border-radius: var(--wa-border-radius-pill);
  }

  /*
   * Label
   */

  .start,
  .end {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    pointer-events: none;
  }

  .label {
    display: inline-block;
  }

  .is-icon-button .label {
    display: flex;
  }

  .label::slotted(wa-icon) {
    align-self: center;
  }

  /*
   * Caret modifier
   */

  wa-icon[part='caret'] {
    display: flex;
    align-self: center;
    align-items: center;

    &::part(svg) {
      width: 0.875em;
      height: 0.875em;
    }

    .button:has(&) .end {
      display: none;
    }
  }

  /*
   * Loading modifier
   */

  .loading {
    position: relative;
    cursor: wait;

    .start,
    .label,
    .end,
    .caret {
      visibility: hidden;
    }

    wa-spinner {
      --indicator-color: currentColor;
      --track-color: color-mix(in oklab, currentColor, transparent 90%);

      position: absolute;
      font-size: 1em;
      height: 1em;
      width: 1em;
      top: calc(50% - 0.5em);
      left: calc(50% - 0.5em);
    }
  }

  /*
   * Badges
   */

  .button ::slotted(wa-badge) {
    border-color: var(--wa-color-surface-default);
    position: absolute;
    inset-block-start: 0;
    inset-inline-end: 0;
    translate: 50% -50%;
    pointer-events: none;
  }

  :host(:dir(rtl)) ::slotted(wa-badge) {
    translate: -50% -50%;
  }

  /*
  * Button spacing
  */

  slot[name='start']::slotted(*) {
    margin-inline-end: 0.75em;
  }

  slot[name='end']::slotted(*),
  .button:not(.visually-hidden-label) [part='caret'] {
    margin-inline-start: 0.75em;
  }

  /*
   * Button group border radius modifications
   */

  /* Remove border radius from all grouped buttons by default */
  :host(.wa-button-group__button) .button {
    border-radius: 0;
  }

  /* Horizontal orientation */
  :host(.wa-button-group__horizontal.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-form-control-border-radius);
    border-end-start-radius: var(--wa-form-control-border-radius);
  }

  :host(.wa-button-group__horizontal.wa-button-group__button-last) .button {
    border-start-end-radius: var(--wa-form-control-border-radius);
    border-end-end-radius: var(--wa-form-control-border-radius);
  }

  /* Vertical orientation */
  :host(.wa-button-group__vertical) {
    flex: 1 1 auto;
  }

  :host(.wa-button-group__vertical) .button {
    width: 100%;
    justify-content: start;
  }

  :host(.wa-button-group__vertical.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-form-control-border-radius);
    border-start-end-radius: var(--wa-form-control-border-radius);
  }

  :host(.wa-button-group__vertical.wa-button-group__button-last) .button {
    border-end-start-radius: var(--wa-form-control-border-radius);
    border-end-end-radius: var(--wa-form-control-border-radius);
  }

  /* Handle pill modifier for button groups */
  :host([pill].wa-button-group__horizontal.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-border-radius-pill);
    border-end-start-radius: var(--wa-border-radius-pill);
  }

  :host([pill].wa-button-group__horizontal.wa-button-group__button-last) .button {
    border-start-end-radius: var(--wa-border-radius-pill);
    border-end-end-radius: var(--wa-border-radius-pill);
  }

  :host([pill].wa-button-group__vertical.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-border-radius-pill);
    border-start-end-radius: var(--wa-border-radius-pill);
  }

  :host([pill].wa-button-group__vertical.wa-button-group__button-last) .button {
    border-end-start-radius: var(--wa-border-radius-pill);
    border-end-end-radius: var(--wa-border-radius-pill);
  }
`;var ss=class{constructor(t,...e){this.slotNames=[],this.handleSlotChange=o=>{const s=o.target;(this.slotNames.includes("[default]")&&!s.name||s.name&&this.slotNames.includes(s.name))&&this.host.requestUpdate()},(this.host=t).addController(this),this.slotNames=e}hasDefaultSlot(){return[...this.host.childNodes].some(t=>{if(t.nodeType===Node.TEXT_NODE&&t.textContent.trim()!=="")return!0;if(t.nodeType===Node.ELEMENT_NODE){const e=t;if(e.tagName.toLowerCase()==="wa-visually-hidden")return!1;if(!e.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(t){return this.host.querySelector(`:scope > [slot="${t}"]`)!==null}test(t){return t==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(t)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};var Oi=te`
  :host([size='small']),
  .wa-size-s {
    font-size: var(--wa-font-size-s);
  }

  :host([size='medium']),
  .wa-size-m {
    font-size: var(--wa-font-size-m);
  }

  :host([size='large']),
  .wa-size-l {
    font-size: var(--wa-font-size-l);
  }
`;var Ti=te`
  :where(:root),
  .wa-neutral,
  :host([variant='neutral']) {
    --wa-color-fill-loud: var(--wa-color-neutral-fill-loud);
    --wa-color-fill-normal: var(--wa-color-neutral-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-neutral-fill-quiet);
    --wa-color-border-loud: var(--wa-color-neutral-border-loud);
    --wa-color-border-normal: var(--wa-color-neutral-border-normal);
    --wa-color-border-quiet: var(--wa-color-neutral-border-quiet);
    --wa-color-on-loud: var(--wa-color-neutral-on-loud);
    --wa-color-on-normal: var(--wa-color-neutral-on-normal);
    --wa-color-on-quiet: var(--wa-color-neutral-on-quiet);
  }

  .wa-brand,
  :host([variant='brand']) {
    --wa-color-fill-loud: var(--wa-color-brand-fill-loud);
    --wa-color-fill-normal: var(--wa-color-brand-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-brand-fill-quiet);
    --wa-color-border-loud: var(--wa-color-brand-border-loud);
    --wa-color-border-normal: var(--wa-color-brand-border-normal);
    --wa-color-border-quiet: var(--wa-color-brand-border-quiet);
    --wa-color-on-loud: var(--wa-color-brand-on-loud);
    --wa-color-on-normal: var(--wa-color-brand-on-normal);
    --wa-color-on-quiet: var(--wa-color-brand-on-quiet);
  }

  .wa-success,
  :host([variant='success']) {
    --wa-color-fill-loud: var(--wa-color-success-fill-loud);
    --wa-color-fill-normal: var(--wa-color-success-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-success-fill-quiet);
    --wa-color-border-loud: var(--wa-color-success-border-loud);
    --wa-color-border-normal: var(--wa-color-success-border-normal);
    --wa-color-border-quiet: var(--wa-color-success-border-quiet);
    --wa-color-on-loud: var(--wa-color-success-on-loud);
    --wa-color-on-normal: var(--wa-color-success-on-normal);
    --wa-color-on-quiet: var(--wa-color-success-on-quiet);
  }

  .wa-warning,
  :host([variant='warning']) {
    --wa-color-fill-loud: var(--wa-color-warning-fill-loud);
    --wa-color-fill-normal: var(--wa-color-warning-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-warning-fill-quiet);
    --wa-color-border-loud: var(--wa-color-warning-border-loud);
    --wa-color-border-normal: var(--wa-color-warning-border-normal);
    --wa-color-border-quiet: var(--wa-color-warning-border-quiet);
    --wa-color-on-loud: var(--wa-color-warning-on-loud);
    --wa-color-on-normal: var(--wa-color-warning-on-normal);
    --wa-color-on-quiet: var(--wa-color-warning-on-quiet);
  }

  .wa-danger,
  :host([variant='danger']) {
    --wa-color-fill-loud: var(--wa-color-danger-fill-loud);
    --wa-color-fill-normal: var(--wa-color-danger-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-danger-fill-quiet);
    --wa-color-border-loud: var(--wa-color-danger-border-loud);
    --wa-color-border-normal: var(--wa-color-danger-border-normal);
    --wa-color-border-quiet: var(--wa-color-danger-border-quiet);
    --wa-color-on-loud: var(--wa-color-danger-on-loud);
    --wa-color-on-normal: var(--wa-color-danger-on-normal);
    --wa-color-on-quiet: var(--wa-color-danger-on-quiet);
  }
`;const Gt=new Set,Oe=new Map;let be,lo="ltr",uo="en";const is=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(is){const t=new MutationObserver(as);lo=document.documentElement.dir||"ltr",uo=document.documentElement.lang||navigator.language,t.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function rs(...t){t.map(e=>{const o=e.$code.toLowerCase();Oe.has(o)?Oe.set(o,Object.assign(Object.assign({},Oe.get(o)),e)):Oe.set(o,e),be||(be=e)}),as()}function as(){is&&(lo=document.documentElement.dir||"ltr",uo=document.documentElement.lang||navigator.language),[...Gt.keys()].map(t=>{typeof t.requestUpdate=="function"&&t.requestUpdate()})}let Di=class{constructor(e){this.host=e,this.host.addController(this)}hostConnected(){Gt.add(this.host)}hostDisconnected(){Gt.delete(this.host)}dir(){return`${this.host.dir||lo}`.toLowerCase()}lang(){return`${this.host.lang||uo}`.toLowerCase()}getTranslationData(e){var o,s;const i=new Intl.Locale(e.replace(/_/g,"-")),r=i?.language.toLowerCase(),n=(s=(o=i?.region)===null||o===void 0?void 0:o.toLowerCase())!==null&&s!==void 0?s:"",c=Oe.get(`${r}-${n}`),u=Oe.get(r);return{locale:i,language:r,region:n,primary:c,secondary:u}}exists(e,o){var s;const{primary:i,secondary:r}=this.getTranslationData((s=o.lang)!==null&&s!==void 0?s:this.lang());return o=Object.assign({includeFallback:!1},o),!!(i&&i[e]||r&&r[e]||o.includeFallback&&be&&be[e])}term(e,...o){const{primary:s,secondary:i}=this.getTranslationData(this.lang());let r;if(s&&s[e])r=s[e];else if(i&&i[e])r=i[e];else if(be&&be[e])r=be[e];else return console.error(`No translation found for: ${String(e)}`),String(e);return typeof r=="function"?r(...o):r}date(e,o){return e=new Date(e),new Intl.DateTimeFormat(this.lang(),o).format(e)}number(e,o){return e=Number(e),isNaN(e)?"":new Intl.NumberFormat(this.lang(),o).format(e)}relativeTime(e,o,s){return new Intl.RelativeTimeFormat(this.lang(),s).format(e,o)}};var ns={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",dropFileHere:"Drop file here or click to browse",decrement:"Decrement",dropFilesHere:"Drop files here or click to browse",error:"Error",goToSlide:(t,e)=>`Go to slide ${t} of ${e}`,hidePassword:"Hide password",increment:"Increment",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:t=>t===0?"No options selected":t===1?"1 option selected":`${t} options selected`,pauseAnimation:"Pause animation",playAnimation:"Play animation",previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollableRegion:"Scrollable region",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:t=>`Slide ${t}`,toggleColorFormat:"Toggle color format",zoomIn:"Zoom in",zoomOut:"Zoom out"};rs(ns);var Bi=ns;var Ot=class extends Di{};rs(Bi);function ce(t,e){const o={waitUntilFirstUpdate:!1,...e};return(s,i)=>{const{update:r}=s,n=Array.isArray(t)?t:[t];s.update=function(c){n.forEach(u=>{const g=u;if(c.has(g)){const f=c.get(g),y=this[g];f!==y&&(!o.waitUntilFirstUpdate||this.hasUpdated)&&this[i](f,y)}}),r.call(this,c)}}}const Ni={ATTRIBUTE:1},Mi=t=>(...e)=>({_$litDirective$:t,values:e});let zi=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,o,s){this._$Ct=e,this._$AM=o,this._$Ci=s}_$AS(e,o){return this.update(e,o)}update(e,o){return this.render(...o)}};const Ze=Mi(class extends zi{constructor(t){if(super(t),t.type!==Ni.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in e)e[s]&&!this.nt?.has(s)&&this.st.add(s);return this.render(e)}const o=t.element.classList;for(const s of this.st)s in e||(o.remove(s),this.st.delete(s));for(const s in e){const i=!!e[s];i===this.st.has(s)||this.nt?.has(s)||(i?(o.add(s),this.st.add(s)):(o.remove(s),this.st.delete(s)))}return xe}});const X=t=>t??q;const cs=Symbol.for(""),Ri=t=>{if(t?.r===cs)return t?._$litStatic$},Oo=(t,...e)=>({_$litStatic$:e.reduce((o,s,i)=>o+(r=>{if(r._$litStatic$!==void 0)return r._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${r}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(s)+t[i+1],t[0]),r:cs}),To=new Map,Fi=t=>(e,...o)=>{const s=o.length;let i,r;const n=[],c=[];let u,g=0,f=!1;for(;g<s;){for(u=e[g];g<s&&(r=o[g],(i=Ri(r))!==void 0);)u+=i+e[++g],f=!0;g!==s&&c.push(r),n.push(u),g++}if(g===s&&n.push(e[s]),f){const y=n.join("$$lit$$");(e=To.get(y))===void 0&&(n.raw=n,To.set(y,e=n)),o=c}return t(e,...o)},qt=Fi(J);var N=class extends ne{constructor(){super(...arguments),this.assumeInteractionOn=["click"],this.hasSlotController=new ss(this,"[default]","start","end"),this.localize=new Ot(this),this.invalid=!1,this.isIconButton=!1,this.title="",this.variant="neutral",this.appearance="accent",this.size="medium",this.withCaret=!1,this.disabled=!1,this.loading=!1,this.pill=!1,this.type="button"}static get validators(){return[...super.validators,Ys()]}constructLightDOMButton(){const t=document.createElement("button");for(const e of this.attributes)e.name!=="style"&&t.setAttribute(e.name,e.value);return t.type=this.type,t.style.position="absolute !important",t.style.width="0 !important",t.style.height="0 !important",t.style.clipPath="inset(50%) !important",t.style.overflow="hidden !important",t.style.whiteSpace="nowrap !important",this.name&&(t.name=this.name),t.value=this.value||"",t}handleClick(t){if(this.disabled||this.loading){t.preventDefault(),t.stopImmediatePropagation();return}if(this.type!=="submit"&&this.type!=="reset"||!this.getForm())return;const o=this.constructLightDOMButton();this.parentElement?.append(o),o.click(),o.remove()}handleInvalid(){this.dispatchEvent(new Jo)}handleLabelSlotChange(){const t=this.labelSlot.assignedNodes({flatten:!0});let e=!1,o=!1,s=!1,i=!1;[...t].forEach(r=>{if(r.nodeType===Node.ELEMENT_NODE){const n=r;n.localName==="wa-icon"?(o=!0,e||(e=n.label!==void 0)):i=!0}else r.nodeType===Node.TEXT_NODE&&(r.textContent?.trim()||"").length>0&&(s=!0)}),this.isIconButton=o&&!s&&!i,this.isIconButton&&!e&&console.warn('Icon buttons must have a label for screen readers. Add <wa-icon label="..."> to remove this warning.',this)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.updateValidity()}setValue(...t){}click(){this.button.click()}focus(t){this.button.focus(t)}blur(){this.button.blur()}render(){const t=this.isLink(),e=t?Oo`a`:Oo`button`;return qt`
      <${e}
        part="base"
        class=${Ze({button:!0,caret:this.withCaret,disabled:this.disabled,loading:this.loading,rtl:this.localize.dir()==="rtl","has-label":this.hasSlotController.test("[default]"),"has-start":this.hasSlotController.test("start"),"has-end":this.hasSlotController.test("end"),"is-icon-button":this.isIconButton})}
        ?disabled=${X(t?void 0:this.disabled)}
        type=${X(t?void 0:this.type)}
        title=${this.title}
        name=${X(t?void 0:this.name)}
        value=${X(t?void 0:this.value)}
        href=${X(t?this.href:void 0)}
        target=${X(t?this.target:void 0)}
        download=${X(t?this.download:void 0)}
        rel=${X(t&&this.rel?this.rel:void 0)}
        role=${X(t?void 0:"button")}
        aria-disabled=${X(t&&this.disabled?"true":void 0)}
        tabindex=${this.disabled?"-1":"0"}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="start" part="start" class="start"></slot>
        <slot part="label" class="label" @slotchange=${this.handleLabelSlotChange}></slot>
        <slot name="end" part="end" class="end"></slot>
        ${this.withCaret?qt`
                <wa-icon part="caret" class="caret" library="system" name="chevron-down" variant="solid"></wa-icon>
              `:""}
        ${this.loading?qt`<wa-spinner part="spinner"></wa-spinner>`:""}
      </${e}>
    `}};N.shadowRootOptions={...ne.shadowRootOptions,delegatesFocus:!0};N.css=[$i,Ti,Oi];w([Ie(".button")],N.prototype,"button",2);w([Ie("slot:not([name])")],N.prototype,"labelSlot",2);w([$t()],N.prototype,"invalid",2);w([$t()],N.prototype,"isIconButton",2);w([L()],N.prototype,"title",2);w([L({reflect:!0})],N.prototype,"variant",2);w([L({reflect:!0})],N.prototype,"appearance",2);w([L({reflect:!0})],N.prototype,"size",2);w([L({attribute:"with-caret",type:Boolean,reflect:!0})],N.prototype,"withCaret",2);w([L({type:Boolean})],N.prototype,"disabled",2);w([L({type:Boolean,reflect:!0})],N.prototype,"loading",2);w([L({type:Boolean,reflect:!0})],N.prototype,"pill",2);w([L()],N.prototype,"type",2);w([L({reflect:!0})],N.prototype,"name",2);w([L({reflect:!0})],N.prototype,"value",2);w([L({reflect:!0})],N.prototype,"href",2);w([L()],N.prototype,"target",2);w([L()],N.prototype,"rel",2);w([L()],N.prototype,"download",2);w([L({attribute:"formaction"})],N.prototype,"formAction",2);w([L({attribute:"formenctype"})],N.prototype,"formEnctype",2);w([L({attribute:"formmethod"})],N.prototype,"formMethod",2);w([L({attribute:"formnovalidate",type:Boolean})],N.prototype,"formNoValidate",2);w([L({attribute:"formtarget"})],N.prototype,"formTarget",2);w([ce("disabled",{waitUntilFirstUpdate:!0})],N.prototype,"handleDisabledChange",1);N=w([Ee("wa-button")],N);var qi=te`
  :host {
    --track-width: 2px;
    --track-color: var(--wa-color-neutral-fill-normal);
    --indicator-color: var(--wa-color-brand-fill-loud);
    --speed: 2s;

    /*
      Resizing a spinner element using anything but font-size will break the animation because the animation uses em
      units. Therefore, if a spinner is used in a flex container without \`flex: none\` applied, the spinner can
      grow/shrink and break the animation. The use of \`flex: none\` on the host element prevents this by always having
      the spinner sized according to its actual dimensions.
    */
    flex: none;
    display: inline-flex;
    width: 1em;
    height: 1em;
  }

  svg {
    width: 100%;
    height: 100%;
    aspect-ratio: 1;
    animation: spin var(--speed) linear infinite;
  }

  .track {
    stroke: var(--track-color);
  }

  .indicator {
    stroke: var(--indicator-color);
    stroke-dasharray: 75, 100;
    stroke-dashoffset: -5;
    animation: dash 1.5s ease-in-out infinite;
    stroke-linecap: round;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  @keyframes dash {
    0% {
      stroke-dasharray: 1, 150;
      stroke-dashoffset: 0;
    }
    50% {
      stroke-dasharray: 90, 150;
      stroke-dashoffset: -35;
    }
    100% {
      stroke-dasharray: 90, 150;
      stroke-dashoffset: -124;
    }
  }
`;var Jt=class extends oe{constructor(){super(...arguments),this.localize=new Ot(this)}render(){return J`
      <svg
        part="base"
        role="progressbar"
        aria-label=${this.localize.term("loading")}
        fill="none"
        viewBox="0 0 50 50"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle class="track" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
        <circle class="indicator" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
      </svg>
    `}};Jt.css=qi;Jt=w([Ee("wa-spinner")],Jt);var Ui=class extends Event{constructor(){super("wa-error",{bubbles:!0,cancelable:!1,composed:!0})}};var Ki=class extends Event{constructor(){super("wa-load",{bubbles:!0,cancelable:!1,composed:!0})}};var Hi=te`
  :host {
    --primary-color: currentColor;
    --primary-opacity: 1;
    --secondary-color: currentColor;
    --secondary-opacity: 0.4;
    --rotate-angle: 0deg;

    box-sizing: content-box;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: -0.125em;
  }

  /* Standard */
  :host(:not([auto-width])) {
    width: 1.25em;
    height: 1em;
  }

  /* Auto-width */
  :host([auto-width]) {
    width: auto;
    height: 1em;
  }

  svg {
    height: 1em;
    overflow: visible;
    width: auto;

    /* Duotone colors with path-specific opacity fallback */
    path[data-duotone-primary] {
      color: var(--primary-color);
      opacity: var(--path-opacity, var(--primary-opacity));
    }

    path[data-duotone-secondary] {
      color: var(--secondary-color);
      opacity: var(--path-opacity, var(--secondary-opacity));
    }
  }

  /* Rotation */
  :host([rotate]) {
    transform: rotate(var(--rotate-angle, 0deg));
  }

  /* Flipping */
  :host([flip='x']) {
    transform: scaleX(-1);
  }
  :host([flip='y']) {
    transform: scaleY(-1);
  }
  :host([flip='both']) {
    transform: scale(-1, -1);
  }

  /* Rotation and Flipping combined */
  :host([rotate][flip='x']) {
    transform: rotate(var(--rotate-angle, 0deg)) scaleX(-1);
  }
  :host([rotate][flip='y']) {
    transform: rotate(var(--rotate-angle, 0deg)) scaleY(-1);
  }
  :host([rotate][flip='both']) {
    transform: rotate(var(--rotate-angle, 0deg)) scale(-1, -1);
  }

  /* Animations */
  :host([animation='beat']) {
    animation-name: beat;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, ease-in-out);
  }

  :host([animation='fade']) {
    animation-name: fade;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
  }

  :host([animation='beat-fade']) {
    animation-name: beat-fade;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
  }

  :host([animation='bounce']) {
    animation-name: bounce;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
  }

  :host([animation='flip']) {
    animation-name: flip;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, ease-in-out);
  }

  :host([animation='shake']) {
    animation-name: shake;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, linear);
  }

  :host([animation='spin']) {
    animation-name: spin;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 2s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, linear);
  }

  :host([animation='spin-pulse']) {
    animation-name: spin-pulse;
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, steps(8));
  }

  :host([animation='spin-reverse']) {
    animation-name: spin;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, reverse);
    animation-duration: var(--animation-duration, 2s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, linear);
  }

  /* Keyframes */
  @media (prefers-reduced-motion: reduce) {
    :host([animation='beat']),
    :host([animation='bounce']),
    :host([animation='fade']),
    :host([animation='beat-fade']),
    :host([animation='flip']),
    :host([animation='shake']),
    :host([animation='spin']),
    :host([animation='spin-pulse']),
    :host([animation='spin-reverse']) {
      animation: none !important;
      transition: none !important;
    }
  }
  @keyframes beat {
    0%,
    90% {
      transform: scale(1);
    }
    45% {
      transform: scale(var(--beat-scale, 1.25));
    }
  }

  @keyframes fade {
    50% {
      opacity: var(--fade-opacity, 0.4);
    }
  }

  @keyframes beat-fade {
    0%,
    100% {
      opacity: var(--beat-fade-opacity, 0.4);
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(var(--beat-fade-scale, 1.125));
    }
  }

  @keyframes bounce {
    0% {
      transform: scale(1, 1) translateY(0);
    }
    10% {
      transform: scale(var(--bounce-start-scale-x, 1.1), var(--bounce-start-scale-y, 0.9)) translateY(0);
    }
    30% {
      transform: scale(var(--bounce-jump-scale-x, 0.9), var(--bounce-jump-scale-y, 1.1))
        translateY(var(--bounce-height, -0.5em));
    }
    50% {
      transform: scale(var(--bounce-land-scale-x, 1.05), var(--bounce-land-scale-y, 0.95)) translateY(0);
    }
    57% {
      transform: scale(1, 1) translateY(var(--bounce-rebound, -0.125em));
    }
    64% {
      transform: scale(1, 1) translateY(0);
    }
    100% {
      transform: scale(1, 1) translateY(0);
    }
  }

  @keyframes flip {
    50% {
      transform: rotate3d(var(--flip-x, 0), var(--flip-y, 1), var(--flip-z, 0), var(--flip-angle, -180deg));
    }
  }

  @keyframes shake {
    0% {
      transform: rotate(-15deg);
    }
    4% {
      transform: rotate(15deg);
    }
    8%,
    24% {
      transform: rotate(-18deg);
    }
    12%,
    28% {
      transform: rotate(18deg);
    }
    16% {
      transform: rotate(-22deg);
    }
    20% {
      transform: rotate(22deg);
    }
    32% {
      transform: rotate(-12deg);
    }
    36% {
      transform: rotate(12deg);
    }
    40%,
    100% {
      transform: rotate(0deg);
    }
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  @keyframes spin-pulse {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
`;function ji(t){return`data:image/svg+xml,${encodeURIComponent(t)}`}var Ut={solid:{check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M434.8 70.1c14.3 10.4 17.5 30.4 7.1 44.7l-256 352c-5.5 7.6-14 12.3-23.4 13.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l101.5 101.5 234-321.7c10.4-14.3 30.4-17.5 44.7-7.1z"/></svg>',"chevron-down":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M311.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L243.2 256 73.9 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0z"/></svg>',eyedropper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M341.6 29.2l-101.6 101.6-9.4-9.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-9.4-9.4 101.6-101.6c39-39 39-102.2 0-141.1s-102.2-39-141.1 0zM55.4 323.3c-15 15-23.4 35.4-23.4 56.6l0 42.4-26.6 39.9c-8.5 12.7-6.8 29.6 4 40.4s27.7 12.5 40.4 4l39.9-26.6 42.4 0c21.2 0 41.6-8.4 56.6-23.4l109.4-109.4-45.3-45.3-109.4 109.4c-3 3-7.1 4.7-11.3 4.7l-36.1 0 0-36.1c0-4.2 1.7-8.3 4.7-11.3l109.4-109.4-45.3-45.3-109.4 109.4z"/></svg>',file:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M192 64C156.7 64 128 92.7 128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 234.5C512 217.5 505.3 201.2 493.3 189.2L386.7 82.7C374.7 70.7 358.5 64 341.5 64L192 64zM453.5 240L360 240C346.7 240 336 229.3 336 216L336 122.5L453.5 240z"/></svg>',"file-audio":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM389.8 307.7C380.7 301.4 368.3 303.6 362 312.7C355.7 321.8 357.9 334.2 367 340.5C390.9 357.2 406.4 384.8 406.4 416C406.4 447.2 390.8 474.9 367 491.5C357.9 497.8 355.7 510.3 362 519.3C368.3 528.3 380.8 530.6 389.8 524.3C423.9 500.5 446.4 460.8 446.4 416C446.4 371.2 424 331.5 389.8 307.7zM208 376C199.2 376 192 383.2 192 392L192 440C192 448.8 199.2 456 208 456L232 456L259.2 490C262.2 493.8 266.8 496 271.7 496L272 496C280.8 496 288 488.8 288 480L288 352C288 343.2 280.8 336 272 336L271.7 336C266.8 336 262.2 338.2 259.2 342L232 376L208 376zM336 448.2C336 458.9 346.5 466.4 354.9 459.8C367.8 449.5 376 433.7 376 416C376 398.3 367.8 382.5 354.9 372.2C346.5 365.5 336 373.1 336 383.8L336 448.3z"/></svg>',"file-code":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM282.2 359.6C290.8 349.5 289.7 334.4 279.6 325.8C269.5 317.2 254.4 318.3 245.8 328.4L197.8 384.4C190.1 393.4 190.1 406.6 197.8 415.6L245.8 471.6C254.4 481.7 269.6 482.8 279.6 474.2C289.6 465.6 290.8 450.4 282.2 440.4L247.6 400L282.2 359.6zM394.2 328.4C385.6 318.3 370.4 317.2 360.4 325.8C350.4 334.4 349.2 349.6 357.8 359.6L392.4 400L357.8 440.4C349.2 450.5 350.3 465.6 360.4 474.2C370.5 482.8 385.6 481.7 394.2 471.6L442.2 415.6C449.9 406.6 449.9 393.4 442.2 384.4L394.2 328.4z"/></svg>',"file-excel":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM292 330.7C284.6 319.7 269.7 316.7 258.7 324C247.7 331.3 244.7 346.3 252 357.3L291.2 416L252 474.7C244.6 485.7 247.6 500.6 258.7 508C269.8 515.4 284.6 512.4 292 501.3L320 459.3L348 501.3C355.4 512.3 370.3 515.3 381.3 508C392.3 500.7 395.3 485.7 388 474.7L348.8 416L388 357.3C395.4 346.3 392.4 331.4 381.3 324C370.2 316.6 355.4 319.6 348 330.7L320 372.7L292 330.7z"/></svg>',"file-image":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM256 320C256 302.3 241.7 288 224 288C206.3 288 192 302.3 192 320C192 337.7 206.3 352 224 352C241.7 352 256 337.7 256 320zM220.6 512L419.4 512C435.2 512 448 499.2 448 483.4C448 476.1 445.2 469 440.1 463.7L343.3 361.9C337.3 355.6 328.9 352 320.1 352L319.8 352C311 352 302.7 355.6 296.6 361.9L199.9 463.7C194.8 469 192 476.1 192 483.4C192 499.2 204.8 512 220.6 512z"/></svg>',"file-pdf":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 64C92.7 64 64 92.7 64 128L64 512C64 547.3 92.7 576 128 576L208 576L208 464C208 428.7 236.7 400 272 400L448 400L448 234.5C448 217.5 441.3 201.2 429.3 189.2L322.7 82.7C310.7 70.7 294.5 64 277.5 64L128 64zM389.5 240L296 240C282.7 240 272 229.3 272 216L272 122.5L389.5 240zM272 444C261 444 252 453 252 464L252 592C252 603 261 612 272 612C283 612 292 603 292 592L292 564L304 564C337.1 564 364 537.1 364 504C364 470.9 337.1 444 304 444L272 444zM304 524L292 524L292 484L304 484C315 484 324 493 324 504C324 515 315 524 304 524zM400 444C389 444 380 453 380 464L380 592C380 603 389 612 400 612L432 612C460.7 612 484 588.7 484 560L484 496C484 467.3 460.7 444 432 444L400 444zM420 572L420 484L432 484C438.6 484 444 489.4 444 496L444 560C444 566.6 438.6 572 432 572L420 572zM508 464L508 592C508 603 517 612 528 612C539 612 548 603 548 592L548 548L576 548C587 548 596 539 596 528C596 517 587 508 576 508L548 508L548 484L576 484C587 484 596 475 596 464C596 453 587 444 576 444L528 444C517 444 508 453 508 464z"/></svg>',"file-powerpoint":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM280 320C266.7 320 256 330.7 256 344L256 488C256 501.3 266.7 512 280 512C293.3 512 304 501.3 304 488L304 464L328 464C367.8 464 400 431.8 400 392C400 352.2 367.8 320 328 320L280 320zM328 416L304 416L304 368L328 368C341.3 368 352 378.7 352 392C352 405.3 341.3 416 328 416z"/></svg>',"file-video":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM208 368L208 464C208 481.7 222.3 496 240 496L336 496C353.7 496 368 481.7 368 464L368 440L403 475C406.2 478.2 410.5 480 415 480C424.4 480 432 472.4 432 463L432 368.9C432 359.5 424.4 351.9 415 351.9C410.5 351.9 406.2 353.7 403 356.9L368 391.9L368 367.9C368 350.2 353.7 335.9 336 335.9L240 335.9C222.3 335.9 208 350.2 208 367.9z"/></svg>',"file-word":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM263.4 338.8C260.5 325.9 247.7 317.7 234.8 320.6C221.9 323.5 213.7 336.3 216.6 349.2L248.6 493.2C250.9 503.7 260 511.4 270.8 512C281.6 512.6 291.4 505.9 294.8 495.6L320 419.9L345.2 495.6C348.6 505.8 358.4 512.5 369.2 512C380 511.5 389.1 503.8 391.4 493.2L423.4 349.2C426.3 336.3 418.1 323.4 405.2 320.6C392.3 317.8 379.4 325.9 376.6 338.8L363.4 398.2L342.8 336.4C339.5 326.6 330.4 320 320 320C309.6 320 300.5 326.6 297.2 336.4L276.6 398.2L263.4 338.8z"/></svg>',"file-zipper":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM192 136C192 149.3 202.7 160 216 160L264 160C277.3 160 288 149.3 288 136C288 122.7 277.3 112 264 112L216 112C202.7 112 192 122.7 192 136zM192 232C192 245.3 202.7 256 216 256L264 256C277.3 256 288 245.3 288 232C288 218.7 277.3 208 264 208L216 208C202.7 208 192 218.7 192 232zM256 304L224 304C206.3 304 192 318.3 192 336L192 384C192 410.5 213.5 432 240 432C266.5 432 288 410.5 288 384L288 336C288 318.3 273.7 304 256 304zM240 368C248.8 368 256 375.2 256 384C256 392.8 248.8 400 240 400C231.2 400 224 392.8 224 384C224 375.2 231.2 368 240 368z"/></svg>',"grip-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M128 40c0-22.1-17.9-40-40-40L40 0C17.9 0 0 17.9 0 40L0 88c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM0 424l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 40c0-22.1-17.9-40-40-40L232 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM192 232l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 424c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48z"/></svg>',indeterminate:'<svg part="indeterminate-icon" class="icon" viewBox="0 0 16 16"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"><g stroke="currentColor" stroke-width="2"><g transform="translate(2.285714 6.857143)"><path d="M10.2857143,1.14285714 L1.14285714,1.14285714"/></g></g></g></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80L0 432c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48L48 32zm224 0c-26.5 0-48 21.5-48 48l0 352c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48l-64 0z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M91.2 36.9c-12.4-6.8-27.4-6.5-39.6 .7S32 57.9 32 72l0 368c0 14.1 7.5 27.2 19.6 34.4s27.2 7.5 39.6 .7l336-184c12.8-7 20.8-20.5 20.8-35.1s-8-28.1-20.8-35.1l-336-184z"/></svg>',plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M352 128C352 110.3 337.7 96 320 96C302.3 96 288 110.3 288 128L288 288L128 288C110.3 288 96 302.3 96 320C96 337.7 110.3 352 128 352L288 352L288 512C288 529.7 302.3 544 320 544C337.7 544 352 529.7 352 512L352 352L512 352C529.7 352 544 337.7 544 320C544 302.3 529.7 288 512 288L352 288L352 128z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg>',upload:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M352 173.3L352 384C352 401.7 337.7 416 320 416C302.3 416 288 401.7 288 384L288 173.3L246.6 214.7C234.1 227.2 213.8 227.2 201.3 214.7C188.8 202.2 188.8 181.9 201.3 169.4L297.3 73.4C309.8 60.9 330.1 60.9 342.6 73.4L438.6 169.4C451.1 181.9 451.1 202.2 438.6 214.7C426.1 227.2 405.8 227.2 393.3 214.7L352 173.3zM320 464C364.2 464 400 428.2 400 384L480 384C515.3 384 544 412.7 544 448L544 480C544 515.3 515.3 544 480 544L160 544C124.7 544 96 515.3 96 480L96 448C96 412.7 124.7 384 160 384L240 384C240 428.2 275.8 464 320 464zM464 488C477.3 488 488 477.3 488 464C488 450.7 477.3 440 464 440C450.7 440 440 450.7 440 464C440 477.3 450.7 488 464 488z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M224 248a120 120 0 1 0 0-240 120 120 0 1 0 0 240zm-29.7 56C95.8 304 16 383.8 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3l-59.4 0z"/></svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M55.1 73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L147.2 256 9.9 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192.5 301.3 329.9 438.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.8 256 375.1 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192.5 210.7 55.1 73.4z"/></svg>'},regular:{"circle-question":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M464 256a208 208 0 1 0 -416 0 208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0zm256-80c-17.7 0-32 14.3-32 32 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-44.2 35.8-80 80-80s80 35.8 80 80c0 47.2-36 67.2-56 74.5l0 3.8c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-8.1c0-20.5 14.8-35.2 30.1-40.2 6.4-2.1 13.2-5.5 18.2-10.3 4.3-4.2 7.7-10 7.7-19.6 0-17.7-14.3-32-32-32zM224 368a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>',"circle-xmark":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c-9.4 9.4-9.4 24.6 0 33.9l55 55-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l55-55 55 55c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55 55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-55 55-55-55c-9.4-9.4-24.6-9.4-33.9 0z"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l58.5 58.5c3 3 4.7 7.1 4.7 11.3L400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-197.5c0-17-6.7-33.3-18.7-45.3L370.7 18.7C358.7 6.7 342.5 0 325.5 0L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-48 0 0 16c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l16 0 0-48-16 0z"/></svg>',eye:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/></svg>',"eye-slash":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM176.9 111.1c32.1-18.9 69.2-31.1 111.1-31.1 65.2 0 118.8 29.6 159.9 67.7 38.5 35.7 65.1 78.3 78.6 108.3-13.6 30-40.2 72.5-78.6 108.3-3.1 2.8-6.2 5.6-9.4 8.4L393.8 328c14-20.5 22.2-45.3 22.2-72 0-70.7-57.3-128-128-128-26.7 0-51.5 8.2-72 22.2l-39.1-39.1zm182 182l-108-108c11.1-5.8 23.7-9.1 37.1-9.1 44.2 0 80 35.8 80 80 0 13.4-3.3 26-9.1 37.1zM103.4 173.2l-34-34c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6L352.2 422c-20 6.4-41.4 10-64.2 10-65.2 0-118.8-29.6-159.9-67.7-38.5-35.7-65.1-78.3-78.6-108.3 10.4-23.1 28.6-53.6 54-82.8z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288.1-32c9 0 17.3 5.1 21.4 13.1L383 125.3 542.9 150.7c8.9 1.4 16.3 7.7 19.1 16.3s.5 18-5.8 24.4L441.7 305.9 467 465.8c1.4 8.9-2.3 17.9-9.6 23.2s-17 6.1-25 2L288.1 417.6 143.8 491c-8 4.1-17.7 3.3-25-2s-11-14.2-9.6-23.2L134.4 305.9 20 191.4c-6.4-6.4-8.6-15.8-5.8-24.4s10.1-14.9 19.1-16.3l159.9-25.4 73.6-144.2c4.1-8 12.4-13.1 21.4-13.1zm0 76.8L230.3 158c-3.5 6.8-10 11.6-17.6 12.8l-125.5 20 89.8 89.9c5.4 5.4 7.9 13.1 6.7 20.7l-19.8 125.5 113.3-57.6c6.8-3.5 14.9-3.5 21.8 0l113.3 57.6-19.8-125.5c-1.2-7.6 1.3-15.3 6.7-20.7l89.8-89.9-125.5-20c-7.6-1.2-14.1-6-17.6-12.8L288.1 44.8z"/></svg>'}},Vi={name:"system",resolver:(t,e="classic",o="solid")=>{let i=Ut[o][t]??Ut.regular[t]??Ut.regular["circle-question"];return i?ji(i):""}},Wi=Vi;var Qt="";function Gi(t){Qt=t}function Ji(){if(!Qt){const t=document.querySelector("[data-fa-kit-code]");t&&Gi(t.getAttribute("data-fa-kit-code")||"")}return Qt}var Do="7.1.0";function Qi(t,e,o){const s=Ji(),i=s.length>0;let r="solid";return e==="notdog"&&(o==="solid"&&(r="notdog-solid"),o==="duo-solid"&&(r="notdog-duo-solid")),e==="notdog-duo"&&(r="notdog-duo-solid"),e==="chisel"&&(r="chisel-regular"),e==="etch"&&(r="etch-solid"),e==="jelly"&&(r="jelly-regular",o==="duo-regular"&&(r="jelly-duo-regular"),o==="fill-regular"&&(r="jelly-fill-regular")),e==="jelly-duo"&&(r="jelly-duo-regular"),e==="jelly-fill"&&(r="jelly-fill-regular"),e==="slab"&&((o==="solid"||o==="regular")&&(r="slab-regular"),o==="press-regular"&&(r="slab-press-regular")),e==="slab-press"&&(r="slab-press-regular"),e==="thumbprint"&&(r="thumbprint-light"),e==="whiteboard"&&(r="whiteboard-semibold"),e==="utility"&&(r="utility-semibold"),e==="utility-duo"&&(r="utility-duo-semibold"),e==="utility-fill"&&(r="utility-fill-semibold"),e==="classic"&&(o==="thin"&&(r="thin"),o==="light"&&(r="light"),o==="regular"&&(r="regular"),o==="solid"&&(r="solid")),e==="sharp"&&(o==="thin"&&(r="sharp-thin"),o==="light"&&(r="sharp-light"),o==="regular"&&(r="sharp-regular"),o==="solid"&&(r="sharp-solid")),e==="duotone"&&(o==="thin"&&(r="duotone-thin"),o==="light"&&(r="duotone-light"),o==="regular"&&(r="duotone-regular"),o==="solid"&&(r="duotone")),e==="sharp-duotone"&&(o==="thin"&&(r="sharp-duotone-thin"),o==="light"&&(r="sharp-duotone-light"),o==="regular"&&(r="sharp-duotone-regular"),o==="solid"&&(r="sharp-duotone-solid")),e==="brands"&&(r="brands"),i?`https://ka-p.fontawesome.com/releases/v${Do}/svgs/${r}/${t}.svg?token=${encodeURIComponent(s)}`:`https://ka-f.fontawesome.com/releases/v${Do}/svgs/${r}/${t}.svg`}var Xi={name:"default",resolver:(t,e="classic",o="solid")=>Qi(t,e,o),mutator:(t,e)=>{if(e?.family&&!t.hasAttribute("data-duotone-initialized")){const{family:o,variant:s}=e;if(o==="duotone"||o==="sharp-duotone"||o==="notdog-duo"||o==="notdog"&&s==="duo-solid"||o==="jelly-duo"||o==="jelly"&&s==="duo-regular"||o==="utility-duo"||o==="thumbprint"){const i=[...t.querySelectorAll("path")],r=i.find(c=>!c.hasAttribute("opacity")),n=i.find(c=>c.hasAttribute("opacity"));if(!r||!n)return;if(r.setAttribute("data-duotone-primary",""),n.setAttribute("data-duotone-secondary",""),e.swapOpacity&&r&&n){const c=n.getAttribute("opacity")||"0.4";r.style.setProperty("--path-opacity",c),n.style.setProperty("--path-opacity","1")}t.setAttribute("data-duotone-initialized","")}}}},Yi=Xi;var Zi="classic",er=[Yi,Wi],Xt=[];function tr(t){Xt.push(t)}function or(t){Xt=Xt.filter(e=>e!==t)}function Kt(t){return er.find(e=>e.name===t)}function sr(){return Zi}const ir=(t,e)=>t?._$litType$!==void 0;var Ue=Symbol(),at=Symbol(),Ht,jt=new Map,K=class extends oe{constructor(){super(...arguments),this.svg=null,this.autoWidth=!1,this.swapOpacity=!1,this.label="",this.library="default",this.rotate=0,this.resolveIcon=async(t,e)=>{let o;if(e?.spriteSheet){this.hasUpdated||await this.updateComplete,this.svg=J`<svg part="svg">
        <use part="use" href="${t}"></use>
      </svg>`,await this.updateComplete;const s=this.shadowRoot.querySelector("[part='svg']");return typeof e.mutator=="function"&&e.mutator(s,this),this.svg}try{if(o=await fetch(t,{mode:"cors"}),!o.ok)return o.status===410?Ue:at}catch{return at}try{const s=document.createElement("div");s.innerHTML=await o.text();const i=s.firstElementChild;if(i?.tagName?.toLowerCase()!=="svg")return Ue;Ht||(Ht=new DOMParser);const n=Ht.parseFromString(i.outerHTML,"text/html").body.querySelector("svg");return n?(n.part.add("svg"),document.adoptNode(n)):Ue}catch{return Ue}}}connectedCallback(){super.connectedCallback(),tr(this)}firstUpdated(t){super.firstUpdated(t),this.hasAttribute("rotate")&&this.style.setProperty("--rotate-angle",`${this.rotate}deg`),this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),or(this)}getIconSource(){const t=Kt(this.library),e=this.family||sr();return this.name&&t?{url:t.resolver(this.name,e,this.variant,this.autoWidth),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){const{url:t,fromLibrary:e}=this.getIconSource(),o=e?Kt(this.library):void 0;if(!t){this.svg=null;return}let s=jt.get(t);s||(s=this.resolveIcon(t,o),jt.set(t,s));const i=await s;if(i===at&&jt.delete(t),t===this.getIconSource().url){if(ir(i)){this.svg=i;return}switch(i){case at:case Ue:this.svg=null,this.dispatchEvent(new Ui);break;default:this.svg=i.cloneNode(!0),o?.mutator?.(this.svg,this),this.dispatchEvent(new Ki)}}}updated(t){super.updated(t);const e=Kt(this.library);this.hasAttribute("rotate")&&this.style.setProperty("--rotate-angle",`${this.rotate}deg`);const o=this.shadowRoot?.querySelector("svg");o&&e?.mutator?.(o,this)}render(){return this.hasUpdated?this.svg:J`<svg part="svg" width="16" height="16"></svg>`}};K.css=Hi;w([$t()],K.prototype,"svg",2);w([L({reflect:!0})],K.prototype,"name",2);w([L({reflect:!0})],K.prototype,"family",2);w([L({reflect:!0})],K.prototype,"variant",2);w([L({attribute:"auto-width",type:Boolean,reflect:!0})],K.prototype,"autoWidth",2);w([L({attribute:"swap-opacity",type:Boolean,reflect:!0})],K.prototype,"swapOpacity",2);w([L()],K.prototype,"src",2);w([L()],K.prototype,"label",2);w([L({reflect:!0})],K.prototype,"library",2);w([L({type:Number,reflect:!0})],K.prototype,"rotate",2);w([L({type:String,reflect:!0})],K.prototype,"flip",2);w([L({type:String,reflect:!0})],K.prototype,"animation",2);w([ce("label")],K.prototype,"handleLabelChange",1);w([ce(["family","name","library","variant","src","autoWidth","swapOpacity"],{waitUntilFirstUpdate:!0})],K.prototype,"setIcon",1);K=w([Ee("wa-icon")],K);var rr=class extends Event{constructor(t){super("wa-tab-hide",{bubbles:!0,cancelable:!1,composed:!0}),this.detail=t}};var ar=class extends Event{constructor(t){super("wa-tab-show",{bubbles:!0,cancelable:!1,composed:!0}),this.detail=t}};var nr=te`
  :host {
    --indicator-color: var(--wa-color-brand-fill-loud);
    --track-color: var(--wa-color-neutral-fill-normal);
    --track-width: 0.125rem;

    /* Private */
    --safe-track-width: max(0.5px, round(var(--track-width), 0.5px));

    display: block;
  }

  .tab-group {
    display: flex;
    border-radius: 0;
  }

  .tabs {
    display: flex;
    position: relative;
  }

  .indicator {
    position: absolute;
  }

  .tab-group-has-scroll-controls .nav-container {
    position: relative;
    padding: 0 1.5em;
  }

  .body {
    display: block;
  }

  .scroll-button {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    bottom: 0;
    width: 1.5em;
  }

  .scroll-button-start {
    inset-inline-start: 0;
  }

  .scroll-button-end {
    inset-inline-end: 0;
  }

  /*
    * Top
    */

  .tab-group-top {
    flex-direction: column;
  }

  .tab-group-top .nav-container {
    order: 1;
  }

  .tab-group-top .nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group-top .nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group-top .tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-bottom: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-top .indicator {
    bottom: calc(-1 * var(--safe-track-width));
    border-bottom: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-top .body {
    order: 2;
  }

  .tab-group-top ::slotted(wa-tab[active]) {
    border-block-end: solid var(--safe-track-width) var(--indicator-color);
    margin-block-end: calc(-1 * var(--safe-track-width));
  }

  .tab-group-top ::slotted(wa-tab-panel) {
    --padding: var(--wa-space-xl) 0;
  }

  /*
    * Bottom
    */

  .tab-group-bottom {
    flex-direction: column;
  }

  .tab-group-bottom .nav-container {
    order: 2;
  }

  .tab-group-bottom .nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group-bottom .nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group-bottom .tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-top: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-bottom .indicator {
    top: calc(-1 * var(--safe-track-width));
    border-top: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-bottom .body {
    order: 1;
  }

  .tab-group-bottom ::slotted(wa-tab[active]) {
    border-block-start: solid var(--safe-track-width) var(--indicator-color);
    margin-block-start: calc(-1 * var(--safe-track-width));
  }

  .tab-group-bottom ::slotted(wa-tab-panel) {
    --padding: var(--wa-space-xl) 0;
  }

  /*
    * Start
    */

  .tab-group-start {
    flex-direction: row;
  }

  .tab-group-start .nav-container {
    order: 1;
  }

  .tab-group-start .tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-inline-end: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-start .indicator {
    inset-inline-end: calc(-1 * var(--safe-track-width));
    border-right: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-start .body {
    flex: 1 1 auto;
    order: 2;
  }

  .tab-group-start ::slotted(wa-tab[active]) {
    border-inline-end: solid var(--safe-track-width) var(--indicator-color);
    margin-inline-end: calc(-1 * var(--safe-track-width));
  }

  .tab-group-start ::slotted(wa-tab-panel) {
    --padding: 0 var(--wa-space-xl);
  }

  /*
    * End
    */

  .tab-group-end {
    flex-direction: row;
  }

  .tab-group-end .nav-container {
    order: 2;
  }

  .tab-group-end .tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-left: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-end .indicator {
    inset-inline-start: calc(-1 * var(--safe-track-width));
    border-inline-start: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-end .body {
    flex: 1 1 auto;
    order: 1;
  }

  .tab-group-end ::slotted(wa-tab[active]) {
    border-inline-start: solid var(--safe-track-width) var(--indicator-color);
    margin-inline-start: calc(-1 * var(--safe-track-width));
  }

  .tab-group-end ::slotted(wa-tab-panel) {
    --padding: 0 var(--wa-space-xl);
  }
`;function cr(t,e){return{top:Math.round(t.getBoundingClientRect().top-e.getBoundingClientRect().top),left:Math.round(t.getBoundingClientRect().left-e.getBoundingClientRect().left)}}var Yt=new Set;function lr(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function dr(){const t=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(t)||!t?0:t}function Bo(t){if(Yt.add(t),!document.documentElement.classList.contains("wa-scroll-lock")){const e=lr()+dr();let o=getComputedStyle(document.documentElement).scrollbarGutter;(!o||o==="auto")&&(o="stable"),e<2&&(o=""),document.documentElement.style.setProperty("--wa-scroll-lock-gutter",o),document.documentElement.classList.add("wa-scroll-lock"),document.documentElement.style.setProperty("--wa-scroll-lock-size",`${e}px`)}}function No(t){Yt.delete(t),Yt.size===0&&(document.documentElement.classList.remove("wa-scroll-lock"),document.documentElement.style.removeProperty("--wa-scroll-lock-size"))}function Mo(t,e,o="vertical",s="smooth"){const i=cr(t,e),r=i.top+e.scrollTop,n=i.left+e.scrollLeft,c=e.scrollLeft,u=e.scrollLeft+e.offsetWidth,g=e.scrollTop,f=e.scrollTop+e.offsetHeight;(o==="horizontal"||o==="both")&&(n<c?e.scrollTo({left:n,behavior:s}):n+t.clientWidth>u&&e.scrollTo({left:n-e.offsetWidth+t.clientWidth,behavior:s})),(o==="vertical"||o==="both")&&(r<g?e.scrollTo({top:r,behavior:s}):r+t.clientHeight>f&&e.scrollTo({top:r-e.offsetHeight+t.clientHeight,behavior:s}))}var V=class extends oe{constructor(){super(...arguments),this.tabs=[],this.focusableTabs=[],this.panels=[],this.localize=new Ot(this),this.hasScrollControls=!1,this.active="",this.placement="top",this.activation="auto",this.withoutScrollControls=!1}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>{this.updateScrollControls()}),this.mutationObserver=new MutationObserver(t=>{t.some(o=>!["aria-labelledby","aria-controls"].includes(o.attributeName))&&setTimeout(()=>this.setAriaLabels());const e=t.filter(o=>o.target.closest("wa-tab-group")===this);if(e.some(o=>o.attributeName==="disabled"))this.syncTabsAndPanels();else if(e.some(o=>o.attributeName==="active")){const s=e.filter(i=>i.attributeName==="active"&&i.target.tagName.toLowerCase()==="wa-tab").map(i=>i.target).find(i=>i.active);s&&s.closest("wa-tab-group")===this&&this.setActiveTab(s)}}),this.updateComplete.then(()=>{this.syncTabsAndPanels(),this.mutationObserver.observe(this,{attributes:!0,childList:!0,subtree:!0}),this.resizeObserver.observe(this.nav),new IntersectionObserver((e,o)=>{if(e[0].intersectionRatio>0){if(this.setAriaLabels(),this.active){const s=this.tabs.find(i=>i.panel===this.active);s&&this.setActiveTab(s)}else this.setActiveTab(this.getActiveTab()??this.tabs[0],{emitEvents:!1});o.unobserve(e[0].target)}}).observe(this.tabGroup)})}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.nav&&this.resizeObserver?.unobserve(this.nav)}getAllTabs(){return[...this.shadowRoot.querySelector('slot[name="nav"]').assignedElements()].filter(e=>e.tagName.toLowerCase()==="wa-tab")}getAllPanels(){return[...this.body.assignedElements()].filter(t=>t.tagName.toLowerCase()==="wa-tab-panel")}getActiveTab(){return this.tabs.find(t=>t.active)}handleClick(t){const o=t.target.closest("wa-tab");o?.closest("wa-tab-group")===this&&o!==null&&this.setActiveTab(o,{scrollBehavior:"smooth"})}handleKeyDown(t){const o=t.target.closest("wa-tab");if(o?.closest("wa-tab-group")===this){if(["Enter"," "].includes(t.key)){o!==null&&(this.setActiveTab(o,{scrollBehavior:"smooth"}),t.preventDefault());return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(t.key)){const i=this.tabs.find(c=>c.matches(":focus")),r=this.localize.dir()==="rtl";let n=null;if(i?.tagName.toLowerCase()==="wa-tab"){if(t.key==="Home")n=this.focusableTabs[0];else if(t.key==="End")n=this.focusableTabs[this.focusableTabs.length-1];else if(["top","bottom"].includes(this.placement)&&t.key===(r?"ArrowRight":"ArrowLeft")||["start","end"].includes(this.placement)&&t.key==="ArrowUp"){const c=this.tabs.findIndex(u=>u===i);n=this.findNextFocusableTab(c,"backward")}else if(["top","bottom"].includes(this.placement)&&t.key===(r?"ArrowLeft":"ArrowRight")||["start","end"].includes(this.placement)&&t.key==="ArrowDown"){const c=this.tabs.findIndex(u=>u===i);n=this.findNextFocusableTab(c,"forward")}if(!n)return;n.tabIndex=0,n.focus({preventScroll:!0}),this.activation==="auto"?this.setActiveTab(n,{scrollBehavior:"smooth"}):this.tabs.forEach(c=>{c.tabIndex=c===n?0:-1}),["top","bottom"].includes(this.placement)&&Mo(n,this.nav,"horizontal"),t.preventDefault()}}}}findNextFocusableTab(t,e){let o=null;const s=e==="forward"?1:-1;let i=t+s;for(;t<this.tabs.length;){if(o=this.tabs[i]||null,o===null){e==="forward"?o=this.focusableTabs[0]:o=this.focusableTabs[this.focusableTabs.length-1];break}if(!o.disabled)break;i+=s}return o}handleScrollToStart(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft+this.nav.clientWidth:this.nav.scrollLeft-this.nav.clientWidth,behavior:"smooth"})}handleScrollToEnd(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft-this.nav.clientWidth:this.nav.scrollLeft+this.nav.clientWidth,behavior:"smooth"})}setActiveTab(t,e){if(e={emitEvents:!0,scrollBehavior:"auto",...e},t.closest("wa-tab-group")===this&&t!==this.activeTab&&!t.disabled){const o=this.activeTab;this.active=t.panel,this.activeTab=t,this.tabs.forEach(s=>{s.active=s===this.activeTab,s.tabIndex=s===this.activeTab?0:-1}),this.panels.forEach(s=>s.active=s.name===this.activeTab?.panel),["top","bottom"].includes(this.placement)&&Mo(this.activeTab,this.nav,"horizontal",e.scrollBehavior),e.emitEvents&&(o&&this.dispatchEvent(new rr({name:o.panel})),this.dispatchEvent(new ar({name:this.activeTab.panel})))}}setAriaLabels(){this.tabs.forEach(t=>{const e=this.panels.find(o=>o.name===t.panel);e&&(t.setAttribute("aria-controls",e.getAttribute("id")),e.setAttribute("aria-labelledby",t.getAttribute("id")))})}syncTabsAndPanels(){this.tabs=this.getAllTabs(),this.focusableTabs=this.tabs.filter(t=>!t.disabled),this.panels=this.getAllPanels(),this.updateComplete.then(()=>this.updateScrollControls())}updateActiveTab(){const t=this.tabs.find(e=>e.panel===this.active);t&&this.setActiveTab(t,{scrollBehavior:"smooth"})}updateScrollControls(){this.withoutScrollControls?this.hasScrollControls=!1:this.hasScrollControls=["top","bottom"].includes(this.placement)&&this.nav.scrollWidth>this.nav.clientWidth+1}render(){const t=this.hasUpdated?this.localize.dir()==="rtl":this.dir==="rtl";return J`
      <div
        part="base"
        class=${Ze({"tab-group":!0,"tab-group-top":this.placement==="top","tab-group-bottom":this.placement==="bottom","tab-group-start":this.placement==="start","tab-group-end":this.placement==="end","tab-group-has-scroll-controls":this.hasScrollControls})}
        @click=${this.handleClick}
        @keydown=${this.handleKeyDown}
      >
        <div class="nav-container" part="nav">
          ${this.hasScrollControls?J`
                <wa-button
                  part="scroll-button scroll-button-start"
                  exportparts="base:scroll-button__base"
                  class="scroll-button scroll-button-start"
                  appearance="plain"
                  @click=${this.handleScrollToStart}
                >
                  <wa-icon
                    name=${t?"chevron-right":"chevron-left"}
                    library="system"
                    variant="solid"
                    label=${this.localize.term("scrollToStart")}
                  ></wa-icon>
                </wa-button>
              `:""}

          <!-- We have a focus listener because in Firefox (and soon to be Chrome) overflow containers are focusable. -->
          <div class="nav" @focus=${()=>this.activeTab?.focus({preventScroll:!0})}>
            <div part="tabs" class="tabs" role="tablist">
              <slot name="nav" @slotchange=${this.syncTabsAndPanels}></slot>
            </div>
          </div>

          ${this.hasScrollControls?J`
                <wa-button
                  part="scroll-button scroll-button-end"
                  class="scroll-button scroll-button-end"
                  exportparts="base:scroll-button__base"
                  appearance="plain"
                  @click=${this.handleScrollToEnd}
                >
                  <wa-icon
                    name=${t?"chevron-left":"chevron-right"}
                    library="system"
                    variant="solid"
                    label=${this.localize.term("scrollToEnd")}
                  ></wa-icon>
                </wa-button>
              `:""}
        </div>

        <slot part="body" class="body" @slotchange=${this.syncTabsAndPanels}></slot>
      </div>
    `}};V.css=nr;w([Ie(".tab-group")],V.prototype,"tabGroup",2);w([Ie(".body")],V.prototype,"body",2);w([Ie(".nav")],V.prototype,"nav",2);w([$t()],V.prototype,"hasScrollControls",2);w([L({reflect:!0})],V.prototype,"active",2);w([L()],V.prototype,"placement",2);w([L()],V.prototype,"activation",2);w([L({attribute:"without-scroll-controls",type:Boolean})],V.prototype,"withoutScrollControls",2);w([ce("active")],V.prototype,"updateActiveTab",1);w([ce("withoutScrollControls",{waitUntilFirstUpdate:!0})],V.prototype,"updateScrollControls",1);V=w([Ee("wa-tab-group")],V);var ur=te`
  :host {
    display: inline-block;
    color: var(--wa-color-neutral-on-quiet);
    font-weight: var(--wa-font-weight-action);
  }

  .tab {
    display: inline-flex;
    align-items: center;
    font: inherit;
    padding: 1em 1.5em;
    white-space: nowrap;
    user-select: none;
    -webkit-user-select: none;
    cursor: pointer;
    transition: color var(--wa-transition-fast) var(--wa-transition-easing);

    ::slotted(wa-icon:first-child) {
      margin-inline-end: 0.5em;
    }

    ::slotted(wa-icon:last-child) {
      margin-inline-start: 0.5em;
    }
  }

  @media (hover: hover) {
    :host(:hover:not([disabled])) .tab {
      color: currentColor;
    }
  }

  :host(:focus) {
    outline: transparent;
  }

  :host(:focus-visible) .tab {
    outline: var(--wa-focus-ring);
    outline-offset: calc(-1 * var(--wa-border-width-l) - var(--wa-focus-ring-offset));
  }

  :host([active]:not([disabled])) {
    color: var(--wa-color-brand-on-quiet);
  }

  :host([disabled]) .tab {
    opacity: 0.5;
    cursor: not-allowed;
  }

  @media (forced-colors: active) {
    :host([active]:not([disabled])) {
      outline: solid 1px transparent;
      outline-offset: -3px;
    }
  }
`;var mr=0,ee=class extends oe{constructor(){super(...arguments),this.attrId=++mr,this.componentId=`wa-tab-${this.attrId}`,this.panel="",this.active=!1,this.disabled=!1,this.tabIndex=0}connectedCallback(){this.slot||(this.slot="nav"),super.connectedCallback(),this.setAttribute("role","tab")}handleActiveChange(){this.setAttribute("aria-selected",this.active?"true":"false")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false"),this.disabled&&!this.active?this.tabIndex=-1:this.tabIndex=0}render(){return this.id=this.id?.length>0?this.id:this.componentId,J`
      <div
        part="base"
        class=${Ze({tab:!0,"tab-active":this.active})}
      >
        <slot></slot>
      </div>
    `}};ee.css=ur;w([Ie(".tab")],ee.prototype,"tab",2);w([L({reflect:!0})],ee.prototype,"panel",2);w([L({type:Boolean,reflect:!0})],ee.prototype,"active",2);w([L({type:Boolean,reflect:!0})],ee.prototype,"disabled",2);w([L({type:Number,reflect:!0})],ee.prototype,"tabIndex",2);w([ce("active")],ee.prototype,"handleActiveChange",1);w([ce("disabled")],ee.prototype,"handleDisabledChange",1);ee=w([Ee("wa-tab")],ee);var _r=te`
  :host {
    --padding: 0;

    display: none;
  }

  :host([active]) {
    display: block;
  }

  .tab-panel {
    display: block;
    padding: var(--padding);
  }
`;var pr=0,Ne=class extends oe{constructor(){super(...arguments),this.attrId=++pr,this.componentId=`wa-tab-panel-${this.attrId}`,this.name="",this.active=!1}connectedCallback(){super.connectedCallback(),this.id=this.id.length>0?this.id:this.componentId,this.setAttribute("role","tabpanel")}handleActiveChange(){this.setAttribute("aria-hidden",this.active?"false":"true")}render(){return J`
      <slot
        part="base"
        class=${Ze({"tab-panel":!0,"tab-panel-active":this.active})}
      ></slot>
    `}};Ne.css=_r;w([L({reflect:!0})],Ne.prototype,"name",2);w([L({type:Boolean,reflect:!0})],Ne.prototype,"active",2);w([ce("active")],Ne.prototype,"handleActiveChange",1);Ne=w([Ee("wa-tab-panel")],Ne);var gr=te`
  :host {
    --width: 31rem;
    --spacing: var(--wa-space-l);
    --show-duration: 200ms;
    --hide-duration: 200ms;

    display: none;
  }

  :host([open]) {
    display: block;
  }

  .dialog {
    display: flex;
    flex-direction: column;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    width: var(--width);
    max-width: calc(100% - var(--wa-space-2xl));
    max-height: calc(100% - var(--wa-space-2xl));
    background-color: var(--wa-color-surface-raised);
    border-radius: var(--wa-panel-border-radius);
    border: none;
    box-shadow: var(--wa-shadow-l);
    padding: 0;
    margin: auto;

    &.show {
      animation: show-dialog var(--show-duration) ease;

      &::backdrop {
        animation: show-backdrop var(--show-duration, 200ms) ease;
      }
    }

    &.hide {
      animation: show-dialog var(--hide-duration) ease reverse;

      &::backdrop {
        animation: show-backdrop var(--hide-duration, 200ms) ease reverse;
      }
    }

    &.pulse {
      animation: pulse 250ms ease;
    }
  }

  .dialog:focus {
    outline: none;
  }

  /* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
  @media screen and (max-width: 420px) {
    .dialog {
      max-height: 80vh;
    }
  }

  .open {
    display: flex;
    opacity: 1;
  }

  .header {
    flex: 0 0 auto;
    display: flex;
    flex-wrap: nowrap;

    padding-inline-start: var(--spacing);
    padding-block-end: 0;

    /* Subtract the close button's padding so that the X is visually aligned with the edges of the dialog content */
    padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));
    padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));
  }

  .title {
    align-self: center;
    flex: 1 1 auto;
    font-family: inherit;
    font-size: var(--wa-font-size-l);
    font-weight: var(--wa-font-weight-heading);
    line-height: var(--wa-line-height-condensed);
    margin: 0;
  }

  .header-actions {
    align-self: start;
    display: flex;
    flex-shrink: 0;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--wa-space-2xs);
    padding-inline-start: var(--spacing);
  }

  .header-actions wa-button,
  .header-actions ::slotted(wa-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .body {
    flex: 1 1 auto;
    display: block;
    padding: var(--spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;

    &:focus {
      outline: none;
    }

    &:focus-visible {
      outline: var(--wa-focus-ring);
      outline-offset: var(--wa-focus-ring-offset);
    }
  }

  .footer {
    flex: 0 0 auto;
    display: flex;
    flex-wrap: wrap;
    gap: var(--wa-space-xs);
    justify-content: end;
    padding: var(--spacing);
    padding-block-start: 0;
  }

  .footer ::slotted(wa-button:not(:first-of-type)) {
    margin-inline-start: var(--wa-spacing-xs);
  }

  .dialog::backdrop {
    /*
      NOTE: the ::backdrop element doesn't inherit properly in Safari yet, but it will in 17.4! At that time, we can
      remove the fallback values here.
    */
    background-color: var(--wa-color-overlay-modal, rgb(0 0 0 / 0.25));
  }

  @keyframes pulse {
    0% {
      scale: 1;
    }
    50% {
      scale: 1.02;
    }
    100% {
      scale: 1;
    }
  }

  @keyframes show-dialog {
    from {
      opacity: 0;
      scale: 0.8;
    }
    to {
      opacity: 1;
      scale: 1;
    }
  }

  @keyframes show-backdrop {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @media (forced-colors: active) {
    .dialog {
      border: solid 1px white;
    }
  }
`;function hr(t){return t.split(" ").map(e=>e.trim()).filter(e=>e!=="")}var fr=class extends Event{constructor(){super("wa-show",{bubbles:!0,cancelable:!0,composed:!0})}};var yr=class extends Event{constructor(t){super("wa-hide",{bubbles:!0,cancelable:!0,composed:!0}),this.detail=t}};var br=class extends Event{constructor(){super("wa-after-hide",{bubbles:!0,cancelable:!1,composed:!0})}};var wr=class extends Event{constructor(){super("wa-after-show",{bubbles:!0,cancelable:!1,composed:!0})}};function nt(t,e){return new Promise(o=>{const s=new AbortController,{signal:i}=s;if(t.classList.contains(e))return;t.classList.remove(e),t.classList.add(e);let r=()=>{t.classList.remove(e),o(),s.abort()};t.addEventListener("animationend",r,{once:!0,signal:i}),t.addEventListener("animationcancel",r,{once:!0,signal:i})})}var ae=class extends oe{constructor(){super(...arguments),this.localize=new Ot(this),this.hasSlotController=new ss(this,"footer","header-actions","label"),this.open=!1,this.label="",this.withoutHeader=!1,this.lightDismiss=!1,this.handleDocumentKeyDown=t=>{t.key==="Escape"&&this.open&&(t.preventDefault(),t.stopPropagation(),this.requestClose(this.dialog))}}firstUpdated(){this.open&&(this.addOpenListeners(),this.dialog.showModal(),Bo(this))}disconnectedCallback(){super.disconnectedCallback(),No(this),this.removeOpenListeners()}async requestClose(t){const e=new yr({source:t});if(this.dispatchEvent(e),e.defaultPrevented){this.open=!0,nt(this.dialog,"pulse");return}this.removeOpenListeners(),await nt(this.dialog,"hide"),this.open=!1,this.dialog.close(),No(this);const o=this.originalTrigger;typeof o?.focus=="function"&&setTimeout(()=>o.focus()),this.dispatchEvent(new br)}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}handleDialogCancel(t){t.preventDefault(),!this.dialog.classList.contains("hide")&&t.target===this.dialog&&this.requestClose(this.dialog)}handleDialogClick(t){const o=t.target.closest('[data-dialog="close"]');o&&(t.stopPropagation(),this.requestClose(o))}async handleDialogPointerDown(t){t.target===this.dialog&&(this.lightDismiss?this.requestClose(this.dialog):await nt(this.dialog,"pulse"))}handleOpenChange(){this.open&&!this.dialog.open?this.show():!this.open&&this.dialog.open&&(this.open=!0,this.requestClose(this.dialog))}async show(){const t=new fr;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.originalTrigger=document.activeElement,this.open=!0,this.dialog.showModal(),Bo(this),requestAnimationFrame(()=>{const e=this.querySelector("[autofocus]");e&&typeof e.focus=="function"?e.focus():this.dialog.focus()}),await nt(this.dialog,"show"),this.dispatchEvent(new wr)}render(){const t=!this.withoutHeader,e=this.hasSlotController.test("footer");return J`
      <dialog
        part="dialog"
        class=${Ze({dialog:!0,open:this.open})}
        @cancel=${this.handleDialogCancel}
        @click=${this.handleDialogClick}
        @pointerdown=${this.handleDialogPointerDown}
      >
        ${t?J`
              <header part="header" class="header">
                <h2 part="title" class="title" id="title">
                  <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                  <slot name="label"> ${this.label.length>0?this.label:"​"} </slot>
                </h2>
                <div part="header-actions" class="header-actions">
                  <slot name="header-actions"></slot>
                  <wa-button
                    part="close-button"
                    exportparts="base:close-button__base"
                    class="close"
                    appearance="plain"
                    @click="${o=>this.requestClose(o.target)}"
                  >
                    <wa-icon
                      name="xmark"
                      label=${this.localize.term("close")}
                      library="system"
                      variant="solid"
                    ></wa-icon>
                  </wa-button>
                </div>
              </header>
            `:""}

        <div part="body" class="body"><slot></slot></div>

        ${e?J`
              <footer part="footer" class="footer">
                <slot name="footer"></slot>
              </footer>
            `:""}
      </dialog>
    `}};ae.css=gr;w([Ie(".dialog")],ae.prototype,"dialog",2);w([L({type:Boolean,reflect:!0})],ae.prototype,"open",2);w([L({reflect:!0})],ae.prototype,"label",2);w([L({attribute:"without-header",type:Boolean,reflect:!0})],ae.prototype,"withoutHeader",2);w([L({attribute:"light-dismiss",type:Boolean})],ae.prototype,"lightDismiss",2);w([ce("open",{waitUntilFirstUpdate:!0})],ae.prototype,"handleOpenChange",1);ae=w([Ee("wa-dialog")],ae);document.addEventListener("click",t=>{const e=t.target.closest("[data-dialog]");if(e instanceof Element){const[o,s]=hr(e.getAttribute("data-dialog")||"");if(o==="open"&&s?.length){const r=e.getRootNode().getElementById(s);r?.localName==="wa-dialog"?r.open=!0:console.warn(`A dialog with an ID of "${s}" could not be found in this document.`)}}});document.addEventListener("pointerdown",()=>{});const vr=50,ls=["adminUsers","adminUsersKeys","adminUsersPermissions"],M={baseUrls:"simple_front.base_urls",apiKeys:"simple_front.api_keys",accountIds:"simple_front.account_ids",strategyIds:"simple_front.strategy_ids",language:"simple_front.language",themeMode:"simple_front.theme_mode",densityMode:"simple_front.density_mode",activeMenu:"simple_front.active_menu"},m={wsConnections:new Map,pingTimer:null,connected:!1,eventSeq:0,uiLogSeq:0,tables:{},availableAccountIds:[],accountLabels:new Map,accountExchanges:new Map,subscribedAccountIds:[],locale:"pt-BR",userRole:"",themeMode:"system",densityMode:"normal",postTradingLastPreview:null,adminOmsView:"open_orders",closeBySourceRow:null,omsPageSize:100,omsLocalData:{openPositions:[],openOrders:[],symbolsList:[],adminAccounts:[]},adminLocalData:{adminUsers:[],adminUsersKeys:[],adminUsersPermissions:[]},omsPager:{openPositions:{page:1,pageSize:100,total:0,totalPages:1},openOrders:{page:1,pageSize:100,total:0,totalPages:1},symbolsList:{page:1,pageSize:100,total:0,totalPages:1},deals:{page:1,pageSize:100,total:0,totalPages:1},historyPositions:{page:1,pageSize:100,total:0,totalPages:1},historyOrders:{page:1,pageSize:100,total:0,totalPages:1},ccxtOrders:{page:1,pageSize:100,total:0,totalPages:1},ccxtTrades:{page:1,pageSize:100,total:0,totalPages:1},postTrading:{page:1,pageSize:100,total:0,totalPages:1},adminAccounts:{page:1,pageSize:100,total:0,totalPages:1},adminOms:{page:1,pageSize:100,total:0,totalPages:1}},adminPager:{adminUsers:{page:1,pageSize:20,total:0,totalPages:1},adminUsersKeys:{page:1,pageSize:20,total:0,totalPages:1},adminUsersPermissions:{page:1,pageSize:20,total:0,totalPages:1}}},wt={decimalPlaces:14,smartSteps:[14,5,2,0]};function le(t){if(t==null)return"";const e=String(t).trim();if(!e)return"";const o=Number(e);if(!Number.isFinite(o))return e;const s=Math.max(0,Number(wt.decimalPlaces)||14),i=10**-s;if(Math.abs(o)<i)return"0";const r=(y,v)=>Number(y.toFixed(v)),n=(y,v)=>{const $=y.toFixed(v).replace(/\.?0+$/,"");return $==="-0"?"0":$},c=r(o,s),u=new Set,g=[];for(const y of wt.smartSteps||[]){const v=Math.max(0,Number(y)||0);u.has(v)||(u.add(v),g.push(v))}u.has(s)||g.unshift(s);let f=s;for(const y of g)r(o,y)===c&&(f=y);return n(o,f)}const G={dbName:"ccxt_oms_ui_logs",storeName:"ui_logs",version:1,maxRows:null},Sr={"pt-BR":"Português (Brasil)","en-US":"English (US)",es:"Español"};function d(t){const e=document.getElementById(t);if(!e)throw new Error(`missing element ${t}`);return e}function re(t){try{const e=localStorage.getItem(t),o=e?JSON.parse(e):[];return Array.isArray(o)?o:[]}catch{return[]}}function we(t,e){if(!e)return;const o=re(t).filter(s=>String(s)!==String(e));o.unshift(e),localStorage.setItem(t,JSON.stringify(o.slice(0,vr)))}function je(t,e){const o=d(t);o.innerHTML="";for(const s of e){const i=document.createElement("option");i.value=String(s),o.appendChild(i)}}function kr(t){const e=d("accountHistory");e.innerHTML="";for(const o of t){const s=Number(o);if(!Number.isFinite(s)||s<=0)continue;const i=m.accountLabels.get(s)||"",r=document.createElement("option");r.value=String(s),i&&(r.label=`${s} - ${i}`,r.textContent=`${s} - ${i}`),e.appendChild(r)}}function Ae(t,e=!1){const o=String(t||""),s=o&&`${o.charAt(0).toUpperCase()}${o.slice(1)}`,i=r=>{const n=document.getElementById(r);n&&(n.textContent=s,n.classList.toggle("status-connected",!!e),n.classList.toggle("status-idle",!e))};i("status"),i("loginStatus"),Ar(!!e)}function Ar(t){const e=document.getElementById("connectBtn"),o=document.getElementById("disconnectBtn");!e||!o||(e.classList.toggle("is-hidden",!!t),o.classList.toggle("is-hidden",!t))}function Cr(t){return t==="dark"?"dark":t==="light"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function vt(t,e=!0){const o=["system","light","dark"].includes(String(t))?String(t):"system";m.themeMode=o;const s=Cr(o);document.documentElement.setAttribute("data-theme",s);const i=document.getElementById("themeModeBtn");if(i){const r={"pt-BR":{system:"Sistema",light:"Claro",dark:"Escuro"},"en-US":{system:"System",light:"Light",dark:"Dark"},es:{system:"Sistema",light:"Claro",dark:"Oscuro"}},n=r[m.locale]||r["en-US"],c={system:{iconHtml:'<span class="theme-icon-dual" aria-hidden="true"><i class="fa-solid fa-sun"></i><span>/</span><i class="fa-solid fa-moon"></i></span>',text:n.system},light:{iconHtml:'<i class="fa-solid fa-sun" aria-hidden="true"></i>',text:n.light},dark:{iconHtml:'<i class="fa-solid fa-moon" aria-hidden="true"></i>',text:n.dark}},u=c[o]||c.system;i.innerHTML=`${u.iconHtml}<span>${u.text}</span>`;const g=m.locale==="pt-BR"||m.locale==="es"?"Tema":"Theme";i.setAttribute("title",`${g}: ${u.text}`)}e&&localStorage.setItem(M.themeMode,o)}function xr(){const t=["system","light","dark"],e=t.indexOf(m.themeMode),o=t[(e+1)%t.length];vt(o,!0)}function Tt(t,e=!0){const o=["compact","normal","spacious"].includes(String(t))?String(t):"normal";m.densityMode=o,document.documentElement.setAttribute("data-density",o);const s=document.getElementById("densityModeBtn");if(s){const i={compact:"fa-table-cells",normal:"fa-table-cells-large",spacious:"fa-grip"},r=`density.${o}`,n=a(r,o),c=i[o]||i.normal;s.innerHTML=`<i class="fa-solid ${c}" aria-hidden="true"></i><span>${n}</span>`;const u=m.locale==="pt-BR"?"Densidade":m.locale==="es"?"Densidad":"Density";s.setAttribute("title",`${u}: ${n}`)}e&&localStorage.setItem(M.densityMode,o)}function Lr(){const t=["compact","normal","spacious"],e=t.indexOf(m.densityMode),o=t[(e+1)%t.length];Tt(o,!0)}function mo(){return{baseUrl:d("baseUrl").value.trim().replace(/\/+$/,""),apiKey:d("apiKey").value.trim(),viewAccountIds:Pe()}}function C(){const t=mo();if(!t.baseUrl)throw new Error("base_url is required");if(!t.apiKey)throw new Error("api_key is required");return t}function Q(t){const o=String(t||"").trim().match(/^(\d+)\b/);if(!o)return null;const s=Number(o[1]);return Number.isFinite(s)&&s>0?s:null}function U(t,e){const o=Q(d(t).value);if(!o)throw new Error(`${e} account_id is required`);return o}function St(t){const e=Number(d(t).value||"0");return Number.isFinite(e)&&e>=0?e:0}function Pe(){const t=[...d("viewAccountsSelect").selectedOptions].map(e=>Number(e.value)).filter(e=>Number.isFinite(e)&&e>0);return[...new Set(t)]}function ds(t){const e=d("viewAccountsSelect"),o=new Set(Pe());e.innerHTML="";const s=new Map;for(const i of t){const r=String(m.accountExchanges.get(i)||"unknown");s.has(r)||s.set(r,[]),s.get(r).push(i)}for(const i of[...s.keys()].sort((r,n)=>r.localeCompare(n))){const r=document.createElement("optgroup");r.label=i;const n=s.get(i).sort((c,u)=>Number(c)-Number(u));for(const c of n){const u=document.createElement("option");u.value=String(c);const g=m.accountLabels.get(c)||"";u.textContent=g?`${c} - ${g}`:String(c),u.selected=o.has(c),r.appendChild(u)}e.appendChild(r)}}function us(t){const e=d("tradeStrategyAccountIds"),o=new Set([...e.selectedOptions].map(s=>Number(s.value)));e.innerHTML="";for(const s of t){const i=document.createElement("option");i.value=String(s);const r=m.accountLabels.get(s)||"";i.textContent=r?`${s} - ${r}`:String(s),i.selected=o.has(s),e.appendChild(i)}}function Er(t){const e=d("sendStrategyId"),o=String(e.value||"0");e.innerHTML="";const s=document.createElement("option");s.value="0",s.textContent=a("trade.no_strategy_option","0 - no strategy"),e.appendChild(s);for(const i of t||[]){const r=Number(i.strategy_id);if(!Number.isFinite(r)||r<=0)continue;const n=document.createElement("option");n.value=String(r),n.textContent=`${r} - ${String(i.name||"").trim()||"strategy"}`,e.appendChild(n)}e.value=[...e.options].some(i=>i.value===o)?o:"0"}function Ir(t){const e=document.getElementById("adminUserOptions");if(!e)return;e.innerHTML="";let o=null;for(const i of t||[]){const r=Number(i&&i.user_id||0);if(!Number.isFinite(r)||r<=0)continue;const n=document.createElement("option");n.value=String(r);const c=String(i&&i.user_name||"").trim();n.textContent=c?`${r} - ${c}`:String(r),e.appendChild(n),o===null&&(o=r)}const s=document.getElementById("adminApiKeyUserId");s&&(!s.value||Number(s.value)<=0)&&o!==null&&(s.value=String(o))}function Pr({userId:t,apiKeyId:e,key:o,label:s}){const i=document.getElementById("adminApiKeyCreatedDialog");if(!i)return;const r=document.getElementById("adminApiKeyCreatedMessage");if(r){const u=a("admin.api_key_modal_message","API Key criada para usuário {user_id} (ID {api_key_id})").replace("{user_id}",String(t)).replace("{api_key_id}",String(e));r.textContent=u}const n=document.getElementById("adminApiKeyCreatedLabel");n&&(n.textContent=s||"-");const c=document.getElementById("adminApiKeyCreatedValue");c&&(c.value=String(o||"")),i.open=!0}function $r(){const t=document.getElementById("adminApiKeyCreatedDialog");t&&(t.open=!1)}function Or(){return[...d("tradeStrategyAccountIds").selectedOptions].map(t=>Number(t.value)).filter(t=>Number.isFinite(t)&&t>0)}function ft(t){return String(t||"").split(",").map(e=>Number(String(e).trim())).filter(e=>Number.isFinite(e)&&e>0)}function ms(t,e="value"){if(t==null)return null;const o=String(t).trim();if(!o)return null;const s=Number(o);if(!Number.isFinite(s)||s<=0||!Number.isInteger(s))throw new Error(`${e} inválido`);return s}function Tr(t,e=[]){const o=[...new Set((e||[]).map(i=>Number(i)).filter(i=>Number.isFinite(i)&&i>0))];if(Array.isArray(t))return[...new Set(t.map(i=>Number(i)).filter(i=>Number.isFinite(i)&&i>0))];const s=String(t||"").trim().toLowerCase();if(!s||s==="all"||s==="*"){if(o.length>0)return o;throw new Error("nenhuma conta disponível para aplicar 'all'")}return[...new Set(ft(t))]}function Dr(){if(m.availableAccountIds.length>0)return Number(m.availableAccountIds[0]);const t=_o();return t.length>0?Number(t[0]):1}function Br(t){const e=Dr(),o=String(t||"").trim().toLowerCase();return o==="admin"?[]:o==="risk"?[{account_id:e,can_read:!0,can_trade:!1,can_close_position:!0,can_risk_manage:!0,can_block_new_positions:!0,can_block_account:!0,restrict_to_strategies:!1,strategy_ids:[]}]:o==="readonly"?[{account_id:e,can_read:!0,can_trade:!1,can_close_position:!1,can_risk_manage:!1,can_block_new_positions:!1,can_block_account:!1,restrict_to_strategies:!1,strategy_ids:[]}]:o==="robot"?[{account_id:e,can_read:!0,can_trade:!0,can_close_position:!0,can_risk_manage:!1,can_block_new_positions:!1,can_block_account:!1,restrict_to_strategies:!0,strategy_ids:[]}]:[{account_id:e,can_read:!0,can_trade:!0,can_close_position:!0,can_risk_manage:!1,can_block_new_positions:!1,can_block_account:!1,restrict_to_strategies:!1,strategy_ids:[]}]}async function A(t,e={},o=null){const s=o||C(),i=new Headers(e.headers||{});i.set("x-api-key",s.apiKey),e.body!==void 0&&i.set("Content-Type","application/json");const r=await fetch(`${s.baseUrl}${t}`,{method:e.method||"GET",headers:i,body:e.body!==void 0?JSON.stringify(e.body):void 0}),n=await r.text(),c=n?JSON.parse(n):{};if(!r.ok){const u=c?.detail&&typeof c.detail=="object"?c.detail:null,g=String(u?.message||u?.code||"").trim(),f=Array.isArray(u?.results)?u.results[0]?.error:null,y=String(f?.message||f?.code||"").trim(),v=g||y;throw v?new Error(`${r.status} ${v}`):new Error(`${r.status} ${JSON.stringify(c)}`)}return c}function et(t,e="oms_command"){if(!t||!Array.isArray(t.results))return t;const o=t.results.find(c=>c&&c.ok===!1);if(!o)return t;const s=o.error||{},i=String(s.code||"dispatcher_error"),r=String(s.message||"").trim(),n=r?`: ${r}`:"";throw new Error(`${e} -> ${i}${n}`)}async function tt(t){if(t.viewAccountIds.length>0)return t.viewAccountIds;m.availableAccountIds.length===0&&await ke(t);const e=Pe();if(e.length>0)return e;const o=_o();if(o.length>0)return o;throw new Error("view accounts is empty; selecione uma ou mais contas")}function Nr(t){const e=new URL(t);return e.protocol=e.protocol==="https:"?"wss:":"ws:",e.pathname="/ws",e.search="",e.toString()}function de(t,e){const o=t.trim();return o?JSON.parse(o):e}function Vt(t){const e=typeof t=="string"?t:JSON.stringify(t,null,2);d("ccxtResultBox").value=e}function _s(t){const e=i=>{if(i==null||i==="")return null;const r=Number(i);return Number.isFinite(r)?r:null},o=i=>{const r=i&&typeof i=="object"?i:{},n=r.info&&typeof r.info=="object"?r.info:{},c=Array.isArray(n.filters)?n.filters:[],u=$=>c.find(P=>String(P?.filterType||"").toUpperCase()===String($).toUpperCase())||{},g=u("PRICE_FILTER"),f=u("LOT_SIZE"),y=u("MARKET_LOT_SIZE"),v=e(r.tick_size)??e(r.tickSize)??e(n.tickSize)??e(g.tickSize)??null,I=e(r.step_size)??e(r.stepSize)??e(n.stepSize)??e(f.stepSize)??e(y.stepSize)??null;return{tickSize:v,stepSize:I}};let s=[];return Array.isArray(t)?s=t.map((i,r)=>{const n=i&&typeof i=="object"?i:{},c=String(n.symbol||"").trim(),u=String(n.id||"").trim(),g=String(n.base||"").trim(),f=String(n.quote||"").trim(),y=n.precision&&typeof n.precision=="object"?n.precision:{},v=n.limits&&typeof n.limits=="object"?n.limits:{},I=v.amount&&typeof v.amount=="object"?v.amount:{},$=v.price&&typeof v.price=="object"?v.price:{},P=v.cost&&typeof v.cost=="object"?v.cost:{},l=`${c||u||r}`,{tickSize:_,stepSize:h}=o(n);return{id:l,row_id:l,symbol:c||(g&&f?`${g}/${f}`:""),market_id:u,base:g,quote:f,type:String(n.type||"").trim(),active:n.active===!0?!0:n.active===!1?!1:null,qty_decimals:y.amount??null,price_decimals:y.price??null,qty_min:I.min??null,qty_max:I.max??null,price_min:$.min??null,price_max:$.max??null,cost_min:P.min??null,cost_max:P.max??null,tick_size:_,step_size:h}}):t&&typeof t=="object"&&(s=Object.entries(t).map(([i,r],n)=>{const c=r&&typeof r=="object"?r:{},u=String(c.symbol||"").trim(),g=String(c.id||i||"").trim(),f=String(c.base||"").trim(),y=String(c.quote||"").trim(),v=c.precision&&typeof c.precision=="object"?c.precision:{},I=c.limits&&typeof c.limits=="object"?c.limits:{},$=I.amount&&typeof I.amount=="object"?I.amount:{},P=I.price&&typeof I.price=="object"?I.price:{},l=I.cost&&typeof I.cost=="object"?I.cost:{},_=`${g||u||n}`,{tickSize:h,stepSize:b}=o(c);return{id:_,row_id:_,symbol:u||(f&&y?`${f}/${y}`:String(i||"").trim()),market_id:g,base:f,quote:y,type:String(c.type||"").trim(),active:c.active===!0?!0:c.active===!1?!1:null,qty_decimals:v.amount??null,price_decimals:v.price??null,qty_min:$.min??null,qty_max:$.max??null,price_min:P.min??null,price_max:P.max??null,cost_min:l.min??null,cost_max:l.max??null,tick_size:h,step_size:b}})),s.filter(i=>String(i.symbol||"").trim()||String(i.market_id||"").trim()).sort((i,r)=>String(i.symbol||i.market_id||"").localeCompare(String(r.symbol||r.market_id||"")))}function ps(t){return[...new Set((t||[]).map(e=>String(e.symbol||e.market_id||"").trim()).filter(e=>!!e))].sort()}async function gs(t=!0){const e=C(),o=U("omsSymbolsAccountId","oms_symbols"),s=await A(`/ccxt/${o}/load_markets`,{method:"POST",body:{args:[],kwargs:{}}},e),i=_s(s.result);Le("symbolsList",i,t?1:null);const r=ps(i);je("symbolHistory",r.slice(0,2e3)),!d("sendSymbol").value&&r[0]&&(d("sendSymbol").value=r[0]),p("oms_symbols_loaded",{account_id:o,count:i.length}),T("info","OMS symbol list loaded",{account_id:o,count:i.length})}function hs(t){return!!(t&&t.__ccxtBuilt===!0)}function W(t,e){if(!t)return;const o=po(e);if(hs(t)&&typeof t.setColumns=="function"){t.setColumns(o);return}t.__pendingColumns=o}function fs(t){if(t){if(hs(t)&&typeof t.redraw=="function"){t.redraw(!0);return}t.__pendingRedraw=!0}}function Wt(t){const o={paneOpenPositions:"openPositions",paneOpenOrders:"openOrders",paneDeals:"deals",paneHistoryPositions:"historyPositions",paneHistoryOrders:"historyOrders",paneSymbolsList:"omsSymbols",paneCcxtOrders:"ccxtOrders",paneCcxtTrades:"ccxtTrades",paneWsEvents:"events",paneUiLogs:"uiLogs"}[t];if(!o)return;const s=m.tables[o];fs(s)}function Mr(t){if(Nt.has(t))return(m.omsLocalData[t]||[]).length>0;const e=m.tables[t];return!e||typeof e.getData!="function"?!1:(e.getData()||[]).length>0}async function zr(t){const e=String(t||"").trim(),s={openPositions:()=>Fe(),openOrders:()=>st(),deals:()=>H("deals",!1),historyPositions:()=>H("historyPositions",!1),historyOrders:()=>H("historyOrders",!1),symbolsList:()=>gs(!1)}[e];if(!s||Mr(e))return;const i=mo();if(!(!i.baseUrl||!i.apiKey))try{await s(),p("oms_tab_autoload",{tab:e})}catch(r){p("oms_tab_autoload_error",{tab:e,error:String(r)}),T("error","OMS tab auto reload failed",{tab:e,error:String(r)})}}function Rr(){const t=d("positionTabs"),e=d("systemTabs"),o=s=>{const i=String(s?.detail?.name||"");if(!i)return;Wt(String({openPositions:"paneOpenPositions",openOrders:"paneOpenOrders",deals:"paneDeals",historyPositions:"paneHistoryPositions",historyOrders:"paneHistoryOrders",symbolsList:"paneSymbolsList",ccxtOrders:"paneCcxtOrders",ccxtTrades:"paneCcxtTrades",wsEvents:"paneWsEvents",uiLogs:"paneUiLogs"}[i]||"")),s?.currentTarget===t&&Promise.resolve(zr(i)).catch(n=>{p("oms_tab_autoload_error",{tab:i,error:String(n)})})};t.addEventListener("wa-tab-show",o),e.addEventListener("wa-tab-show",o),Wt("paneOpenPositions"),Wt("paneCcxtOrders")}function Fr(t){const e=Ve?.[t]||{};return String(e["meta.language_name"]||Sr[t]||t)}function a(t,e=""){const o=Ve?.[m.locale]||Ve?.["pt-BR"]||{};return String(o[t]||e||t)}const qr={id:"oms.col_id",account_id:"oms.col_account_id",strategy_id:"oms.col_strategy_id",position_id:"oms.col_position_id",previous_position_id:"oms.col_previous_position_id",order_id:"oms.col_order_id",symbol:"oms.col_symbol",side:"oms.col_side",qty:"oms.col_qty",avg_price:"oms.col_avg_price",stop_loss:"oms.col_stop_loss",stop_gain:"oms.col_stop_gain",state:"oms.col_state",reason:"oms.col_reason",comment:"oms.col_comment",opened_at:"oms.col_opened_at",updated_at:"oms.col_updated_at",closed_at:"oms.col_closed_at",command_id:"oms.col_command_id",order_type:"oms.col_order_type",status:"oms.col_status",price:"oms.col_price",filled_qty:"oms.col_filled_qty",avg_fill_price:"oms.col_avg_fill_price",client_order_id:"oms.col_client_order_id",exchange_order_id:"oms.col_exchange_order_id",exchange_trade_id:"oms.col_exchange_trade_id",created_at:"oms.col_created_at",executed_at:"oms.col_executed_at",fee:"oms.col_fee",fee_currency:"oms.col_fee_currency",pnl:"oms.col_pnl",reconciled:"oms.col_reconciled",market_id:"oms.col_market_id",base:"oms.col_base",quote:"oms.col_quote",type:"oms.col_market_type",active:"oms.col_market_active",price_decimals:"oms.col_price_decimals",qty_decimals:"oms.col_qty_decimals",price_min:"oms.col_price_min",price_max:"oms.col_price_max",qty_min:"oms.col_qty_min",qty_max:"oms.col_qty_max",cost_min:"oms.col_cost_min",cost_max:"oms.col_cost_max",tick_size:"oms.col_tick_size",step_size:"oms.col_step_size",seq:"system.col_seq",at:"system.col_at",kind:"system.col_kind",payload:"system.col_payload",level:"system.col_level",message:"system.col_message",exchange_id:"system.col_exchange_id",observed_at:"system.col_observed_at",raw_json:"system.col_raw",target_strategy_id:"post_trading.col_target_strategy_id",edit_replace_state:"post_trading.col_edit_replace_state",edit_replace_at:"post_trading.col_edit_replace_at",edit_replace_origin_order_id:"post_trading.col_replace_origin_order_id",edit_replace_orphan_order_id:"post_trading.col_replace_orphan_order_id"};function Ur(t){if(!(!t||typeof t.getColumns!="function"))for(const e of t.getColumns()){if(!e||typeof e.getDefinition!="function"||typeof e.updateDefinition!="function")continue;const o=e.getDefinition()||{},s=String(o.field||"").trim();if(!s)continue;const i=qr[s];if(!i)continue;const r=String(o.title||""),n=a(i,r||s);n&&n!==r&&e.updateDefinition({title:n})}}function _e(t,e){const o=document.getElementById("omsMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"oms"})}}function ct(t,e){const o=document.getElementById("loginMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"login"})}}function zo(t,e){const o=document.getElementById("adminCreatedApiKeyBox");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"admin_api_keys"})}}function Y(t,e){const o=document.getElementById("adminOmsMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"admin_oms"})}}function kt(t,e){const o=document.getElementById("adminAccountsMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"admin_accounts"})}}function Z(t,e){const o=document.getElementById("userMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"user"})}}function Kr(t="pt-BR"){const e=d("loginLanguage"),o=Object.keys(Ve||{});e.innerHTML="";for(const s of o){const i=document.createElement("option");i.value=s,i.textContent=Fr(s),i.selected=s===t,e.appendChild(i)}![...e.options].some(s=>s.selected)&&e.options.length>0&&(e.options[0].selected=!0)}function ys(){document.querySelectorAll("[data-i18n]").forEach(s=>{const i=String(s.getAttribute("data-i18n")||"").trim();i&&(s.textContent=a(i,s.textContent||""))}),document.querySelectorAll("[data-i18n-placeholder]").forEach(s=>{const i=String(s.getAttribute("data-i18n-placeholder")||"").trim();if(!i)return;const r=s.getAttribute("placeholder")||"";s.setAttribute("placeholder",a(i,r))});const t=(s,i,r)=>{const n=document.getElementById(s);n&&(n.textContent=a(i,r))},e=(s,i,r)=>{const n=document.getElementById(s);if(!n)return;const c=n.querySelector("span:last-child");c&&(c.textContent=a(i,r))};e("tabLoginBtn","menu.login_config","Login / Config"),e("tabUserGroupBtn","menu.user","User"),e("tabUserProfileBtn","user.tab_profile","Profile"),e("tabUserApiKeysBtn","user.tab_api_keys","API Keys"),e("tabStrategiesBtn","menu.strategies","Strategies"),e("tabOmsGroupBtn","menu.oms","OMS"),e("tabPositionsBtn","positions.open_positions","Open Positions"),e("tabCommandsBtn","menu.ccxt_commands","CCXT Commands"),e("tabPostTradingGroupBtn","menu.post_trading","Post Trading"),e("tabPostTradingOrdersBtn","menu.post_trading_external_orders","External Orders"),e("tabSystemBtn","menu.system_monitor","System Monitor"),e("tabRiskGroupBtn","menu.risk","Risk"),e("tabRiskAccountsBtn","admin.accounts","Accounts"),e("tabRiskApiKeysBtn","menu.api_keys","API Keys"),e("tabAdminGroupBtn","menu.admin","Administration"),e("tabAdminBtn","admin.accounts","Accounts"),e("tabAdminUsersBtn","admin.users","Users"),e("tabAdminApiKeysBtn","menu.api_keys","API Keys"),e("tabAdminStatusBtn","admin.system_status","System Status"),e("tabAdminOmsBtn","menu.admin_oms_crud","OMS CRUD"),t("loginModeLabel","login.mode","Mode"),t("loginModeApiKeyOption","login.mode_api_key","API Key"),t("loginModeUserPassOption","login.mode_user_password","User + Password"),t("selectAllAccountsBtn","common.select_all","Select All"),t("clearAccountsBtn","common.clear","Clear"),t("viewAccountsLabel","trade.filter_accounts","Filter Accounts"),t("loginAuthBtn","login.authenticate","Authenticate"),t("connectBtn","trade.connect_ws","Connect WS"),t("disconnectBtn","trade.disconnect_ws","Disconnect"),t("refreshOmsBtn","trade.refresh_tables","Refresh Tables"),t("accountsBtn","trade.load_accounts","Reload Accounts"),t("tradeCreateStrategyTitle","trade.create_strategy","Create Strategy"),t("tradeCreateStrategyBtn","trade.create_strategy","Create Strategy"),t("tradeMyStrategiesTitle","trade.my_strategies","My Strategies"),t("loadTradeStrategiesBtn","trade.load_strategies","Load Strategies"),t("tradeStrategyNameLabel","trade.name","Name"),t("tradeStrategyAccountsLabel","trade.accounts","Accounts"),t("loadUserApiKeysBtn","user.load_api_keys","Reload API Keys"),t("userCreateApiKeyBtn","user.create_api_key","Create API Key"),t("userSaveProfileBtn","user.save_profile","Save Profile"),t("userSavePasswordBtn","user.save_password","Save Password"),t("riskSavePermissionBtn","risk.save_permission","Save Permission");const o=document.getElementById("closeByModal");o&&o.setAttribute("label",a("closeby.title","Close By")),ca(),m.tables.adminAccounts&&W(m.tables.adminAccounts,vs()),m.tables.adminUsers&&W(m.tables.adminUsers,$s()),m.tables.adminUsersKeys&&W(m.tables.adminUsersKeys,Os()),m.tables.adminUsersPermissions&&W(m.tables.adminUsersPermissions,Ts()),m.tables.userApiKeys&&W(m.tables.userApiKeys,Ds()),m.tables.userApiKeyPermissions&&W(m.tables.userApiKeyPermissions,Bs()),m.tables.riskPermissions&&W(m.tables.riskPermissions,Ns()),m.tables.riskAccountState&&W(m.tables.riskAccountState,Ms()),m.tables.riskStrategyState&&W(m.tables.riskStrategyState,zs()),m.tables.ccxtTrades&&W(m.tables.ccxtTrades,[{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("system.col_exchange_id","Exchange ID"),field:"exchange_id",width:140},{title:a("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:150},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("system.col_raw","Raw"),field:"raw_json",widthGrow:1,formatter:At},{title:a("system.col_observed_at","Observed At"),field:"observed_at",width:170}]),m.tables.ccxtOrders&&W(m.tables.ccxtOrders,[{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("system.col_exchange_id","Exchange ID"),field:"exchange_id",width:140},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:a("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:150},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("system.col_raw","Raw"),field:"raw_json",widthGrow:1,formatter:At},{title:a("system.col_observed_at","Observed At"),field:"observed_at",width:170}]),Object.values(m.tables).forEach(s=>{Ur(s)}),Tt(m.densityMode,!1),bs(),ws()}function bs(){const t=document.getElementById("apiKey"),e=document.getElementById("toggleApiKeyBtn");if(!t||!e)return;const o=t.type==="password",s=o?a("login.show","show"):a("login.hide","hide");e.setAttribute("aria-label",s),e.setAttribute("title",s),e.innerHTML=o?'<i class="fa-solid fa-eye" aria-hidden="true"></i>':'<i class="fa-solid fa-eye-slash" aria-hidden="true"></i>'}function ws(){const t=document.getElementById("loginPassword"),e=document.getElementById("toggleLoginPasswordBtn");if(!t||!e)return;const o=t.type==="password",s=o?a("login.show","show"):a("login.hide","hide");e.setAttribute("aria-label",s),e.setAttribute("title",s),e.innerHTML=o?'<i class="fa-solid fa-eye" aria-hidden="true"></i>':'<i class="fa-solid fa-eye-slash" aria-hidden="true"></i>'}function Hr(){const t=d("tabUserGroupBtn"),e=d("userSubmenu"),o=d("tabAdminGroupBtn"),s=d("adminSubmenu"),i=d("tabOmsGroupBtn"),r=d("omsSubmenu"),n=d("tabPostTradingGroupBtn"),c=d("postTradingSubmenu"),u=d("tabRiskGroupBtn"),g=d("riskSubmenu"),f=P=>{e.classList.toggle("is-hidden",!P),t.classList.toggle("active",P)},y=P=>{s.classList.toggle("is-hidden",!P),o.classList.toggle("active",P)},v=P=>{r.classList.toggle("is-hidden",!P),i.classList.toggle("active",P)},I=P=>{c.classList.toggle("is-hidden",!P),n.classList.toggle("active",P)},$=P=>{g.classList.toggle("is-hidden",!P),u.classList.toggle("active",P)};d("tabLoginBtn").addEventListener("click",()=>R("login")),t.addEventListener("click",()=>{const P=e.classList.contains("is-hidden");f(P),P&&R("userProfile")}),d("tabUserProfileBtn").addEventListener("click",()=>R("userProfile")),d("tabUserApiKeysBtn").addEventListener("click",()=>R("userApiKeys")),i.addEventListener("click",()=>{const P=r.classList.contains("is-hidden");v(P),P&&R("positions")}),d("tabPositionsBtn").addEventListener("click",()=>R("positions")),d("tabCommandsBtn").addEventListener("click",()=>R("commands")),d("tabSystemBtn").addEventListener("click",()=>R("system")),d("tabStrategiesBtn").addEventListener("click",()=>R("strategies")),u.addEventListener("click",()=>{const P=g.classList.contains("is-hidden");$(P),P&&R("riskAccounts")}),d("tabRiskAccountsBtn").addEventListener("click",()=>R("riskAccounts")),d("tabRiskApiKeysBtn").addEventListener("click",()=>R("riskApiKeys")),n.addEventListener("click",()=>{const P=c.classList.contains("is-hidden");I(P),P&&R("postTrading")}),d("tabPostTradingOrdersBtn").addEventListener("click",()=>R("postTrading")),o.addEventListener("click",()=>{const P=s.classList.contains("is-hidden");y(P),P&&R("admin")}),d("tabAdminBtn").addEventListener("click",()=>R("admin")),d("tabAdminUsersBtn").addEventListener("click",()=>R("adminUsers")),d("tabAdminApiKeysBtn").addEventListener("click",()=>R("adminApiKeys")),d("tabAdminStatusBtn").addEventListener("click",()=>R("adminStatus")),d("tabAdminOmsBtn").addEventListener("click",()=>R("adminOms")),f(!1),y(!1),v(!1),I(!1),$(!1)}function jr(){const t=d("app"),e=d("menuToggleBtn"),o=d("sidebarCollapseBtn"),s=()=>{const i=t.classList.contains("sidebar-collapsed");e.setAttribute("aria-expanded",String(!i)),e.setAttribute("title",i?"Abrir menu":"Fechar menu"),o.setAttribute("title",i?"Menu recolhido":"Recolher menu")};e.addEventListener("click",()=>{t.classList.toggle("sidebar-collapsed"),window.scrollTo({top:0,left:0,behavior:"auto"});const i=document.querySelector(".main-content");i&&typeof i.scrollTo=="function"&&i.scrollTo({top:0,left:0,behavior:"auto"}),s()}),o.addEventListener("click",()=>{t.classList.add("sidebar-collapsed"),s()}),s()}function _o(){const t=[Q(d("sendAccountId").value),Q(d("cancelOrderAccountId").value),Q(d("ccxtAccountId").value),Q(d("changeOrderAccountId").value),Q(d("positionChangeAccountId").value),Q(d("closePositionAccountId").value),Q(d("closeByAccountId").value),Q(d("riskAccountId").value),Q(d("riskStrategyAccountId").value),Q(d("riskPermAccountId").value)].filter(e=>Number.isFinite(e)&&e>0);return[...new Set(t)]}function po(t){const e=r=>{const n=String(r||"").toLowerCase();return n==="id"||n.endsWith("_id")||n.includes("seq")||n.includes("page")},o=r=>{const n=String(r||"").toLowerCase();return n.includes("qty")||n.includes("price")||n.includes("fee")||n.includes("pnl")||n.includes("cost")||n.includes("tick")||n.includes("step")},s=r=>{const n=String(r||"").toLowerCase();return n.startsWith("_")||n.includes("status")||n==="side"||n.includes("state")||n.includes("mode")||n.includes("role")||n.includes("level")||n.includes("kind")||n.includes("reconciled")},i=r=>{if(r==null)return"";const n=String(r).trim();if(!n)return"";const c=Number(n);if(!Number.isFinite(c))return n;const u=Math.max(0,Number(wt.decimalPlaces)||14),g=10**-u;if(Math.abs(c)<g)return"0";const f=(l,_)=>Number(l.toFixed(_)),y=(l,_)=>{const b=l.toFixed(_).replace(/\.?0+$/,"");return b==="-0"?"0":b},v=f(c,u),I=new Set,$=[];for(const l of wt.smartSteps||[]){const _=Math.max(0,Number(l)||0);I.has(_)||(I.add(_),$.push(_))}I.has(u)||$.unshift(u);let P=u;for(const l of $)f(c,l)===v&&(P=l);return y(c,P)};return Array.isArray(t)?t.map(r=>{if(!r||typeof r!="object")return r;const n={...r};return Array.isArray(n.columns)?(n.columns=po(n.columns),n):(n.hozAlign||(s(n.field)?n.hozAlign="center":e(n.field)||o(n.field)?n.hozAlign="right":n.hozAlign="left"),n.headerHozAlign||(s(n.field)?n.headerHozAlign="center":e(n.field)||o(n.field)?n.headerHozAlign="right":n.headerHozAlign="left"),!n.formatter&&o(n.field)&&(n.formatter=c=>i(c.getValue())),n)}):[]}function z(t,e,o={}){const s=window.Tabulator;if(!s)throw new Error("Tabulator not loaded");const i=document.getElementById(t),r={...o},n=String(r.height||r.maxHeight||"300px");delete r.maxHeight,i&&(i.classList.add("table-resizable"),i.style.height||(i.style.height=n));const c=new s(`#${t}`,{data:[],layout:"fitDataStretch",height:n,placeholder:()=>a("common.no_data","no data"),columns:po(e),...r});return c.__ccxtBuilt=!1,typeof c.on=="function"&&c.on("tableBuilt",()=>{c.__ccxtBuilt=!0,Array.isArray(c.__pendingColumns)&&typeof c.setColumns=="function"&&c.setColumns(c.__pendingColumns),c.__pendingColumns=null,c.__pendingRedraw&&typeof c.redraw=="function"&&c.redraw(!0),c.__pendingRedraw=!1}),i&&typeof ResizeObserver<"u"&&new ResizeObserver(()=>{fs(c)}).observe(i),c}function Vr(t,e,o="id"){if(e==null)return;const s=t.getData().filter(i=>String(i[o])!==String(e));t.setData(s)}function pe(t,e,o=400){t.addData([e],!0);const s=t.getData();s.length>o&&t.setData(s.slice(0,o))}function Wr(){return[{title:"",field:"_save",hozAlign:"center",headerHozAlign:"center",width:44,minWidth:44,maxWidth:44,widthGrow:0,widthShrink:0,resizable:!1,cssClass:"col-action",headerSort:!1,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-save" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C(),i=await A(`/admin/strategies/${o.strategy_id}`,{method:"PATCH",body:{name:String(o.name||"").trim()||null,status:String(o.status||"").trim()||null,client_strategy_id:ms(o.client_strategy_id,"client_strategy_id"),account_ids:Tr(o.account_ids,m.availableAccountIds)}},s);p("trade_update_strategy",i),await Se(s)}catch(s){p("trade_update_strategy_error",{error:String(s),strategy_id:o.strategy_id})}}},{title:"",field:"_toggle",hozAlign:"center",headerHozAlign:"center",width:44,minWidth:44,maxWidth:44,widthGrow:0,widthShrink:0,resizable:!1,cssClass:"col-action",headerSort:!1,formatter:t=>t.getRow().getData().status==="active"?'<i class="fa-solid fa-xmark icon-danger" title="Disable" aria-hidden="true"></i>':'<i class="fa-solid fa-check icon-ok" title="Enable" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData(),s=o.status==="active"?"disabled":"active";try{const i=C(),r=await A(`/admin/strategies/${o.strategy_id}`,{method:"PATCH",body:{status:s}},i);p("trade_toggle_strategy_status",r),await Se(i)}catch(i){p("trade_toggle_strategy_status_error",{error:String(i),strategy_id:o.strategy_id})}}},{title:a("trade.col_client_strategy_id","Client Strategy ID"),field:"client_strategy_id",editor:"input",width:145,formatter:t=>{const e=t.getValue();return e==null||String(e).trim()===""?"":String(e)}},{title:a("trade.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:a("trade.col_name","Name"),field:"name",editor:"input",width:240},{title:a("trade.col_status","Status"),field:"status",editor:"list",editorParams:{values:["active","disabled"]},width:110},{title:a("trade.col_account_ids","Accounts"),field:"account_ids",widthGrow:1,editor:"input",formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(", "):String(e||"")}}]}function vs(){return[{title:"",field:"_save",hozAlign:"center",headerSort:!1,width:56,minWidth:56,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-ok" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C();let i=o.extra_config_json;typeof i=="string"&&(i=de(i,{}));const r={exchange_id:String(o.exchange_id||"").trim()||null,label:String(o.label||"").trim()||null,position_mode:String(o.position_mode||"").trim()||null,is_testnet:!!o.is_testnet,status:String(o.status||"").trim()||null,extra_config_json:i&&typeof i=="object"?i:{}},n={};String(o.set_api_key||"").trim()&&(n.api_key=String(o.set_api_key||"").trim()),String(o.set_secret||"").trim()&&(n.secret=String(o.set_secret||"").trim()),String(o.set_passphrase||"").trim()&&(n.passphrase=String(o.set_passphrase||"").trim()),Object.keys(n).length>0&&(r.credentials=n);const c=await A(`/admin/accounts/${o.account_id}`,{method:"PATCH",body:r},s);p("admin_update_account",c),await Ct(s),kt("success",a("admin.accounts_save_ok","Conta salva com sucesso (ID: {id}).").replace("{id}",String(o.account_id||"")))}catch(s){p("admin_update_account_error",{error:String(s),account_id:o.account_id}),kt("error",`${a("admin.accounts_save_error","Erro ao salvar conta")}: ${String(s)}`)}}},{title:a("admin.col_account_id","Account ID"),field:"account_id",width:100},{title:a("admin.col_label","Label"),field:"label",editor:"input",width:180},{title:a("admin.col_exchange_id","Exchange ID"),field:"exchange_id",editor:"input",width:140},{title:a("admin.col_position_mode","Position Mode"),field:"position_mode",editor:"list",editorParams:{values:["hedge","netting","strategy_netting"]},width:150},{title:a("admin.col_extra_config_json","Extra Config JSON"),field:"extra_config_json",editor:"textarea",width:260},{title:a("admin.col_testnet","Testnet"),field:"is_testnet",formatter:"tickCross",editor:!0,width:90},{title:a("admin.col_status","Status"),field:"status",editor:"list",editorParams:{values:["active","blocked"]},width:100},{title:a("admin.col_reconcile_enabled","Reconcile Enabled"),field:"reconcile_enabled",width:120},{title:a("admin.col_dispatcher_worker_hint","Dispatcher Worker Hint"),field:"dispatcher_worker_hint",width:150},{title:a("admin.col_raw_storage_mode","Raw Storage Mode"),field:"raw_storage_mode",width:130},{title:a("oms.col_created_at","Created At"),field:"created_at",width:180},{title:a("admin.col_api_key_enc","API Key Enc"),field:"api_key_enc",width:240},{title:a("admin.col_secret_enc","Secret Enc"),field:"secret_enc",width:240},{title:a("admin.col_passphrase_enc","Passphrase Enc"),field:"passphrase_enc",width:220},{title:a("admin.col_credentials_updated_at","Credentials Updated At"),field:"credentials_updated_at",width:180},{title:a("admin.col_set_api_key","Set API Key"),field:"set_api_key",editor:"input",width:180},{title:a("admin.col_set_secret","Set Secret"),field:"set_secret",editor:"input",width:180},{title:a("admin.col_set_passphrase","Set Passphrase"),field:"set_passphrase",editor:"input",width:180}]}function Ss(){return new Date().toISOString()}function p(t,e){m.eventSeq+=1,pe(m.tables.events,{seq:m.eventSeq,at:Ss(),kind:t,payload:JSON.stringify(e).slice(0,2400)})}function Gr(){return typeof indexedDB<"u"}function Jr(t){let e=2166136261;const o=String(t||"");for(let s=0;s<o.length;s+=1)e^=o.charCodeAt(s),e=Math.imul(e,16777619);return`h${(e>>>0).toString(16).padStart(8,"0")}`}function Qe(){const t=String(document.getElementById("baseUrl")?.value||"").trim().toLowerCase(),e=String(document.getElementById("apiKey")?.value||"").trim();return!t&&!e?"h_anonymous":Jr(`${t}|${e}`)}function go(){return new Promise((t,e)=>{if(!Gr()){e(new Error("indexeddb_unavailable"));return}const o=indexedDB.open(G.dbName,G.version);o.onupgradeneeded=()=>{const s=o.result;s.objectStoreNames.contains(G.storeName)||s.createObjectStore(G.storeName,{keyPath:"id",autoIncrement:!0})},o.onsuccess=()=>t(o.result),o.onerror=()=>e(o.error||new Error("indexeddb_open_error"))})}function Te(t){return new Promise((e,o)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>o(t.error||new Error("indexeddb_request_error"))})}async function Qr(t){try{const e=await go();try{const o=e.transaction(G.storeName,"readwrite"),s=o.objectStore(G.storeName),i=Qe();await Te(s.add({...t,scope_hash:i,created_ts:Date.now()}));const r=Number(G.maxRows);if(Number.isFinite(r)&&r>0){const n=await Te(s.getAllKeys()),c=Math.max(0,(n?.length||0)-r);if(c>0)for(let u=0;u<c;u+=1)await Te(s.delete(n[u]))}await new Promise((n,c)=>{o.oncomplete=()=>n(!0),o.onerror=()=>c(o.error||new Error("indexeddb_tx_error")),o.onabort=()=>c(o.error||new Error("indexeddb_tx_abort"))})}finally{e.close()}}catch{}}async function ks(){if(m.tables.uiLogs)try{const t=await go();try{const o=t.transaction(G.storeName,"readonly").objectStore(G.storeName),s=await Te(o.getAll()),i=Qe(),r=(s||[]).filter(c=>String(c?.scope_hash||"h_anonymous")===i).map(c=>({seq:Number(c?.seq||0),at:String(c?.at||""),level:String(c?.level||"info"),message:String(c?.message||""),payload:String(c?.payload||"")}));m.tables.uiLogs.setData(r),typeof m.tables.uiLogs.setPage=="function"&&await m.tables.uiLogs.setPage(1);const n=r.reduce((c,u)=>Math.max(c,Number(u.seq||0)),0);m.uiLogSeq=Math.max(m.uiLogSeq,n),Me()}finally{t.close()}}catch{}}async function Xr(){try{const t=await go();try{const e=t.transaction(G.storeName,"readwrite"),o=e.objectStore(G.storeName),s=Qe(),i=await Te(o.getAll());for(const r of i||[])String(r?.scope_hash||"h_anonymous")===s&&r?.id!==void 0&&await Te(o.delete(r.id));await new Promise((r,n)=>{e.oncomplete=()=>r(!0),e.onerror=()=>n(e.error||new Error("indexeddb_tx_error")),e.onabort=()=>n(e.error||new Error("indexeddb_tx_abort"))})}finally{t.close()}}catch{}}function Me(){const t=m.tables.uiLogs,e=document.getElementById("uiLogsPageInfo"),o=document.getElementById("uiLogsPageInput");if(!t||!e)return;const s=Number(t.getPage?.()||1),i=Math.max(1,Number(t.getPageMax?.()||1));e.textContent=`${s} / ${i}`,o&&(o.value=String(s))}async function lt(t){const e=m.tables.uiLogs;if(!e||typeof e.setPage!="function")return;const o=Math.max(1,Number(e.getPageMax?.()||1)),s=Math.min(o,Math.max(1,Number(t)||1));await e.setPage(s),Me()}async function Yr(t){const e=m.tables.uiLogs;if(!e||typeof e.setPageSize!="function")return;const o=Math.max(1,Math.min(5e3,Number(t)||100));await e.setPageSize(o),await e.setPage(1),Me()}async function Ro(){m.tables.uiLogs&&m.tables.uiLogs.clearData(),m.uiLogSeq=0,await ks()}function T(t,e,o={}){if(!m.tables.uiLogs)return;m.uiLogSeq+=1;const s={seq:m.uiLogSeq,at:Ss(),level:String(t||"info"),message:String(e||""),payload:JSON.stringify(o).slice(0,2400)},i=Number(G.maxRows);Number.isFinite(i)&&i>0?pe(m.tables.uiLogs,s,i):pe(m.tables.uiLogs,s,Number.POSITIVE_INFINITY),Me(),Promise.resolve(Qr(s)).catch(()=>{})}function Dt(t){return t.map(e=>Number(e)).filter(e=>Number.isFinite(e)&&e>0).join(",")}async function Zr(t,e){const o=Dt(t),s=new URLSearchParams({account_ids:o,limit:"5000"}),[i,r]=await Promise.all([A(`/oms/orders/open?${s.toString()}`,{},e),A(`/oms/positions/open?${s.toString()}`,{},e)]);return{openOrders:i.items||[],openPositions:r.items||[]}}function he(t){const e=new Map;for(const o of t){const s=o.id!==void 0?String(o.id):o.row_id!==void 0?String(o.row_id):JSON.stringify(o);e.set(s,o)}return[...e.values()]}function ze(t){return[...t||[]].sort((e,o)=>{const s=e?.id??e?.row_id??"",i=o?.id??o?.row_id??"",r=Number(s),n=Number(i),c=Number.isFinite(r),u=Number.isFinite(n);return c&&u?r-n:c&&!u?-1:!c&&u?1:String(s).localeCompare(String(i))})}function Re(t,e){const o=Number(t);if(!Number.isFinite(o)||o<1)return 1;const s=Math.max(1,Number(e)||1);return Math.min(Math.trunc(o),s)}function As(t){const e=m.omsPager[t];if(!e)return;const o=`${t}PageInfo`,s=`${t}PageInput`,i=document.getElementById(o),r=document.getElementById(s);i&&(i.textContent=`${e.page} / ${e.totalPages}`),r&&(r.value=String(e.page))}function Bt(t,e,o=1,s=m.omsPageSize){const i=Math.max(1,Number(s)||m.omsPageSize),r=Math.max(0,Number(e)||0),n=Math.max(1,Math.ceil(r/i)),c=Re(o,n);m.omsPager[t]={page:c,pageSize:i,total:r,totalPages:n},As(t)}function ea(t){const e=m.adminPager[t];if(!e)return;const o=document.getElementById(`${t}PageInfo`),s=document.getElementById(`${t}PageInput`);o&&(o.textContent=`${e.page} / ${e.totalPages}`),s&&(s.value=String(e.page))}function ta(t,e,o=1,s=m.adminPager[t]?.pageSize||20){const i=Math.max(1,Number(s)||20),r=Math.max(0,Number(e)||0),n=Math.max(1,Math.ceil(r/i)),c=Re(o,n);m.adminPager[t]={page:c,pageSize:i,total:r,totalPages:n},ea(t)}function ho(t){const e=m.tables[t];if(!e)return;const o=Array.isArray(m.adminLocalData[t])?[...m.adminLocalData[t]]:[],s=m.adminPager[t]||{page:1,pageSize:20},i=Math.max(1,Number(s.pageSize||20)),r=Math.max(1,Math.ceil(o.length/i)),n=Re(s.page||1,r),c=(n-1)*i,u=o.slice(c,c+i);ta(t,o.length,n,i),e.setData(u)}function Zt(t,e,o=ze){const s=Array.isArray(e)?[...e]:[];m.adminLocalData[t]=typeof o=="function"?o(s):s,ho(t)}function ot(t){const o={openPositions:"openPositions",openOrders:"openOrders",symbolsList:"omsSymbols"}[t]||"openOrders",s=t==="symbolsList"?[...he(m.omsLocalData[t]||[])].sort((f,y)=>String(f?.symbol||f?.market_id||"").localeCompare(String(y?.symbol||y?.market_id||""))):ze(he(m.omsLocalData[t]||[])),i=m.omsPager[t],r=Math.max(1,Number(i?.pageSize||m.omsPageSize)),n=Math.max(1,Math.ceil(s.length/r)),c=Re(i?.page||1,n),u=(c-1)*r,g=s.slice(u,u+r);m.omsLocalData[t]=s,Bt(t,s.length,c,r),m.tables[o].setData(g)}function Le(t,e,o=null){m.omsLocalData[t]=t==="symbolsList"?[...he(e||[])].sort((s,i)=>String(s?.symbol||s?.market_id||"").localeCompare(String(i?.symbol||i?.market_id||""))):ze(he(e||[])),o!==null&&(m.omsPager[t].page=Math.max(1,Number(o)||1)),ot(t)}function Fo(t,e){const o=[...m.omsLocalData[t]||[]],s=o.findIndex(i=>String(i.id)===String(e.id));s>=0?o[s]={...o[s],...e}:o.push(e),m.omsLocalData[t]=ze(o),ot(t)}function dt(t,e){const o=(m.omsLocalData[t]||[]).filter(s=>String(s.id)!==String(e));m.omsLocalData[t]=o,ot(t)}function qo(t,e,o){const s=Array.isArray(o)?o.filter(n=>n&&typeof n=="object"):[];if(!Number.isFinite(Number(e))||Number(e)<=0){Le(t,s);return}const i=Number(e),r=(m.omsLocalData[t]||[]).filter(n=>Number(n.account_id)!==i);Le(t,[...r,...s])}function oa(t=new Date){const e=new Date(t.getFullYear(),t.getMonth()+1,0),o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${o}-${s}-${i}`}function sa(t){const e=new Date;e.setDate(e.getDate()-Math.max(0,Number(t)||0));const o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${o}-${s}-${i}`}function ia(t=new Date){const e=new Date(t.getFullYear(),t.getMonth(),1),o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${o}-${s}-${i}`}function ra(){const t=ia(),e=sa(7);return{startDate:e<t?e:t,endDate:oa()}}function aa(){const t=ra(),e=[["dealsStartDate","dealsEndDate"],["historyPositionsStartDate","historyPositionsEndDate"],["historyOrdersStartDate","historyOrdersEndDate"],["ccxtOrdersStartDate","ccxtOrdersEndDate"],["ccxtTradesStartDate","ccxtTradesEndDate"],["postTradingStartDate","postTradingEndDate"],["adminOmsStartDate","adminOmsEndDate"]];for(const[o,s]of e){const i=document.getElementById(o),r=document.getElementById(s);i&&!i.value&&(i.value=t.startDate),r&&!r.value&&(r.value=t.endDate)}}function na(t){const o={deals:["dealsStartDate","dealsEndDate"],historyPositions:["historyPositionsStartDate","historyPositionsEndDate"],historyOrders:["historyOrdersStartDate","historyOrdersEndDate"],ccxtOrders:["ccxtOrdersStartDate","ccxtOrdersEndDate"],ccxtTrades:["ccxtTradesStartDate","ccxtTradesEndDate"]}[t];if(!o)throw new Error("invalid history kind");const s=String(d(o[0]).value||"").trim(),i=String(d(o[1]).value||"").trim();if(!s||!i)throw new Error("start_date e end_date são obrigatórios");return{startDate:s,endDate:i}}async function H(t,e=!1){const o=C(),s=await tt(o),i=Dt(s),r=m.omsPager[t],n=e?1:Math.max(1,Number(r?.page||1)),c=Math.max(1,Number(r?.pageSize||m.omsPageSize)),{startDate:u,endDate:g}=na(t),y={deals:"/oms/deals",historyPositions:"/oms/positions/history",historyOrders:"/oms/orders/history",ccxtOrders:"/ccxt/orders/raw",ccxtTrades:"/ccxt/trades/raw"}[t],v=new URLSearchParams({account_ids:i,start_date:u,end_date:g,page:String(n),page_size:String(c)}),I=await A(`${y}?${v.toString()}`,{},o),$=he(I.items||[]);m.tables[t].setData($),Bt(t,Number(I.total||0),Number(I.page||n),Number(I.page_size||c))}const fo=["openPositions","openOrders","symbolsList","deals","historyPositions","historyOrders","ccxtOrders","ccxtTrades","postTrading","adminOms"],Nt=new Set(["openPositions","openOrders","symbolsList"]);function ca(){const t=a("common.previous","Previous"),e=a("common.next","Next"),o=a("common.copy","Copy"),s=a("common.export_csv","Export CSV"),i=a("common.export_excel","Export Excel"),r=a("common.export_json","Export JSON"),n=a("common.export_html","Export HTML");for(const c of[...fo,...ls]){const u=document.getElementById(`${c}PrevPageBtn`),g=document.getElementById(`${c}NextPageBtn`),f=document.getElementById(`${c}CopyBtn`),y=document.getElementById(`${c}ExportCsvBtn`),v=document.getElementById(`${c}ExportExcelBtn`),I=document.getElementById(`${c}ExportJsonBtn`),$=document.getElementById(`${c}ExportHtmlBtn`);u&&(u.setAttribute("title",t),u.setAttribute("aria-label",t)),g&&(g.setAttribute("title",e),g.setAttribute("aria-label",e)),f&&(f.setAttribute("title",o),f.setAttribute("aria-label",o)),y&&(y.setAttribute("title",s),y.setAttribute("aria-label",s)),v&&(v.setAttribute("title",i),v.setAttribute("aria-label",i)),I&&(I.setAttribute("title",r),I.setAttribute("aria-label",r)),$&&($.setAttribute("title",n),$.setAttribute("aria-label",n))}}function Cs(t){return Nt.has(t)?ze(he(m.omsLocalData[t]||[])):t==="postTrading"?[...m.tables[t]?.getData()||[]]:ze(he(m.tables[t]?.getData()||[]))}function xs(t){const e=m.tables[t];return e?e.getColumns().map(o=>o.getDefinition()).filter(o=>o&&o.field&&!String(o.field).startsWith("_")).map(o=>({field:String(o.field),title:String(o.title||o.field)})):[]}function Uo(t){const e=t==null?"":String(t);return/[",\n\r]/.test(e)?`"${e.replace(/"/g,'""')}"`:e}function Ls(t,e){const o=e.map(i=>Uo(i.title)).join(","),s=t.map(i=>e.map(r=>Uo(i[r.field])).join(",")).join(`
`);return`${o}
${s}`}function Ko(t,e){const o=r=>String(r??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s=e.map(r=>`<th>${o(r.title)}</th>`).join(""),i=t.map(r=>`<tr>${e.map(n=>`<td>${o(r[n.field])}</td>`).join("")}</tr>`).join(`
`);return`<!doctype html><html><head><meta charset="utf-8"><title>OMS Export</title></head><body><table border="1"><thead><tr>${s}</tr></thead><tbody>${i}</tbody></table></body></html>`}function ut(t,e,o="text/plain;charset=utf-8"){const s=new Blob([e],{type:o}),i=URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(i)}async function la(t){const e=Cs(t),o=xs(t),s=Ls(e,o);await navigator.clipboard.writeText(s),T("info",`OMS copy ok (${t})`,{rows:e.length})}function mt(t,e){const o=Cs(t),s=xs(t),i=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");if(e==="csv"){ut(`oms-${t}-${i}.csv`,Ls(o,s),"text/csv;charset=utf-8");return}if(e==="excel"){ut(`oms-${t}-${i}.xls`,Ko(o,s),"application/vnd.ms-excel;charset=utf-8");return}if(e==="json"){ut(`oms-${t}-${i}.json`,JSON.stringify(o,null,2),"application/json;charset=utf-8");return}ut(`oms-${t}-${i}.html`,Ko(o,s),"text/html;charset=utf-8")}async function _t(t,e){const o=m.omsPager[t];if(!o)return;const s=Re(e,o.totalPages);if(m.omsPager[t].page=s,t==="adminOms"){await ge(!1);return}if(t==="postTrading"){await it(!1);return}if(Nt.has(t)){ot(t);return}await H(t,!1)}async function da(t,e){const o=Math.max(1,Math.min(500,Number(e)||m.omsPageSize));if(m.omsPager[t].pageSize=o,m.omsPager[t].page=1,t==="adminOms"){await ge(!0);return}if(t==="postTrading"){await it(!0);return}if(Nt.has(t)){ot(t);return}await H(t,!0)}function pt(t,e){const o=m.adminPager[t];if(!o)return;const s=Re(e,o.totalPages);m.adminPager[t].page=s,ho(t)}function ua(t,e){const o=m.adminPager[t];if(!o)return;const s=Math.max(1,Math.min(500,Number(e)||o.pageSize||20));m.adminPager[t].pageSize=s,m.adminPager[t].page=1,ho(t)}async function ma(){const t=C(),e=await tt(t),o=await Zr(e,t);Le("openOrders",o.openOrders,1),Le("openPositions",o.openPositions,1),await Promise.all([H("deals",!0),H("historyPositions",!0),H("historyOrders",!0),H("ccxtOrders",!0),H("ccxtTrades",!0)]),Ae(`connected ${m.wsConnections.size} ws | viewing ${e.length} account(s)`,m.connected)}async function Fe(){const t=C(),e=await tt(t),o=Dt(e),s=await A(`/oms/positions/open?account_ids=${encodeURIComponent(o)}&limit=5000`,{},t);Le("openPositions",s.items||[])}async function st(){const t=C(),e=await tt(t),o=Dt(e),s=await A(`/oms/orders/open?account_ids=${encodeURIComponent(o)}&limit=5000`,{},t);Le("openOrders",s.items||[])}async function _a(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("order account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("order id inválido");const i=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"cancel_order",payload:{order_id:s}}},e);et(i,"cancel_order"),p("open_order_cancel_inline",{account_id:o,order_id:s,out:i}),await st()}async function pa(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("order account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("order id inválido");const i={order_id:s},r=String(t.qty??"").trim(),n=String(t.price??"").trim();if(r&&(i.new_qty=r),n&&(i.new_price=n),!i.new_qty&&!i.new_price)throw new Error("edite qty e/ou price antes de aplicar");const c=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"change_order",payload:i}},e);et(c,"change_order"),p("open_order_change_inline",{account_id:o,order_id:s,out:c}),await st()}async function ga(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("position account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("position id inválido");const i=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"close_position",payload:{position_id:s,order_type:"market"}}},e);et(i,"close_position"),p("open_position_close_inline",{account_id:o,position_id:s,out:i}),await Fe()}async function Ho(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("position account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("position id inválido");const i={position_id:s},r=t.stop_loss,n=t.stop_gain,c=t.comment;r!==void 0&&(i.oms_stop_loss=r===""||r===null?null:String(r).trim()),n!==void 0&&(i.oms_stop_gain=n===""||n===null?null:String(n).trim()),c!==void 0&&(i.comment=c===""||c===null?null:String(c));const u=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"position_change",payload:i}},e);et(u,"position_change"),p("open_position_change_inline",{account_id:o,position_id:s,out:u}),await Fe()}async function ha(){const e=(m.tables.openPositions?.getSelectedData?.()||[]).filter(u=>Number(u?.account_id)>0&&Number(u?.id)>0);if(e.length===0)throw new Error("select_rows");const o=C(),s=e.map(u=>({account_id:Number(u.account_id),command:"close_position",payload:{position_id:Number(u.id),order_type:"market"}})),i=await A("/oms/commands",{method:"POST",body:s},o),r=Array.isArray(i?.results)?i.results:[],n=r.filter(u=>u&&u.ok===!0).length,c=r.map((u,g)=>({r:u,idx:g})).filter(u=>!u.r||u.r.ok===!1).map(u=>{const g=s[u.idx]||{},f=u.r?.error||{};return{index:u.idx,account_id:g.account_id,position_id:g?.payload?.position_id,error:String(f.message||f.code||"dispatcher_error")}});p("open_positions_close_selected",{requested:e.length,ok:n,errors:c}),c.length>0?(_e("error",`${a("oms.bulk_close_positions_partial","Close selected positions finished with errors")} (${n}/${e.length})`),T("warn",a("oms.bulk_close_positions_partial","Close selected positions finished with errors"),{requested:e.length,ok:n,errors:c})):(_e("success",`${a("oms.bulk_close_positions_ok","Close selected positions ok")} (${n}/${e.length})`),T("info",a("oms.bulk_close_positions_ok","Close selected positions ok"),{requested:e.length,ok:n})),await Fe()}async function fa(){const e=(m.tables.openOrders?.getSelectedData?.()||[]).filter(f=>Number(f?.account_id)>0&&Number(f?.id)>0);if(e.length===0)throw new Error("select_rows");const o=C(),s=new Map;for(const f of e){const y=Number(f.account_id),v=Number(f.id);s.has(y)||s.set(y,[]),s.get(y).push(v)}const i=[...s.entries()].map(([f,y])=>{const v=[...new Set(y)];return{account_id:f,command:"cancel_order",payload:{order_ids:v,order_ids_csv:v.join(",")}}}),r=await A("/oms/commands",{method:"POST",body:i},o),c=(Array.isArray(r?.results)?r.results:[]).map((f,y)=>({r:f,idx:y})).filter(f=>!f.r||f.r.ok===!1).map(f=>{const y=i[f.idx]||{},v=f.r?.error||{};return{index:f.idx,account_id:y.account_id,order_ids:y?.payload?.order_ids||[],error:String(v.message||v.code||"dispatcher_error")}}),u=new Set(c.flatMap(f=>Array.isArray(f.order_ids)?f.order_ids:[])),g=e.filter(f=>!u.has(Number(f.id))).length;p("open_orders_cancel_selected",{requested:e.length,ok:g,errors:c}),c.length>0?(_e("error",`${a("oms.bulk_cancel_orders_partial","Cancel selected orders finished with errors")} (${g}/${e.length})`),T("warn",a("oms.bulk_cancel_orders_partial","Cancel selected orders finished with errors"),{requested:e.length,ok:g,errors:c})):(_e("success",`${a("oms.bulk_cancel_orders_ok","Cancel selected orders ok")} (${g}/${e.length})`),T("info",a("oms.bulk_cancel_orders_ok","Cancel selected orders ok"),{requested:e.length,ok:g})),await st()}function Es(){m.closeBySourceRow=null,d("closeBySourceId").value="",d("closeByTargetSelect").innerHTML="",d("closeBySourceInfo").textContent="",d("closeByModal").open=!1}function ya(t){const e=Number(t?.account_id||0),o=Number(t?.id||0),s=String(t?.symbol||""),i=String(t?.side||"").toLowerCase();if(!Number.isFinite(e)||e<=0||!Number.isFinite(o)||o<=0)throw new Error("source position inválida");const r=i==="buy"?"sell":"buy",c=(m.tables.openPositions.getData()||[]).filter(g=>Number(g.account_id)===e&&Number(g.id)!==o&&String(g.symbol||"")===s&&String(g.side||"").toLowerCase()===r);if(c.length===0)throw new Error("nenhuma posição oposta encontrada para close by");m.closeBySourceRow={...t},d("closeBySourceId").value=String(o),d("closeBySourceInfo").textContent=`${a("closeby.source_prefix","Source")} #${o} | ${a("closeby.account","account")} ${e} | ${s} | ${i}`;const u=d("closeByTargetSelect");u.innerHTML="";for(const g of c){const f=document.createElement("option");f.value=String(g.id),f.textContent=`#${g.id} | ${g.side} | qty=${g.qty}`,u.appendChild(f)}d("closeByModal").open=!0}async function ba(){const t=m.closeBySourceRow;if(!t)throw new Error("source position ausente");const e=Number(t.account_id||0),o=Number(t.id||0),s=Number(d("closeByTargetSelect").value||0);if(!Number.isFinite(e)||e<=0)throw new Error("account_id inválido");if(!Number.isFinite(o)||o<=0)throw new Error("position_id_a inválido");if(!Number.isFinite(s)||s<=0)throw new Error("position_id_b inválido");const i=C(),r=await A("/oms/commands",{method:"POST",body:{account_id:e,command:"close_by",payload:{position_id_a:o,position_id_b:s}}},i);et(r,"close_by"),p("open_position_close_by_inline",{account_id:e,position_id_a:o,position_id_b:s,out:r}),Es(),await Fe()}function wa(t,e=null){const o=t.namespace||"system",s=t.event||"event",i={...t.payload||{}};i.oms_stop_loss!==void 0&&i.stop_loss===void 0&&(i.stop_loss=i.oms_stop_loss),i.oms_stop_gain!==void 0&&i.stop_gain===void 0&&(i.stop_gain=i.oms_stop_gain);const r=i.account_id||e;if(p(`${o}:${s}`,{account_id:r,payload:t.payload||{}}),!i.account_id&&r&&(i.account_id=r),o==="position"){if(s==="snapshot_open_orders"&&Array.isArray(i.items)){qo("openOrders",i.account_id||e,i.items);return}if(s==="snapshot_open_positions"&&Array.isArray(i.items)){qo("openPositions",i.account_id||e,i.items);return}if(i.order_id||i.order_type||i.exchange_order_id){const n={...i};if(!n.id&&i.order_id&&(n.id=i.order_id),n.__deleted){dt("openOrders",n.id);return}new Set(["FILLED","CANCELED","REJECTED","CLOSED"]).has(String(n.status||"").toUpperCase())?dt("openOrders",n.id):Fo("openOrders",n)}if(i.exchange_trade_id||i.position_id){if(i.__deleted&&i.id){Vr(m.tables.deals,i.id);return}pe(m.tables.deals,i)}if(i.state||i.avg_price||i.side){const n={...i};if(!n.id&&i.position_id&&(n.id=i.position_id),n.__deleted){dt("openPositions",n.id);return}String(n.state||"").toLowerCase()==="closed"||String(n.qty||"")==="0"?dt("openPositions",n.id):Fo("openPositions",n)}}}function eo(){const t=mo();we(M.baseUrls,t.baseUrl),we(M.apiKeys,t.apiKey);for(const e of t.viewAccountIds)we(M.accountIds,e);for(const e of _o())we(M.accountIds,e);[St("sendStrategyId"),St("ccxtStrategyId")].forEach(e=>we(M.strategyIds,e)),Mt()}function Mt(){je("baseUrlHistory",re(M.baseUrls)),je("apiKeyHistory",re(M.apiKeys)),kr(re(M.accountIds)),je("strategyHistory",re(M.strategyIds))}function Is(){m.pingTimer&&(clearInterval(m.pingTimer),m.pingTimer=null);for(const t of m.wsConnections.values())t.close();m.wsConnections.clear(),m.subscribedAccountIds=[],m.connected=!1,Ae("disconnected",!1)}async function va(){const t=C();eo(),Is();const e=await tt(t),o=Nr(t.baseUrl),s=new WebSocket(o);m.wsConnections.set("main",s),m.subscribedAccountIds=[...e],s.onopen=async()=>{s.send(JSON.stringify({id:`auth-${Date.now()}`,action:"auth",payload:{api_key:t.apiKey}})),s.send(JSON.stringify({id:`sub-${Date.now()}`,action:"subscribe",payload:{account_ids:e,namespaces:["position","ccxt"],with_snapshot:!0}})),m.connected=!0,Ae(`connected 1 ws | viewing ${e.length} account(s)`,!0)},s.onmessage=i=>{try{const r=JSON.parse(i.data);wa(r,null)}catch(r){p("ws_parse_error",{raw:i.data,error:String(r)})}},s.onerror=()=>Ae("ws error",!1),s.onclose=()=>{m.wsConnections.delete("main"),Ae("disconnected",!1),m.connected=!1},m.pingTimer=setInterval(()=>{for(const[i,r]of m.wsConnections.entries())r.readyState===WebSocket.OPEN&&r.send(JSON.stringify({id:`ping-${i}-${Date.now()}`,action:"ping"}))},2e4)}function ye(t){return{title:"#",field:"_rownum",width:52,minWidth:52,maxWidth:52,hozAlign:"right",headerHozAlign:"right",headerSort:!1,cssClass:"col-rownum",formatter:e=>{const o=m.omsPager[t]||{page:1,pageSize:100},s=Math.max(1,Number(o.page)||1),i=Math.max(1,Number(o.pageSize)||100),r=Number(e.getRow().getPosition(!0)||1);return`<span class="rownum-badge">${(s-1)*i+r}</span>`}}}function jo(t,e="loss"){if(t==null||String(t).trim()==="")return"";const o=String(t).trim();return`<span class="risk-pill ${e==="gain"?"risk-pill-gain":"risk-pill-loss"}">${o}</span>`}function se(t){const e=String(t||"").trim(),o=e.toLowerCase();return o==="buy"?`<span class="side-pill side-buy">${e}</span>`:o==="sell"?`<span class="side-pill side-sell">${e}</span>`:e}function At(t){const e=t.getValue();if(e==null)return"";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}}function Ps(t){const e=[{title:a("oms.col_id","ID"),field:"id",width:84,editor:"input"},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:100,editor:"input"}];return t==="open_orders"||t==="history_orders"?[...e,{title:a("oms.col_command_id","Command ID"),field:"command_id",width:100,editor:"input"},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120,editor:"input"},{title:a("oms.col_side","Side"),field:"side",width:90,editor:"input",formatter:o=>se(o.getValue())},{title:a("oms.col_order_type","Order Type"),field:"order_type",width:100,editor:"input"},{title:a("oms.col_status","Status"),field:"status",width:120,editor:"input"},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100,editor:"input"},{title:a("oms.col_position_id","Position ID"),field:"position_id",width:100,editor:"input"},{title:a("oms.col_previous_position_id","Previous Position ID"),field:"previous_position_id",width:130,editor:"input"},{title:a("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:a("oms.col_price","Price"),field:"price",width:110,editor:"input"},{title:a("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120,editor:"input"},{title:a("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120,editor:"input"},{title:a("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:100,editor:"input"},{title:a("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:120,editor:"input"},{title:a("oms.col_reason","Reason"),field:"reason",width:120,editor:"input"},{title:a("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:a("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:140,editor:"input"},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150,editor:"input"},{title:a("post_trading.col_edit_replace_state","Edit Replace State"),field:"edit_replace_state",width:150,editor:"input"},{title:a("post_trading.col_edit_replace_at","Edit Replace At"),field:"edit_replace_at",width:170,editor:"input"},{title:a("post_trading.col_replace_orphan_order_id","Replace Orphan Order"),field:"edit_replace_orphan_order_id",width:170,editor:"input"},{title:a("post_trading.col_replace_origin_order_id","Replace Origin Order"),field:"edit_replace_origin_order_id",width:170,editor:"input"},{title:a("oms.col_created_at","Created At"),field:"created_at",width:170,editor:"input"},{title:a("oms.col_updated_at","Updated At"),field:"updated_at",width:170,editor:"input"},{title:a("oms.col_closed_at","Closed At"),field:"closed_at",width:170,editor:"input"}]:t==="open_positions"||t==="history_positions"?[...e,{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120,editor:"input"},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100,editor:"input"},{title:a("oms.col_side","Side"),field:"side",width:90,editor:"input",formatter:o=>se(o.getValue())},{title:a("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:a("oms.col_avg_price","Avg Price"),field:"avg_price",width:120,editor:"input"},{title:a("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120,editor:"input"},{title:a("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120,editor:"input"},{title:a("oms.col_state","State"),field:"state",width:100,editor:"input"},{title:a("oms.col_reason","Reason"),field:"reason",width:120,editor:"input"},{title:a("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:a("oms.col_opened_at","Opened At"),field:"opened_at",width:170,editor:"input"},{title:a("oms.col_updated_at","Updated At"),field:"updated_at",width:170,editor:"input"},{title:a("oms.col_closed_at","Closed At"),field:"closed_at",width:170,editor:"input"}]:[...e,{title:a("oms.col_order_id","Order ID"),field:"order_id",width:90,editor:"input"},{title:a("oms.col_position_id","Position ID"),field:"position_id",width:100,editor:"input"},{title:a("oms.col_previous_position_id","Previous Position ID"),field:"previous_position_id",width:130,editor:"input"},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120,editor:"input"},{title:a("oms.col_side","Side"),field:"side",width:90,editor:"input",formatter:o=>se(o.getValue())},{title:a("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:a("oms.col_price","Price"),field:"price",width:110,editor:"input"},{title:a("oms.col_fee","Fee"),field:"fee",width:100,editor:"input"},{title:a("oms.col_fee_currency","Fee Ccy"),field:"fee_currency",width:100,editor:"input"},{title:a("oms.col_pnl","PnL"),field:"pnl",width:100,editor:"input"},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100,editor:"input"},{title:a("oms.col_reason","Reason"),field:"reason",width:120,editor:"input"},{title:a("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:a("oms.col_reconciled","Reconciled"),field:"reconciled",width:110,editor:!0},{title:a("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:150,editor:"input"},{title:a("oms.col_created_at","Created At"),field:"created_at",width:170,editor:"input"},{title:a("oms.col_executed_at","Executed At"),field:"executed_at",width:170,editor:"input"}]}function $s(){return[{title:a("user.user_id","User ID"),field:"user_id",width:90},{title:a("user.user_name","User Name"),field:"user_name",width:190},{title:a("user.role","Role"),field:"role",width:120},{title:a("user.status","Status"),field:"status",width:110},{title:a("oms.col_created_at","Created At"),field:"created_at",width:180}]}function Os(){return[{title:a("user.user_id","User ID"),field:"user_id",width:90},{title:a("user.user_name","User Name"),field:"user_name",width:180},{title:a("user.role","Role"),field:"role",width:120},{title:a("admin.col_user_status","User Status"),field:"user_status",width:120},{title:a("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110},{title:a("admin.col_api_key_status","API Key Status"),field:"api_key_status",editor:"list",editorParams:{values:["active","disabled"]},width:140},{title:a("oms.col_created_at","Created At"),field:"created_at",width:180},{title:"",field:"_save",hozAlign:"center",headerSort:!1,width:56,minWidth:56,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-save" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C(),i=Number(o.api_key_id||0);if(!Number.isFinite(i)||i<=0)throw new Error("api_key_id inválido");const r=String(o.api_key_status||"").trim().toLowerCase();if(!["active","disabled"].includes(r))throw new Error("api_key_status inválido");const n=await A(`/admin/api-keys/${i}`,{method:"PATCH",body:{status:r}},s);p("admin_update_api_key_status",n),await De(s)}catch(s){p("admin_update_api_key_status_error",{error:String(s)}),T("error","Admin update API key status failed",{error:String(s)})}}}]}function Ts(){return[{title:a("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110},{title:a("user.user_id","User ID"),field:"user_id",width:90},{title:a("user.user_name","User Name"),field:"user_name",width:180},{title:a("common.account_id","Account ID"),field:"account_id",width:110},{title:a("risk.can_read","Read"),field:"can_read",width:95},{title:a("risk.can_trade","Trade"),field:"can_trade",width:95},{title:a("risk.can_close_position","Close Position"),field:"can_close_position",width:130},{title:a("risk.can_risk_manage","Risk Manage"),field:"can_risk_manage",width:130},{title:a("risk.can_block_new_positions","Block New Positions"),field:"can_block_new_positions",width:165},{title:a("risk.can_block_account","Block Account"),field:"can_block_account",width:125},{title:a("risk.restrict_to_strategies","Restrict To Strategies"),field:"restrict_to_strategies",width:170},{title:a("risk.strategy_ids","Strategy IDs"),field:"strategy_ids",width:170,formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(","):""}},{title:a("user.status","Status"),field:"status",width:100}]}function Ds(){return[{title:a("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:a("user.user_id","User ID"),field:"user_id",width:100,hozAlign:"right",headerHozAlign:"right"},{title:a("user.user_name","User Name"),field:"user_name",width:200},{title:a("user.role","Role"),field:"role",width:120},{title:a("admin.col_api_key_status","API Key Status"),field:"status",editor:"list",editorParams:{values:["active","disabled"]},width:130},{title:a("oms.col_created_at","Created At"),field:"created_at",width:180},{title:"",field:"_save",hozAlign:"center",headerSort:!1,width:56,minWidth:56,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-save" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C(),i=Number(o.api_key_id||0);if(!Number.isFinite(i)||i<=0)throw new Error("api_key_id invalido");const r=String(o.status||"").trim().toLowerCase();if(!["active","disabled"].includes(r))throw new Error("status invalido");const n=await A(`/user/api-keys/${i}`,{method:"PATCH",body:{status:r}},s);p("user_update_api_key_status",n),await Promise.all([Lt(s),Et(s)]),Z("success",a("user.api_key_status_updated","Status da API Key atualizado."))}catch(s){p("user_update_api_key_status_error",{error:String(s)}),Z("error",`${a("user.api_key_status_update_error","Erro ao atualizar status da API Key")}: ${String(s)}`)}}}]}function Bs(){return[{title:a("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:a("common.account_id","Account ID"),field:"account_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:a("risk.can_read","Read"),field:"can_read",width:100},{title:a("risk.can_trade","Trade"),field:"can_trade",width:100},{title:a("risk.can_close_position","Close Position"),field:"can_close_position",width:150},{title:a("risk.can_risk_manage","Risk Manage"),field:"can_risk_manage",width:140},{title:a("risk.can_block_new_positions","Block New Positions"),field:"can_block_new_positions",width:180},{title:a("risk.can_block_account","Block Account"),field:"can_block_account",width:150},{title:a("risk.restrict_to_strategies","Restrict To Strategies"),field:"restrict_to_strategies",width:170},{title:a("risk.strategy_ids","Strategy IDs"),field:"strategy_ids",width:180,formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(","):""}},{title:a("user.status","Status"),field:"status",width:100}]}function Ns(){return[{title:a("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:100,hozAlign:"right",headerHozAlign:"right"},{title:a("common.account_id","Account ID"),field:"account_id",width:100,hozAlign:"right",headerHozAlign:"right"},{title:a("risk.can_read","Read"),field:"can_read",width:95},{title:a("risk.can_trade","Trade"),field:"can_trade",width:95},{title:a("risk.can_close_position","Close Position"),field:"can_close_position",width:130},{title:a("risk.can_risk_manage","Risk Manage"),field:"can_risk_manage",width:130},{title:a("risk.can_block_new_positions","Block New Positions"),field:"can_block_new_positions",width:160},{title:a("risk.can_block_account","Block Account"),field:"can_block_account",width:140},{title:a("risk.restrict_to_strategies","Restrict To Strategies"),field:"restrict_to_strategies",width:160},{title:a("risk.strategy_ids","Strategy IDs"),field:"strategy_ids",width:160,formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(","):""}},{title:a("user.status","Status"),field:"status",width:95}]}function Ms(){return[{title:a("common.account_id","Account ID"),field:"account_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:a("admin.col_label","Label"),field:"label",width:180},{title:a("admin.col_exchange_id","Exchange ID"),field:"exchange_id",width:150},{title:a("admin.col_status","Status"),field:"status",width:120},{title:a("risk.allow_new_positions","Allow New Positions"),field:"allow_new_positions",width:170,formatter:"tickCross"}]}function zs(){return[{title:a("common.account_id","Account ID"),field:"account_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:120,hozAlign:"right",headerHozAlign:"right"},{title:a("trade.col_name","Name"),field:"name",width:220},{title:a("trade.col_status","Status"),field:"status",width:120},{title:a("risk.allow_new_positions","Allow New Positions"),field:"allow_new_positions",width:170,formatter:"tickCross"}]}function Sa(){m.tables.openPositions=z("openPositionsTable",[ye("openPositions"),{title:"",field:"_close",width:86,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='close' class='row-icon-btn' title='${a("common.close","Close")}' aria-label='${a("common.close","Close")}'><i class='fa-solid fa-xmark icon-danger' aria-hidden='true'></i></button> <button data-act='close_by' class='row-icon-btn' title='${a("cmd.position_close_by","Position Close By")}' aria-label='${a("cmd.position_close_by","Position Close By")}'><i class='fa-solid fa-right-left icon-ok' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(!s)return;const i=e.getRow().getData();try{if(s==="close"){await ga(i);return}if(s==="close_by"){ya(i);return}}catch(r){p("open_position_inline_error",{action:s,error:String(r),row:i}),T("error",`Open position action failed (${s})`,{error:String(r),row:i})}}},{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("oms.col_side","Side"),field:"side",width:90,formatter:t=>se(t.getValue())},{title:a("oms.col_qty","Qty"),field:"qty",width:110},{title:a("oms.col_avg_price","Avg Price"),field:"avg_price",width:130},{title:a("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120,editor:"input",formatter:t=>jo(t.getValue(),"loss")},{title:a("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120,editor:"input",formatter:t=>jo(t.getValue(),"gain")},{title:"",field:"_save_targets",width:46,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='save_targets' class='row-icon-btn' title='${a("common.apply","Apply")}' aria-label='${a("common.apply","Apply")}'><i class='fa-solid fa-floppy-disk icon-save' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(s!=="save_targets")return;const i=e.getRow().getData();try{await Ho(i)}catch(r){p("open_position_inline_error",{action:s,error:String(r),row:i}),T("error",`Open position action failed (${s})`,{error:String(r),row:i})}}},{title:a("oms.col_state","State"),field:"state",width:90},{title:a("oms.col_reason","Reason"),field:"reason",width:120},{title:a("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:"",field:"_save_comment",width:46,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='save_comment' class='row-icon-btn' title='${a("common.apply","Apply")}' aria-label='${a("common.apply","Apply")}'><i class='fa-solid fa-floppy-disk icon-save' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(s!=="save_comment")return;const i=e.getRow().getData();try{await Ho(i)}catch(r){p("open_position_inline_error",{action:s,error:String(r),row:i}),T("error",`Open position action failed (${s})`,{error:String(r),row:i})}}},{title:a("oms.col_opened_at","Opened At"),field:"opened_at",width:170},{title:a("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:a("oms.col_closed_at","Closed At"),field:"closed_at",width:170}],{selectableRows:!0,rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.openOrders=z("openOrdersTable",[ye("openOrders"),{title:"",field:"_close",width:46,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='cancel' class='row-icon-btn' title='${a("common.cancel","Cancel")}' aria-label='${a("common.cancel","Cancel")}'><i class='fa-solid fa-xmark icon-danger' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(!s)return;const i=e.getRow().getData();try{s==="cancel"&&await _a(i)}catch(r){p("open_order_inline_error",{action:s,error:String(r),row:i}),T("error",`Open order action failed (${s})`,{error:String(r),row:i})}}},{title:a("oms.col_command_id","Command ID"),field:"command_id",width:100},{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:110},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:a("oms.col_position_id","Position ID"),field:"position_id",width:100},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("oms.col_side","Side"),field:"side",width:80,formatter:t=>se(t.getValue())},{title:a("oms.col_order_type","Order Type"),field:"order_type",width:100},{title:a("oms.col_status","Status"),field:"status",width:110},{title:a("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:a("oms.col_price","Price"),field:"price",width:110,editor:"input"},{title:a("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120},{title:a("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120},{title:a("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:100},{title:a("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:120},{title:a("oms.col_reason","Reason"),field:"reason",width:120},{title:a("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:140},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:140},{title:a("oms.col_comment","Comment"),field:"comment",width:180},{title:a("oms.col_created_at","Created At"),field:"created_at",width:170},{title:a("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:a("oms.col_closed_at","Closed At"),field:"closed_at",width:170},{title:"",field:"_save",width:46,hozAlign:"right",headerHozAlign:"right",headerSort:!1,formatter:()=>`<button data-act='apply' class='row-icon-btn' title='${a("common.apply","Apply")}' aria-label='${a("common.apply","Apply")}'><i class='fa-solid fa-floppy-disk icon-save' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(s!=="apply")return;const i=e.getRow().getData();try{await pa(i)}catch(r){p("open_order_inline_error",{action:s,error:String(r),row:i}),T("error",`Open order action failed (${s})`,{error:String(r),row:i})}}}],{selectableRows:!0,rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.historyPositions=z("historyPositionsTable",[ye("historyPositions"),{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("oms.col_side","Side"),field:"side",width:90,formatter:t=>se(t.getValue())},{title:a("oms.col_qty","Qty"),field:"qty",width:110},{title:a("oms.col_avg_price","Avg Price"),field:"avg_price",width:130},{title:a("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120},{title:a("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120},{title:a("oms.col_state","State"),field:"state",width:90},{title:a("oms.col_reason","Reason"),field:"reason",width:120},{title:a("oms.col_comment","Comment"),field:"comment",width:180},{title:a("oms.col_opened_at","Opened At"),field:"opened_at",width:170},{title:a("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:a("oms.col_closed_at","Closed At"),field:"closed_at",width:170}]),m.tables.historyOrders=z("historyOrdersTable",[ye("historyOrders"),{title:a("oms.col_command_id","Command ID"),field:"command_id",width:100},{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:a("oms.col_position_id","Position ID"),field:"position_id",width:100},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("oms.col_side","Side"),field:"side",width:80,formatter:t=>se(t.getValue())},{title:a("oms.col_order_type","Order Type"),field:"order_type",width:100},{title:a("oms.col_status","Status"),field:"status",width:110},{title:a("oms.col_qty","Qty"),field:"qty",width:100},{title:a("oms.col_price","Price"),field:"price",width:110},{title:a("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120},{title:a("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120},{title:a("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:100},{title:a("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:120},{title:a("oms.col_reason","Reason"),field:"reason",width:120},{title:a("oms.col_comment","Comment"),field:"comment",width:180},{title:a("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:140},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:140},{title:a("oms.col_created_at","Created At"),field:"created_at",width:170},{title:a("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:a("oms.col_closed_at","Closed At"),field:"closed_at",width:170}]),m.tables.omsSymbols=z("omsSymbolsTable",[{title:a("oms.col_symbol","Symbol"),field:"symbol",width:220},{title:a("oms.col_market_id","Market ID"),field:"market_id",width:220},{title:a("oms.col_base","Base"),field:"base",width:120},{title:a("oms.col_quote","Quote"),field:"quote",width:120},{title:a("oms.col_market_type","Type"),field:"type",width:120},{title:a("oms.col_market_active","Active"),field:"active",width:100,formatter:"tickCross"},{title:a("oms.col_price_decimals","Price Decimals"),field:"price_decimals",width:120},{title:a("oms.col_qty_decimals","Qty Decimals"),field:"qty_decimals",width:120},{title:a("oms.col_price_min","Min Price"),field:"price_min",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_price_max","Max Price"),field:"price_max",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_qty_min","Min Qty"),field:"qty_min",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_qty_max","Max Qty"),field:"qty_max",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_cost_min","Min Cost"),field:"cost_min",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_cost_max","Max Cost"),field:"cost_max",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_tick_size","Tick Size"),field:"tick_size",width:120,formatter:t=>le(t.getValue())},{title:a("oms.col_step_size","Step Size"),field:"step_size",width:120,formatter:t=>le(t.getValue())}]),m.tables.deals=z("dealsTable",[ye("deals"),{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("oms.col_order_id","Order ID"),field:"order_id",width:84},{title:a("oms.col_position_id","Position ID"),field:"position_id",width:90},{title:a("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("oms.col_side","Side"),field:"side",width:80,formatter:t=>se(t.getValue())},{title:a("oms.col_qty","Qty"),field:"qty",width:100},{title:a("oms.col_price","Price"),field:"price",width:120},{title:a("oms.col_fee","Fee"),field:"fee",width:100},{title:a("oms.col_fee_currency","Fee Ccy"),field:"fee_currency",width:100},{title:a("oms.col_pnl","PnL"),field:"pnl",width:100},{title:a("oms.col_reason","Reason"),field:"reason",width:120},{title:a("oms.col_reconciled","Reconciled"),field:"reconciled",width:110},{title:a("oms.col_comment","Comment"),field:"comment",width:180},{title:a("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:130},{title:a("oms.col_created_at","Created At"),field:"created_at",width:170},{title:a("oms.col_executed_at","Executed At"),field:"executed_at",width:170}]),m.tables.ccxtTrades=z("ccxtTradesTable",[ye("ccxtTrades"),{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("system.col_exchange_id","Exchange ID"),field:"exchange_id",width:140},{title:a("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:150},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("system.col_raw","Raw"),field:"raw_json",widthGrow:1,formatter:At},{title:a("system.col_observed_at","Observed At"),field:"observed_at",width:170}]),m.tables.ccxtOrders=z("ccxtOrdersTable",[ye("ccxtOrders"),{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:a("system.col_exchange_id","Exchange ID"),field:"exchange_id",width:140},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:a("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:150},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:a("system.col_raw","Raw"),field:"raw_json",widthGrow:1,formatter:At},{title:a("system.col_observed_at","Observed At"),field:"observed_at",width:170}]),m.tables.events=z("eventsTable",[{title:a("system.col_seq","Seq"),field:"seq",width:70},{title:a("system.col_at","At"),field:"at",width:185},{title:a("system.col_kind","Kind"),field:"kind",width:170},{title:a("system.col_payload","Payload"),field:"payload",widthGrow:1}]),m.tables.uiLogs=z("uiLogsTable",[{title:a("system.col_seq","Seq"),field:"seq",width:70},{title:a("system.col_at","At"),field:"at",width:185},{title:a("system.col_level","Level"),field:"level",width:110},{title:a("system.col_message","Message"),field:"message",width:300},{title:a("system.col_payload","Payload"),field:"payload",widthGrow:1}],{pagination:!0,paginationMode:"local",paginationSize:100,paginationSizeSelector:[50,100,200,500,1e3]}),m.tables.postTrading=z("postTradingTable",[{title:a("oms.col_id","ID"),field:"id",width:84},{title:a("oms.col_account_id","Account ID"),field:"account_id",width:100},{title:a("system.col_exchange_id","Exchange"),field:"exchange_id",width:140},{title:a("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:a("oms.col_symbol","Symbol"),field:"symbol",width:130},{title:a("oms.col_side","Side"),field:"side",width:80,formatter:t=>se(t.getValue())},{title:a("oms.col_qty","Qty"),field:"qty",width:120,hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_price","Price"),field:"price",width:120,hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:120,hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:130,hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_status","Status"),field:"status",width:120},{title:a("oms.col_reconciled","Reconciled"),field:"reconciled",width:110},{title:a("post_trading.col_edit_replace_state","Edit Replace State"),field:"edit_replace_state",width:150},{title:a("post_trading.col_edit_replace_at","Edit Replace At"),field:"edit_replace_at",width:170},{title:a("post_trading.col_replace_origin_order_id","Replace Origin Order"),field:"edit_replace_origin_order_id",width:160},{title:a("post_trading.col_replace_orphan_order_id","Replace Orphan Order"),field:"edit_replace_orphan_order_id",width:160},{title:a("oms.col_previous_position_id","Previous Position ID"),field:"previous_position_id",width:130},{title:a("post_trading.col_target_strategy_id","Target Strategy ID"),field:"target_strategy_id",width:140,editor:"input",hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_strategy_id","Current Strategy ID"),field:"strategy_id",width:140,hozAlign:"right",headerHozAlign:"right"},{title:a("oms.col_created_at","Created At"),field:"created_at",width:170},{title:a("oms.col_executed_at","Executed At"),field:"executed_at",width:170}],{selectableRows:!0,rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.tradeStrategies=z("tradeStrategiesTable",Wr()),m.tables.adminOms=z("adminOmsTable",Ps("open_orders"),{selectableRows:!0,movableColumns:!0,maxHeight:"420px",rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.adminAccounts=z("adminAccountsTable",vs()),m.tables.adminUsers=z("adminUsersTable",$s()),m.tables.adminUsersKeys=z("adminUsersKeysTable",Os()),m.tables.adminUsersPermissions=z("adminUsersPermissionsTable",Ts()),m.tables.userApiKeys=z("userApiKeysTable",Ds()),m.tables.userApiKeyPermissions=z("userApiKeyPermissionsTable",Bs()),m.tables.riskPermissions=z("riskPermissionsTable",Ns()),m.tables.riskAccountState=z("riskAccountStateTable",Ms()),m.tables.riskStrategyState=z("riskStrategyStateTable",zs())}async function Ct(t=null){const e=t||C(),s=((await A("/admin/accounts",{},e)).items||[]).map(i=>({...i,extra_config_json:JSON.stringify(i.extra_config_json||{},null,2),set_api_key:"",set_secret:"",set_passphrase:""}));m.tables.adminAccounts.setData(s)}async function De(t=null){const e=t||C(),o=await A("/admin/users-api-keys",{},e),s=Array.isArray(o.items)?o.items:[];Zt("adminUsersKeys",s);const i=[];if(s.length>0){const r=new Map;for(const c of s)r.set(Number(c.api_key_id||0),c);const n=await Promise.all(s.map(async c=>{const u=Number(c.api_key_id||0);if(!Number.isFinite(u)||u<=0)return[];try{const g=await A(`/admin/api-keys/${u}/permissions`,{},e);return(Array.isArray(g.items)?g.items:[]).map(y=>{const v=r.get(u)||{};return{...y,api_key_id:u,user_id:Number(v.user_id||0)||null,user_name:String(v.user_name||"")}})}catch(g){return p("admin_load_api_key_permissions_error",{api_key_id:u,error:String(g)}),[]}}));for(const c of n)i.push(...c)}Zt("adminUsersPermissions",i,r=>[...r].sort((n,c)=>{const u=Number(n?.account_id||0),g=Number(c?.account_id||0);if(u!==g)return u-g;const f=Number(n?.api_key_id||0),y=Number(c?.api_key_id||0);return f-y}))}async function to(t=null){const e=t||C(),o=await A("/admin/users",{},e),s=Array.isArray(o.items)?o.items:[];Zt("adminUsers",s),Ir(s)}function Xe(t,e="info"){const o=document.getElementById("adminSystemStatusBox");o&&(o.textContent=String(t||"-"),o.classList.remove("notice-info","notice-success","notice-error"),e==="success"?o.classList.add("notice-success"):e==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"))}function F(t){return String(t??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function Rs(t,e,o=0){const s=Array.isArray(e);if(s||e!==null&&typeof e=="object"&&!s){const u=s?e.map((f,y)=>[String(y),f]):Object.entries(e);return u.length===0?`<li class="system-tree-leaf"><span class="k">${F(t)}</span><span class="v">${s?"[]":"{}"}</span></li>`:`<li class="system-tree-branch"><details open><summary><span class="folder">[+]</span><span class="k">${F(t)}</span><span class="meta">${F(s?`[${u.length}]`:`{${u.length}}`)}</span></summary><ul class="system-tree-list">${u.map(([f,y])=>Rs(f,y,o+1)).join("")}</ul></details></li>`}const r=e===null?"null":String(e),n=r.trim().toLowerCase();let c="v";return n==="ok"||n==="active"||n==="true"?c="v is-ok":n==="error"||n==="failed"||n==="false"?c="v is-error":/^-?\d+(\.\d+)?$/.test(n)?c=Number(n)>0?"v is-warn":"v is-muted":n==="null"&&(c="v is-muted"),`<li class="system-tree-leaf"><span class="k">${F(t)}</span><span class="${c}">${F(r)}</span></li>`}function Vo(t,e){const o=e===void 0?null:e;return`<div class="system-panel"><h4>${F(t)}</h4><ul class="system-tree-list root">${Rs("root",o,0)}</ul></div>`}function ka(t,e,o="",s=""){const i=document.getElementById("adminSystemStatusKpis"),r=document.getElementById("adminSystemStatusDetails");if(!i||!r)return;const n=Number(e?.started_at||0),c=n>0?new Date(n*1e3).toISOString():"-",u=Number(e?.ccxt_session_count_total??0),g=e?.ccxt_session_count_by_engine||{},f=Array.isArray(e?.ccxt_session_account_ids)?e.ccxt_session_account_ids:[],y=Number(e?.ccxt_session_oldest_age_seconds??0),v=Number(e?.ccxt_session_ttl_seconds??0);i.innerHTML=[`<div class="system-kpi"><span>${F(a("admin.api_status","API"))}</span><strong class="${t?"ok":"error"}">${F(t?String(t.status||"ok"):"error")}</strong></div>`,`<div class="system-kpi"><span>${F(a("admin.dispatcher_status","Dispatcher"))}</span><strong class="${e?"ok":"error"}">${F(e?"ok":"error")}</strong></div>`,`<div class="system-kpi"><span>DB</span><strong>${F(String(t?.db_engine||"-"))}</strong></div>`,`<div class="system-kpi"><span>Env</span><strong>${F(String(t?.env||"-"))}</strong></div>`,`<div class="system-kpi"><span>accounts_mapped</span><strong>${F(String(e?.accounts_mapped??"-"))}</strong></div>`,`<div class="system-kpi"><span>total_requests</span><strong>${F(String(e?.total_requests??"-"))}</strong></div>`,`<div class="system-kpi"><span>total_errors</span><strong>${F(String(e?.total_errors??"-"))}</strong></div>`,`<div class="system-kpi"><span>control_queue_depth</span><strong>${F(String(e?.control_queue_depth??"-"))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_count_total</span><strong>${F(String(u))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_count_by_engine</span><strong>${F(`${Number(g.ccxt||0)}/${Number(g.ccxtpro||0)}`)}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_accounts</span><strong>${F(String(f.length))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_oldest_age_s</span><strong>${F(String(y))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_ttl_s</span><strong>${F(String(v))}</strong></div>`,`<div class="system-kpi"><span>started_at</span><strong>${F(c)}</strong></div>`].join(""),r.innerHTML=[Vo("healthz",t||(o?{error:o}:{})),Vo("dispatcher/status",e||(s?{error:s}:{}))].join("")}function Wo(t){const e=document.getElementById("adminSystemStatusDetails");e&&e.querySelectorAll("details").forEach(o=>{o.open=!!t})}async function xt(t=null){const e=t||C();let o=null,s=null,i="",r="";try{const c=await fetch(`${e.baseUrl}/healthz`,{method:"GET"});if(!c.ok)throw new Error(`health ${c.status}`);o=await c.json()}catch(c){i=String(c)}try{s=(await A("/dispatcher/status",{},e))?.result||{}}catch(c){r=String(c)}if(ka(o,s,i,r),o&&s){const c=`${a("admin.api_status","API")}: ${String(o.status||"ok")} | ${a("admin.dispatcher_status","Dispatcher")}: ok`;Xe(c,"success");return}const n=`${a("admin.api_status","API")}: ${o?"ok":"error"}${i?` (${i})`:""} | ${a("admin.dispatcher_status","Dispatcher")}: ${s?"ok":"error"}${r?` (${r})`:""}`;Xe(n,"error")}async function Aa(t=null){const e=t||C(),o=await A("/oms/cache/clear",{method:"POST"},e),s=o?.result||{},i=String(s.scope||"unknown"),r=Number(s.cleared_before||0);return Xe(a("admin.clear_oms_cache_ok","Cache OMS limpo ({scope}, antes={count}).").replace("{scope}",i).replace("{count}",String(r)),"success"),await xt(e),o}async function oo(t=null){const e=t||C(),o=await A("/user/profile",{},e),s=String(o.role||""),i=d("userProfileRole");if(i&&!Array.from(i.options||[]).some(r=>String(r.value)===s)){const r=document.createElement("option");r.value=s,r.textContent=s,i.appendChild(r)}return d("userProfileUserId").value=String(o.user_id||""),d("userProfileName").value=String(o.user_name||""),d("userProfileRole").value=s,d("userProfileRole").dataset.currentValue=s,d("userProfileStatus").value=String(o.status||""),d("userProfileApiKeyId").value=String(o.api_key_id||""),o}async function Lt(t=null){const e=t||C(),o=await A("/user/api-keys",{},e);return m.tables.userApiKeys.setData(o.items||[]),o}async function Et(t=null){const e=t||C();try{const o=await A("/user/api-keys/permissions",{},e);return m.tables.userApiKeyPermissions.setData(o.items||[]),o}catch(o){const s=String(o||""),i=s.match(/^(\d+)\b/),r=i?Number(i[1]):0;if(r===404||r===405)try{const n=await A("/user/api-keys",{},e),u=(Array.isArray(n?.items)?n.items:[]).map(y=>Number(y?.api_key_id||0)).filter(y=>Number.isFinite(y)&&y>0).map(async y=>{try{const v=await A(`/user/api-keys/${y}/permissions`,{},e);return Array.isArray(v?.items)?v.items:[]}catch{return[]}}),g=await Promise.all(u),f=he(g.flat());return m.tables.userApiKeyPermissions.setData(f),f.length===0&&T("warn","User API key permissions endpoint unavailable",{status:r,error:s}),{items:f}}catch{return m.tables.userApiKeyPermissions.setData([]),T("warn","User API key permissions unavailable",{status:r,error:s}),{items:[]}}throw o}}async function Se(t=null){const e=t||C(),s=((await A("/strategies",{},e)).items||[]).slice().sort((i,r)=>{const n=f=>{const y=String(f||"").toLowerCase();return y==="active"?0:y==="disabled"?1:2},c=n(i?.status)-n(r?.status);if(c!==0)return c;const u=Number(i?.strategy_id||0),g=Number(r?.strategy_id||0);return u-g});m.tables.tradeStrategies.setData(s),Er(s);for(const i of s)Number(i.strategy_id)>0&&we(M.strategyIds,Number(i.strategy_id));Mt()}async function Go(t=null){const e=t||C(),o=Number(d("riskApiKeyId").value||0);if(!Number.isFinite(o)||o<=0)throw new Error("risk api_key_id is required");const s=await A(`/admin/api-keys/${o}/permissions`,{},e);m.tables.riskPermissions.setData(s.items||[]),p("risk_load_permissions",{api_key_id:o,rows:(s.items||[]).length})}async function ue(t=null){const e=t||C(),s=((await A("/oms/accounts",{},e)).items||[]).map(n=>({account_id:Number(n.account_id||0),label:String(n.label||"").trim(),exchange_id:String(n.exchange_id||"").trim(),status:String(n.status||"").trim(),allow_new_positions:!!n.allow_new_positions})).filter(n=>Number.isFinite(n.account_id)&&n.account_id>0);m.tables.riskAccountState.setData(s);let i=Number(d("riskStrategyAccountId").value||0);if((!Number.isFinite(i)||i<=0)&&(i=Number(d("riskAccountId").value||0)),(!Number.isFinite(i)||i<=0)&&s.length>0&&(i=Number(s[0].account_id)),!Number.isFinite(i)||i<=0){m.tables.riskStrategyState.setData([]);return}const r=await A(`/oms/risk/${i}/strategies`,{},e);m.tables.riskStrategyState.setData(r.items||[]),p("risk_load_states",{account_rows:s.length,strategy_rows:Number((r.items||[]).length),account_id:i})}async function Fs(t=null){const e=t||C(),o=await A("/meta/exchanges",{},e),s=d("adminExchangeIdSelect"),i=String(s.value||"").trim();s.innerHTML="";const r=c=>{const u=String(c||"").trim();if(!u)return"";const g=u.toLowerCase();return g.startsWith("ccxt.")||g.startsWith("ccxtpro.")?u:`ccxt.${u}`},n=(Array.isArray(o.items)?o.items:[]).map(c=>r(c)).filter(c=>!!c);for(const c of n){const u=document.createElement("option");u.value=String(c),u.textContent=String(c),s.appendChild(u)}i&&n.includes(i)?s.value=i:n.includes("ccxt.binance")?s.value="ccxt.binance":n[0]&&(s.value=String(n[0]))}async function ke(t=null){const e=t||C(),s=((await A("/oms/accounts",{},e)).items||[]).map(r=>({account_id:Number(r.account_id),label:String(r.label||"").trim(),trader_name:String(r.trader_name||"").trim(),exchange_id:String(r.exchange_id||"unknown").trim()||"unknown"})),i=s.map(r=>r.account_id).filter(r=>Number.isFinite(r)&&r>0);if(m.accountLabels.clear(),m.accountExchanges.clear(),s.forEach(r=>{if(Number.isFinite(r.account_id)&&r.account_id>0){const n=r.trader_name,c=r.label,u=m.userRole==="trader"?n||c:c||n;u&&m.accountLabels.set(r.account_id,u),m.accountExchanges.set(r.account_id,r.exchange_id)}}),m.availableAccountIds=i,i.length>0){if(ds(i),us(i),i.forEach(r=>we(M.accountIds,r)),Pe().length===0)for(const r of d("viewAccountsSelect").options)r.selected=!0;Mt(),d("sendAccountId").value||(d("sendAccountId").value=String(i[0])),d("omsSymbolsAccountId").value||(d("omsSymbolsAccountId").value=String(i[0])),d("cancelOrderAccountId").value||(d("cancelOrderAccountId").value=String(i[0])),d("ccxtAccountId").value||(d("ccxtAccountId").value=String(i[0])),d("changeOrderAccountId").value||(d("changeOrderAccountId").value=String(i[0])),d("positionChangeAccountId").value||(d("positionChangeAccountId").value=String(i[0])),d("closeByAccountId").value||(d("closeByAccountId").value=String(i[0])),d("riskAccountId").value||(d("riskAccountId").value=String(i[0])),d("riskStrategyAccountId").value||(d("riskStrategyAccountId").value=String(i[0])),d("riskPermAccountId").value||(d("riskPermAccountId").value=String(i[0]))}await ue(e),p("accounts_loaded",{ids:i,labels:Object.fromEntries(m.accountLabels.entries())})}function Ca(){jr(),Hr(),d("themeModeBtn").addEventListener("click",()=>xr()),d("densityModeBtn").addEventListener("click",()=>Lr()),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{m.themeMode==="system"&&vt("system",!1)});try{Rr()}catch(l){p("bind_wa_tabs_error",{error:String(l)})}const t=()=>{const l=d("loginMode").value;d("loginApiKeyFields").classList.toggle("is-hidden",l!=="api_key"),d("loginUserPassFields").classList.toggle("is-hidden",l!=="user_password")};d("loginLanguage").addEventListener("change",()=>{const l=String(d("loginLanguage").value||"").trim();l&&(m.locale=l,localStorage.setItem(M.language,l),ys(),vt(m.themeMode,!1),Tt(m.densityMode,!1))}),d("loginMode").addEventListener("change",t),t(),ct("info",""),d("loginForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=d("loginMode").value,h=d("baseUrl").value.trim().replace(/\/+$/,"");if(!h)throw new Error("base_url is required");if(_==="api_key"){m.userRole="";const b=d("apiKey").value.trim();if(!b)throw new Error("api_key is required");d("baseUrl").value=h,d("apiKey").value=b,eo(),await Ro(),await ke({baseUrl:h,apiKey:b,viewAccountIds:[]}),await Se({baseUrl:h,apiKey:b,viewAccountIds:[]}),p("login_api_key_ok",{base_url:h}),ct("success",a("login.success","Autenticação concluída com sucesso."))}else{const b=d("loginUserName").value.trim(),S=d("loginPassword").value;if(!b||!S)throw new Error("user_name e password sao obrigatorios");const k={user_name:b,password:S},x=await fetch(`${h}/auth/login-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),D=await x.text(),B=D?JSON.parse(D):{};if(!x.ok)throw new Error(`${x.status} ${JSON.stringify(B)}`);d("baseUrl").value=h;const E=String(B.token||"");d("apiKey").value=E,m.userRole=String(B.role||"").trim().toLowerCase(),eo(),await Ro(),await ke({baseUrl:h,apiKey:E,viewAccountIds:[]}),await Se({baseUrl:h,apiKey:E,viewAccountIds:[]}),p("login_user_password_ok",{user_id:B.user_id,role:B.role,api_key_id:B.api_key_id,expires_at:B.expires_at}),ct("success",a("login.success","Autenticação concluída com sucesso."))}}catch(_){p("login_error",{error:String(_)}),ct("error",`${a("login.error","Erro na autenticação")}: ${String(_)}`)}}),d("toggleApiKeyBtn").addEventListener("click",()=>{const l=d("apiKey"),_=l.type==="password"?"text":"password";l.type=_,bs()}),d("toggleLoginPasswordBtn").addEventListener("click",()=>{const l=d("loginPassword"),_=l.type==="password"?"text":"password";l.type=_,ws()}),d("connectBtn").addEventListener("click",async()=>{try{await va()}catch(l){Ae(String(l),!1)}}),d("disconnectBtn").addEventListener("click",()=>Is()),d("refreshOmsBtn").addEventListener("click",async()=>{try{await ma(),p("refresh_ok",{})}catch(l){p("refresh_error",{error:String(l)})}}),d("accountsBtn").addEventListener("click",async()=>{try{await ke()}catch(l){p("accounts_error",{error:String(l)})}}),d("refreshOpenPositionsBtn").addEventListener("click",async()=>{try{await Fe(),p("refresh_open_positions_ok",{})}catch(l){p("refresh_open_positions_error",{error:String(l)})}}),d("closeSelectedPositionsBtn").addEventListener("click",async()=>{try{await ha()}catch(l){const _=String(l||"");_.includes("select_rows")?_e("error",a("oms.select_open_positions_first","Select one or more open positions first")):(p("close_selected_positions_error",{error:_}),_e("error",`${a("oms.bulk_close_positions_failed","Close selected positions failed")}: ${_}`))}}),d("refreshOpenOrdersBtn").addEventListener("click",async()=>{try{await st(),p("refresh_open_orders_ok",{})}catch(l){p("refresh_open_orders_error",{error:String(l)})}}),d("cancelSelectedOrdersBtn").addEventListener("click",async()=>{try{await fa()}catch(l){const _=String(l||"");_.includes("select_rows")?_e("error",a("oms.select_open_orders_first","Select one or more open orders first")):(p("cancel_selected_orders_error",{error:_}),_e("error",`${a("oms.bulk_cancel_orders_failed","Cancel selected orders failed")}: ${_}`))}}),d("refreshDealsBtn").addEventListener("click",async()=>{try{await H("deals",!0),p("refresh_deals_ok",{})}catch(l){p("refresh_deals_error",{error:String(l)})}}),d("refreshHistoryPositionsBtn").addEventListener("click",async()=>{try{await H("historyPositions",!0),p("refresh_history_positions_ok",{})}catch(l){p("refresh_history_positions_error",{error:String(l)})}}),d("refreshHistoryOrdersBtn").addEventListener("click",async()=>{try{await H("historyOrders",!0),p("refresh_history_orders_ok",{})}catch(l){p("refresh_history_orders_error",{error:String(l)})}}),d("refreshOmsSymbolsBtn").addEventListener("click",async()=>{try{await gs(!0),p("refresh_oms_symbols_ok",{})}catch(l){p("refresh_oms_symbols_error",{error:String(l)}),T("error","OMS symbol list load failed",{error:String(l)})}});for(const l of fo){const _=document.getElementById(`${l}PrevPageBtn`),h=document.getElementById(`${l}NextPageBtn`),b=document.getElementById(`${l}PageInput`),S=document.getElementById(`${l}PageSize`),k=document.getElementById(`${l}CopyBtn`),x=document.getElementById(`${l}ExportCsvBtn`),D=document.getElementById(`${l}ExportExcelBtn`),B=document.getElementById(`${l}ExportJsonBtn`),E=document.getElementById(`${l}ExportHtmlBtn`);_&&_.addEventListener("click",async()=>{try{await _t(l,(m.omsPager[l]?.page||1)-1)}catch(O){p("oms_pager_prev_error",{key:l,error:String(O)})}}),h&&h.addEventListener("click",async()=>{try{await _t(l,(m.omsPager[l]?.page||1)+1)}catch(O){p("oms_pager_next_error",{key:l,error:String(O)})}}),b&&(b.addEventListener("keydown",async O=>{if(O.key==="Enter"){O.preventDefault();try{await _t(l,Number(b.value||1))}catch(j){p("oms_pager_page_input_error",{key:l,error:String(j)})}}}),b.addEventListener("blur",async()=>{try{await _t(l,Number(b.value||1))}catch(O){p("oms_pager_page_blur_error",{key:l,error:String(O)})}})),S&&S.addEventListener("change",async()=>{try{await da(l,Number(S.value||m.omsPageSize))}catch(O){p("oms_pager_size_error",{key:l,error:String(O)})}}),k&&k.addEventListener("click",async()=>{try{await la(l)}catch(O){p("oms_copy_error",{key:l,error:String(O)}),T("error",`OMS copy failed (${l})`,{error:String(O)})}}),x&&x.addEventListener("click",()=>{try{mt(l,"csv")}catch(O){p("oms_export_csv_error",{key:l,error:String(O)})}}),D&&D.addEventListener("click",()=>{try{mt(l,"excel")}catch(O){p("oms_export_excel_error",{key:l,error:String(O)})}}),B&&B.addEventListener("click",()=>{try{mt(l,"json")}catch(O){p("oms_export_json_error",{key:l,error:String(O)})}}),E&&E.addEventListener("click",()=>{try{mt(l,"html")}catch(O){p("oms_export_html_error",{key:l,error:String(O)})}})}for(const l of ls){const _=document.getElementById(`${l}PrevPageBtn`),h=document.getElementById(`${l}NextPageBtn`),b=document.getElementById(`${l}PageInput`),S=document.getElementById(`${l}PageSize`);_&&_.addEventListener("click",()=>{try{pt(l,(m.adminPager[l]?.page||1)-1)}catch(k){p("admin_pager_prev_error",{key:l,error:String(k)})}}),h&&h.addEventListener("click",()=>{try{pt(l,(m.adminPager[l]?.page||1)+1)}catch(k){p("admin_pager_next_error",{key:l,error:String(k)})}}),b&&(b.addEventListener("keydown",k=>{if(k.key==="Enter"){k.preventDefault();try{pt(l,Number(b.value||1))}catch(x){p("admin_pager_page_input_error",{key:l,error:String(x)})}}}),b.addEventListener("blur",()=>{try{pt(l,Number(b.value||1))}catch(k){p("admin_pager_page_blur_error",{key:l,error:String(k)})}})),S&&S.addEventListener("change",()=>{try{ua(l,Number(S.value||m.adminPager[l]?.pageSize||20))}catch(k){p("admin_pager_size_error",{key:l,error:String(k)})}})}d("closeByModalCancelBtn").addEventListener("click",()=>Es()),d("closeByModalConfirmBtn").addEventListener("click",async()=>{try{await ba()}catch(l){p("open_position_close_by_inline_error",{error:String(l)}),T("error","Open position action failed (close_by)",{error:String(l)})}}),d("refreshCcxtOrdersBtn").addEventListener("click",async()=>{try{await H("ccxtOrders",!0),p("refresh_ccxt_orders_ok",{})}catch(l){p("refresh_ccxt_orders_error",{error:String(l)}),T("error","Refresh CCXT orders failed",{error:String(l)})}}),d("refreshCcxtTradesBtn").addEventListener("click",async()=>{try{await H("ccxtTrades",!0),p("refresh_ccxt_trades_ok",{})}catch(l){p("refresh_ccxt_trades_error",{error:String(l)}),T("error","Refresh CCXT trades failed",{error:String(l)})}}),d("postTradingPreviewBtn").addEventListener("click",async()=>{try{await it(!0),p("post_trading_preview_ok",{})}catch(l){p("post_trading_preview_error",{error:String(l)}),ie("error",`${a("post_trading.preview_error","Preview failed")}: ${String(l)}`)}}),d("postTradingReconcileBtn").addEventListener("click",async()=>{try{await La()}catch(l){const _=String(l||"");_.includes("period_requires_date_range")?ie("error",a("post_trading.period_requires_date_range","Para scope Período, preencha Data Início e Data Fim.")):ie("error",`${a("post_trading.reconcile_error","Erro ao reconciliar")}: ${_}`),p("post_trading_reconcile_error",{error:String(l)})}}),d("postTradingApplyBtn").addEventListener("click",async()=>{try{await Ea()}catch(l){const _=String(l||"");_.includes("post_trading_select_rows")?ie("error",a("post_trading.select_rows","Select one or more rows to apply reassign.")):_.includes("post_trading_target_strategy_required")?ie("error",a("post_trading.target_strategy_required","Preencha o ID da estratégia alvo (> 0) nas linhas selecionadas.")):ie("error",`${a("post_trading.apply_error","Apply reassign failed")}: ${_}`),p("post_trading_apply_error",{error:String(l)})}}),d("clearEventsBtn").addEventListener("click",()=>m.tables.events.clearData()),d("clearUiLogsViewBtn").addEventListener("click",()=>{m.tables.uiLogs.clearData(),m.uiLogSeq=0,Me(),T("info","UI logs view cleared",{scope_hash:Qe()})}),d("clearUiLogsDbBtn").addEventListener("click",async()=>{try{await Xr(),m.tables.uiLogs.clearData(),m.uiLogSeq=0,Me(),T("warn","UI logs local db cleared",{scope_hash:Qe()})}catch(l){T("error","UI logs local db clear failed",{error:String(l)})}}),d("uiLogsPrevPageBtn").addEventListener("click",async()=>{try{await lt(Number(m.tables.uiLogs.getPage?.()||1)-1)}catch(l){p("ui_logs_pager_prev_error",{error:String(l)})}}),d("uiLogsNextPageBtn").addEventListener("click",async()=>{try{await lt(Number(m.tables.uiLogs.getPage?.()||1)+1)}catch(l){p("ui_logs_pager_next_error",{error:String(l)})}}),d("uiLogsPageInput").addEventListener("keydown",async l=>{if(l.key==="Enter"){l.preventDefault();try{await lt(Number(d("uiLogsPageInput").value||1))}catch(_){p("ui_logs_pager_input_error",{error:String(_)})}}}),d("uiLogsPageInput").addEventListener("blur",async()=>{try{await lt(Number(d("uiLogsPageInput").value||1))}catch(l){p("ui_logs_pager_blur_error",{error:String(l)})}}),d("uiLogsPageSize").addEventListener("change",async()=>{try{await Yr(Number(d("uiLogsPageSize").value||100))}catch(l){p("ui_logs_pager_size_error",{error:String(l)})}}),d("selectAllAccountsBtn").addEventListener("click",()=>{for(const l of d("viewAccountsSelect").options)l.selected=!0}),d("clearAccountsBtn").addEventListener("click",()=>{for(const l of d("viewAccountsSelect").options)l.selected=!1}),d("tradeStrategyAccountsAllBtn").addEventListener("click",()=>{for(const l of d("tradeStrategyAccountIds").options)l.selected=!0}),d("tradeStrategyAccountsClearBtn").addEventListener("click",()=>{for(const l of d("tradeStrategyAccountIds").options)l.selected=!1}),d("goToCreateStrategyBtn").addEventListener("click",()=>{R("strategies");const l=document.getElementById("tradeCreateStrategyForm"),_=l?l.querySelector("input[name='name']"):null;_&&typeof _.focus=="function"&&_.focus()});const e=()=>{const l=d("ccxtMode").value;d("ccxtGenericFields").classList.toggle("is-hidden",l!=="generic"),d("ccxtCoreFields").classList.toggle("is-hidden",l!=="core")},o={load_markets:{reload:!1,params:{}},fetch_markets:{params:{}},fetch_ticker:{symbol:"BTC/USDT",params:{}},fetch_tickers:{symbols:null,params:{}},fetch_balance:{},fetch_open_orders:{symbol:"BTC/USDT",since:null,limit:200,params:{}},fetch_order:{id:"",symbol:null,params:{}},cancel_order:{id:"",symbol:null,params:{}},create_order:{symbol:"BTC/USDT",side:"buy",order_type:"market",amount:"0.001",params:{}}},s=()=>{const l=d("ccxtCoreFunc").value,_=o[l]||{};d("ccxtCoreBody").value=JSON.stringify(_,null,2)};d("ccxtMode").addEventListener("change",e),d("ccxtCoreFunc").addEventListener("change",s),e(),s(),d("loadSymbolsBtn").addEventListener("click",async()=>{try{const l=C(),_=U("sendAccountId","send_order"),h=await A(`/ccxt/${_}/load_markets`,{method:"POST",body:{args:[],kwargs:{}}},l),b=_s(h.result),S=ps(b);je("symbolHistory",S.slice(0,2e3)),!d("sendSymbol").value&&S[0]&&(d("sendSymbol").value=S[0]),p("load_symbols",{account_id:_,count:S.length}),T("info","Load symbols ok",{account_id:_,count:S.length,sample:S.slice(0,5)})}catch(l){p("load_symbols_error",{error:String(l)}),T("error","Load symbols failed",{error:String(l)})}}),d("sendOrderForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=new FormData(l.currentTarget),b=U("sendAccountId","send_order"),S=St("sendStrategyId"),k={account_id:b,command:"send_order",payload:{symbol:String(h.get("symbol")||""),side:String(h.get("side")||"buy"),order_type:String(h.get("order_type")||"market"),qty:String(h.get("qty")||""),strategy_id:S,position_id:Number(h.get("position_id")||0)||0,post_only:h.get("post_only")==="on",reduce_only:h.get("reduce_only")==="on"}},x=String(h.get("time_in_force")||"").trim(),D=String(h.get("price")||"").trim(),B=String(h.get("trigger_price")||"").trim(),E=String(h.get("stop_price")||"").trim(),O=String(h.get("take_profit_price")||"").trim(),j=String(h.get("trailing_amount")||"").trim(),Rt=String(h.get("trailing_percent")||"").trim();D&&(k.payload.price=D),x&&(k.payload.time_in_force=x),B&&(k.payload.trigger_price=B),E&&(k.payload.stop_price=E),O&&(k.payload.take_profit_price=O),j&&(k.payload.trailing_amount=j),Rt&&(k.payload.trailing_percent=Rt);const rt=String(h.get("oms_stop_loss")||"").trim(),yo=String(h.get("oms_stop_gain")||"").trim(),bo=String(h.get("comment")||"").trim(),wo=String(h.get("params_json")||"").trim();rt&&(k.payload.oms_stop_loss=rt),yo&&(k.payload.oms_stop_gain=yo),bo&&(k.payload.comment=bo),wo&&(k.payload.params=de(wo,{}));const Qs=await A("/oms/commands",{method:"POST",body:k},_);p("send_order",Qs)}catch(_){p("send_order_error",{error:String(_)})}}),d("cancelOrderForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("cancelOrderAccountId","cancel_order"),b=new FormData(l.currentTarget),S=String(b.get("order_ids_csv")||"").trim();if(!S)throw new Error("order_ids_csv is required");const k=ft(S);if(k.length===0)throw new Error("nenhum order_id válido no CSV");const x={account_id:h,command:"cancel_order",payload:{order_id:k.length===1?k[0]:null,order_ids:k,order_ids_csv:S}},D=await A("/oms/commands",{method:"POST",body:x},_);p("cancel_order",{account_id:h,count:k.length,out:D})}catch(_){p("cancel_order_error",{error:String(_)})}}),d("cancelAllBtn").addEventListener("click",async()=>{try{const l=C(),_=U("cancelOrderAccountId","cancel_all_orders"),h=String(d("cancelAllStrategyIdsCsv").value||"").trim(),b=ft(h),k=await A("/oms/commands",{method:"POST",body:{account_id:_,command:"cancel_all_orders",payload:{strategy_ids:b,strategy_ids_csv:h||null}}},l);p("cancel_all_orders",{account_id:_,strategy_ids:b,out:k})}catch(l){p("cancel_all_orders_error",{error:String(l)})}}),d("changeOrderForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("changeOrderAccountId","change_order"),b=new FormData(l.currentTarget),k={order_id:Number(b.get("order_id"))},x=String(b.get("new_qty")||"").trim(),D=String(b.get("new_price")||"").trim();x&&(k.new_qty=x),D&&(k.new_price=D);const E=await A("/oms/commands",{method:"POST",body:{account_id:h,command:"change_order",payload:k}},_);p("change_order",{account_id:h,out:E})}catch(_){p("change_order_error",{error:String(_)})}}),d("positionChangeForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("positionChangeAccountId","position_change"),b=new FormData(l.currentTarget),k={position_id:Number(b.get("position_id"))},x=String(b.get("oms_stop_loss")||"").trim(),D=String(b.get("oms_stop_gain")||"").trim(),B=String(b.get("comment")||"").trim(),E=d("positionChangeUseStopLoss").checked,O=d("positionChangeUseStopGain").checked,j=d("positionChangeUseComment").checked;if(E&&(k.oms_stop_loss=x||null),O&&(k.oms_stop_gain=D||null),j&&(k.comment=B||null),!E&&!O&&!j)throw new Error("marque ao menos um campo para alterar");const rt=await A("/oms/commands",{method:"POST",body:{account_id:h,command:"position_change",payload:k}},_);p("position_change",{account_id:h,out:rt})}catch(_){p("position_change_error",{error:String(_)})}}),d("closePositionForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("closePositionAccountId","close_position"),b=new FormData(l.currentTarget),S=Number(b.get("position_id"));if(!Number.isFinite(S)||S<=0)throw new Error("position_id is required");const k=String(b.get("oms_stop_loss")||"").trim(),x=String(b.get("oms_stop_gain")||"").trim(),D=String(b.get("comment")||"").trim(),B=String(b.get("params_json")||"").trim(),E={position_id:S,order_type:"market",post_only:b.get("post_only")==="on",reduce_only:b.get("reduce_only")==="on"};k&&(E.oms_stop_loss=k),x&&(E.oms_stop_gain=x),D&&(E.comment=D),B&&(E.params=de(B,{}));const j=await A("/oms/commands",{method:"POST",body:{account_id:h,command:"close_position",payload:E}},_);p("close_position",{account_id:h,position_id:S,out:j})}catch(_){p("close_position_error",{error:String(_)})}}),d("closeByForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("closeByAccountId","close_by"),b=new FormData(l.currentTarget),S=Number(b.get("position_id_a")),k=Number(b.get("position_id_b"));if(!Number.isFinite(S)||S<=0)throw new Error("position_id_a is required");if(!Number.isFinite(k)||k<=0)throw new Error("position_id_b is required");const x=String(b.get("qty")||"").trim(),D={account_id:h,command:"close_by",payload:{position_id_a:S,position_id_b:k}};x&&(D.payload.qty=x);const B=await A("/oms/commands",{method:"POST",body:D},_);p("close_by",{account_id:h,out:B})}catch(_){p("close_by_error",{error:String(_)})}}),d("mergePositionsForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("mergePositionsAccountId","merge_positions"),b=new FormData(l.currentTarget),S=Number(b.get("source_position_id")),k=Number(b.get("target_position_id"));if(!Number.isFinite(S)||S<=0)throw new Error("source_position_id is required");if(!Number.isFinite(k)||k<=0)throw new Error("target_position_id is required");if(S===k)throw new Error("source_position_id and target_position_id must differ");const x={source_position_id:S,target_position_id:k,stop_mode:String(b.get("stop_mode")||"keep").trim()||"keep"},D=String(b.get("oms_stop_loss")||"").trim(),B=String(b.get("oms_stop_gain")||"").trim();D&&(x.oms_stop_loss=D),B&&(x.oms_stop_gain=B);const O=await A("/oms/commands",{method:"POST",body:{account_id:h,command:"merge_positions",payload:x}},_);p("merge_positions",{account_id:h,out:O})}catch(_){p("merge_positions_error",{error:String(_)})}}),d("ccxtCallForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=U("ccxtAccountId","ccxt_call"),b=St("ccxtStrategyId"),S=new FormData(l.currentTarget);if(d("ccxtMode").value==="core"){const x=String(S.get("core_func")||"").trim(),D=de(String(S.get("core_body")||"{}"),{}),B=await A(`/ccxt/core/${h}/${encodeURIComponent(x)}`,{method:"POST",body:D},_);Vt(B),p("ccxt_core_call",{strategy_id:b,func:x,out:B});const E=B.result||{};E.account_id=E.account_id||h,(E.exchange_trade_id||x.includes("trade"))&&pe(m.tables.ccxtTrades,E),(E.exchange_order_id||x.includes("order"))&&pe(m.tables.ccxtOrders,E)}else{const x=String(S.get("func")||"").trim(),D=de(String(S.get("args")||"[]"),[]),B=de(String(S.get("kwargs")||"{}"),{}),E=await A(`/ccxt/${h}/${encodeURIComponent(x)}`,{method:"POST",body:{args:D,kwargs:B}},_);Vt(E),p("ccxt_call",{strategy_id:b,func:x,out:E});const O=E.result||{};O.account_id=O.account_id||h,(O.exchange_trade_id||x.includes("trade"))&&pe(m.tables.ccxtTrades,O),(O.exchange_order_id||x.includes("order"))&&pe(m.tables.ccxtOrders,O)}}catch(_){Vt({ok:!1,error:String(_)}),p("ccxt_call_error",{error:String(_)})}}),d("adminCreateAccountForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=new FormData(l.currentTarget),b=await A("/admin/accounts",{method:"POST",body:{exchange_id:String(h.get("exchange_id")||"").trim(),label:String(h.get("label")||"").trim(),position_mode:String(h.get("position_mode")||"hedge"),is_testnet:h.get("is_testnet")==="on",extra_config_json:de(String(h.get("extra_config_json")||"{}"),{})}},_);p("admin_create_account",b),await ke(_),await Ct(_)}catch(_){p("admin_create_account_error",{error:String(_)})}}),d("userProfileForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=String(d("userProfileName").value||"").trim();if(!h)throw new Error("user_name is required");const b=await A("/user/profile",{method:"PATCH",body:{user_name:h}},_);p("user_profile_update",b),await oo(_),Z("success",a("user.profile_updated","Perfil atualizado com sucesso."))}catch(_){p("user_profile_update_error",{error:String(_)}),Z("error",`${a("user.profile_update_error","Erro ao atualizar perfil")}: ${String(_)}`)}}),d("userPasswordForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=String(d("userCurrentPassword").value||""),b=String(d("userNewPassword").value||"");if(!h||!b)throw new Error("current_password and new_password are required");const S=await A("/user/password",{method:"POST",body:{current_password:h,new_password:b}},_);p("user_password_update",S),d("userCurrentPassword").value="",d("userNewPassword").value="",Z("success",a("user.password_updated","Senha atualizada com sucesso."))}catch(_){p("user_password_update_error",{error:String(_)}),Z("error",`${a("user.password_update_error","Erro ao atualizar senha")}: ${String(_)}`)}}),d("userCreateApiKeyForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=String(d("userNewApiKeyValue").value||"").trim(),b={};h&&(b.api_key=h);const S=await A("/user/api-keys",{method:"POST",body:b},_);p("user_create_api_key",S),d("userNewApiKeyValue").value="";const k=d("userCreatedApiKeyBox");k.textContent=a("user.api_key_created","API Key criada. id={api_key_id} key={key}").replace("{api_key_id}",String(S.api_key_id||"")).replace("{key}",String(S.api_key_plain||"")),k.classList.remove("is-hidden","notice-error"),k.classList.add("notice-info"),await Promise.all([Lt(_),Et(_)]),Z("success",a("user.api_key_created_success","API Key criada com sucesso."))}catch(_){p("user_create_api_key_error",{error:String(_)});const h=d("userCreatedApiKeyBox");h.textContent=`${a("user.api_key_create_error","Erro ao criar API Key")}: ${String(_)}`,h.classList.remove("is-hidden","notice-info"),h.classList.add("notice-error"),Z("error",`${a("user.api_key_create_error","Erro ao criar API Key")}: ${String(_)}`)}}),d("loadUserApiKeysBtn").addEventListener("click",async()=>{try{const l=C();await Promise.all([oo(l),Lt(l),Et(l)]),Z("success",a("user.reloaded","Dados do usuário recarregados."))}catch(l){p("user_load_error",{error:String(l)}),Z("error",`${a("user.load_error","Erro ao carregar dados do usuário")}: ${String(l)}`)}}),d("adminCreateUserApiKeyForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=new FormData(l.currentTarget),b=de(String(h.get("permissions")||"[]"),[]),S=await A("/admin/users-with-api-key",{method:"POST",body:{user_name:String(h.get("user_name")||"").trim(),role:String(h.get("role")||"trader").trim(),password:String(h.get("password")||"").trim()||null,permissions:b}},_);p("admin_create_user_api_key",S),S.api_key_plain&&(d("loginMode").value="api_key",d("apiKey").value=String(S.api_key_plain),t()),await to(_),await De(_)}catch(_){p("admin_create_user_api_key_error",{error:String(_)})}});const i=document.getElementById("adminOmsViewTabs");if(i){const l=()=>{const _=String(i.active||i.getAttribute("active")||"open_orders");m.adminOmsView=_||"open_orders"};l(),i.addEventListener("click",async _=>{const h=_.target&&_.target.closest?_.target.closest("wa-tab"):null,b=String(h?.getAttribute?.("panel")||"").trim();if(b){m.adminOmsView=b,i.active=b,i.setAttribute("active",b);try{await ge(!0)}catch(S){p("admin_oms_change_view_error",{error:String(S)})}}}),i.addEventListener("wa-tab-show",async()=>{l();try{await ge(!0)}catch(_){p("admin_oms_change_view_error",{error:String(_)})}})}d("adminOmsLoadBtn").addEventListener("click",async()=>{try{await ge(!0),Y("info",""),p("admin_oms_load",{ok:!0})}catch(l){p("admin_oms_load_error",{error:String(l)}),Y("error",`${a("admin.oms_load_error","Erro ao carregar Admin OMS")}: ${String(l)}`),T("error","Admin OMS load failed",{error:String(l)})}}),d("adminOmsAddRowBtn").addEventListener("click",()=>Oa()),d("adminOmsSaveSelectedBtn").addEventListener("click",async()=>{try{await Ta()}catch(l){p("admin_oms_save_error",{error:String(l)});const _=String(l||"");_.includes("admin_oms_unlock_required")?Y("error",a("admin.oms_unlock_before_save","Ative 'Unlock dangerous mode' antes de salvar.")):_.includes("admin_oms_select_rows")?Y("error",a("admin.oms_select_rows","Selecione uma ou mais linhas no checkbox da esquerda.")):Y("error",`${a("admin.oms_save_error","Erro ao salvar")}: ${_}`),T("error","Admin OMS save failed",{error:String(l)})}}),d("adminOmsDeleteSelectedBtn").addEventListener("click",async()=>{try{await Da()}catch(l){p("admin_oms_delete_error",{error:String(l)});const _=String(l||"");_.includes("admin_oms_unlock_required")?Y("error",a("admin.oms_unlock_before_delete","Ative 'Unlock dangerous mode' antes de deletar.")):_.includes("admin_oms_select_rows")?Y("error",a("admin.oms_select_rows","Selecione uma ou mais linhas no checkbox da esquerda.")):Y("error",`${a("admin.oms_delete_error","Erro ao deletar")}: ${_}`),T("error","Admin OMS delete failed",{error:String(l)})}}),d("loadAdminAccountsBtn").addEventListener("click",async()=>{try{await Ct(),p("admin_load_accounts",{ok:!0}),kt("info",a("admin.accounts_loaded","Contas carregadas."))}catch(l){p("admin_load_accounts_error",{error:String(l)}),kt("error",`${a("admin.accounts_load_error","Erro ao carregar contas")}: ${String(l)}`)}}),d("adminRefreshSystemStatusBtn").addEventListener("click",async()=>{try{await xt(),p("admin_system_status_refresh_ok",{ok:!0})}catch(l){p("admin_system_status_refresh_error",{error:String(l)}),Xe(`${a("admin.status_error","Erro ao consultar estado")}: ${String(l)}`,"error")}});const r=document.getElementById("adminClearOmsCacheBtn");r&&r.addEventListener("click",async()=>{try{const l=await Aa();p("admin_oms_cache_clear_ok",l?.result||{})}catch(l){p("admin_oms_cache_clear_error",{error:String(l)}),Xe(`${a("admin.clear_oms_cache_error","Erro ao limpar cache OMS")}: ${String(l)}`,"error")}});const n=document.getElementById("adminExpandSystemTreeBtn");n&&n.addEventListener("click",()=>Wo(!0));const c=document.getElementById("adminCollapseSystemTreeBtn");c&&c.addEventListener("click",()=>Wo(!1)),d("loadAdminUsersKeysBtn").addEventListener("click",async()=>{try{await De(),p("admin_load_users_keys",{ok:!0})}catch(l){p("admin_load_users_keys_error",{error:String(l)})}}),d("loadAdminUsersBtn").addEventListener("click",async()=>{try{await to(),p("admin_load_users",{ok:!0})}catch(l){p("admin_load_users_error",{error:String(l)})}}),d("adminCreateApiKeyForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=Number(d("adminApiKeyUserId").value||0);if(!Number.isFinite(h)||h<=0)throw new Error("user_id inválido");const b=String(d("adminApiKeyLabel").value||"").trim(),S=String(d("adminApiKeyValue").value||"").trim(),k={user_id:h};S&&(k.api_key=S),b&&(k.label=b);const x=await A("/admin/api-keys",{method:"POST",body:k},_);p("admin_create_api_key",x);const D=String(x.api_key_plain||"");zo("success",a("admin.api_key_created","API Key criada. user_id={user_id} api_key_id={api_key_id} key={key}").replace("{user_id}",String(x.user_id)).replace("{api_key_id}",String(x.api_key_id)).replace("{key}",D)),Pr({userId:h,apiKeyId:Number(x.api_key_id||0),key:D,label:b}),await De(_)}catch(_){p("admin_create_api_key_error",{error:String(_)}),zo("error",`${a("admin.api_key_create_error","Erro ao criar API Key")}: ${String(_)}`),T("error","Admin create API key failed",{error:String(_)})}});const u=document.getElementById("adminApiKeyCreatedCopyBtn");u&&u.addEventListener("click",async()=>{const l=document.getElementById("adminApiKeyCreatedValue"),_=l?String(l.value||""):"";try{if(!_)throw new Error("api_key_empty");if(!navigator.clipboard||typeof navigator.clipboard.writeText!="function")throw new Error("clipboard_unavailable");await navigator.clipboard.writeText(_),T("success",a("admin.api_key_modal_copy_success","API Key copied to clipboard"))}catch(h){T("error","API key copy failed",{error:String(h)})}});const g=document.getElementById("adminApiKeyCreatedCloseBtn");g&&g.addEventListener("click",()=>$r()),d("loadCcxtExchangesBtn").addEventListener("click",async()=>{try{await Fs(),p("admin_load_ccxt_exchanges",{ok:!0})}catch(l){p("admin_load_ccxt_exchanges_error",{error:String(l)})}}),d("tradeCreateStrategyForm").addEventListener("submit",async l=>{l.preventDefault();try{const _=C(),h=new FormData(l.currentTarget),b=await A("/strategies",{method:"POST",body:{name:String(h.get("name")||"").trim(),account_ids:Or(),client_strategy_id:ms(h.get("client_strategy_id"),"client_strategy_id")}},_);p("trade_create_strategy",b),await Se(_)}catch(_){p("trade_create_strategy_error",{error:String(_)})}}),d("loadTradeStrategiesBtn").addEventListener("click",async()=>{try{await Se(),p("trade_load_strategies",{ok:!0})}catch(l){p("trade_load_strategies_error",{error:String(l)})}}),d("riskAllowNewPositionsBtn").addEventListener("click",async()=>{try{const l=C(),_=U("riskAccountId","risk"),h=String(d("riskAccountComment").value||"").trim();if(!h)throw new Error(a("risk.comment_required","risk comment is required"));const b=await A(`/oms/risk/${_}/allow_new_positions`,{method:"POST",body:{allow_new_positions:!0,comment:h}},l);p("risk_allow_new_positions",b),await ue(l)}catch(l){p("risk_allow_new_positions_error",{error:String(l)})}}),d("riskBlockNewPositionsBtn").addEventListener("click",async()=>{try{const l=C(),_=U("riskAccountId","risk"),h=String(d("riskAccountComment").value||"").trim();if(!h)throw new Error(a("risk.comment_required","risk comment is required"));const b=await A(`/oms/risk/${_}/allow_new_positions`,{method:"POST",body:{allow_new_positions:!1,comment:h}},l);p("risk_block_new_positions",b),await ue(l)}catch(l){p("risk_block_new_positions_error",{error:String(l)})}}),d("riskSetAccountActiveBtn").addEventListener("click",async()=>{try{const l=C(),_=U("riskAccountId","risk"),h=String(d("riskAccountComment").value||"").trim();if(!h)throw new Error(a("risk.comment_required","risk comment is required"));const b=await A(`/oms/risk/${_}/status`,{method:"POST",body:{status:"active",comment:h}},l);p("risk_set_account_active",b),await ue(l)}catch(l){p("risk_set_account_active_error",{error:String(l)})}}),d("riskSetAccountBlockedBtn").addEventListener("click",async()=>{try{const l=C(),_=U("riskAccountId","risk"),h=String(d("riskAccountComment").value||"").trim();if(!h)throw new Error(a("risk.comment_required","risk comment is required"));const b=await A(`/oms/risk/${_}/status`,{method:"POST",body:{status:"blocked",comment:h}},l);p("risk_set_account_blocked",b),await ue(l)}catch(l){p("risk_set_account_blocked_error",{error:String(l)})}}),d("riskAllowStrategyBtn").addEventListener("click",async()=>{try{const l=C(),_=U("riskStrategyAccountId","risk_strategy"),h=Number(d("riskStrategyId").value||0),b=String(d("riskStrategyComment").value||"").trim();if(!Number.isFinite(h)||h<0)throw new Error(a("risk.strategy_id_invalid","strategy_id invalid"));if(!b)throw new Error(a("risk.comment_required","risk comment is required"));const S=await A(`/oms/risk/${_}/strategies/allow_new_positions`,{method:"POST",body:{strategy_id:h,allow_new_positions:!0,comment:b}},l);p("risk_allow_strategy",S),await ue(l)}catch(l){p("risk_allow_strategy_error",{error:String(l)})}}),d("riskBlockStrategyBtn").addEventListener("click",async()=>{try{const l=C(),_=U("riskStrategyAccountId","risk_strategy"),h=Number(d("riskStrategyId").value||0),b=String(d("riskStrategyComment").value||"").trim();if(!Number.isFinite(h)||h<0)throw new Error(a("risk.strategy_id_invalid","strategy_id invalid"));if(!b)throw new Error(a("risk.comment_required","risk comment is required"));const S=await A(`/oms/risk/${_}/strategies/allow_new_positions`,{method:"POST",body:{strategy_id:h,allow_new_positions:!1,comment:b}},l);p("risk_block_strategy",S),await ue(l)}catch(l){p("risk_block_strategy_error",{error:String(l)})}});const f=document.getElementById("riskRefreshStatesBtn");f&&f.addEventListener("click",async()=>{try{await ue()}catch(l){p("risk_load_states_error",{error:String(l)})}}),d("riskLoadPermissionsBtn").addEventListener("click",async()=>{try{await Go()}catch(l){p("risk_load_permissions_error",{error:String(l)})}}),d("riskSavePermissionBtn").addEventListener("click",async()=>{try{const l=C(),_=Number(d("riskApiKeyId").value||0),h=U("riskPermAccountId","risk_permission");if(!Number.isFinite(_)||_<=0)throw new Error("risk api_key_id is required");const b={account_id:h,can_read:d("riskCanRead").checked,can_trade:d("riskCanTrade").checked,can_close_position:d("riskCanClosePosition").checked,can_risk_manage:d("riskCanRiskManage").checked,can_block_new_positions:d("riskCanBlockNewPositions").checked,can_block_account:d("riskCanBlockAccount").checked,restrict_to_strategies:d("riskRestrictStrategies").checked,strategy_ids:ft(d("riskStrategyIdsCsv").value)},S=await A(`/admin/api-keys/${_}/permissions`,{method:"PUT",body:b},l);p("risk_save_permission",{api_key_id:_,account_id:h,out:S}),await Go(l)}catch(l){p("risk_save_permission_error",{error:String(l)})}});const y=d("adminCreateUserApiKeyForm"),v=d("userProfileRole"),I=y.querySelector("select[name='role']"),$=y.querySelector("textarea[name='permissions']");v.addEventListener("change",()=>{const l=String(v.dataset.currentValue||v.value||"");v.value=l});const P=()=>{const l=String(I.value||"trader").trim();$.value=JSON.stringify(Br(l),null,2)};I.addEventListener("change",P),P()}function R(t){let e=t==="user"?"userProfile":t;e==="risk"&&(e="riskAccounts");const s=new Set(["login","userProfile","userApiKeys","commands","positions","postTrading","system","strategies","riskAccounts","riskApiKeys","admin","adminUsers","adminApiKeys","adminStatus","adminOms"]).has(e)?e:"login";localStorage.setItem(M.activeMenu,s);const i=s==="login",r=s==="userProfile",n=s==="userApiKeys",c=r||n,u=s==="commands",g=s==="positions",f=u||g,y=s==="postTrading",v=s==="system",I=s==="strategies",$=s==="riskAccounts",P=s==="riskApiKeys",l=$||P,_=s==="admin",h=s==="adminUsers",b=s==="adminApiKeys",S=s==="adminStatus",k=s==="adminOms",x=(E,O)=>{const j=d(E);j.classList.toggle("active",O),j.setAttribute("variant","neutral")};x("tabLoginBtn",i),x("tabUserProfileBtn",r),x("tabUserApiKeysBtn",n),x("tabCommandsBtn",u),x("tabPositionsBtn",g),x("tabPostTradingOrdersBtn",y),x("tabSystemBtn",v),x("tabStrategiesBtn",I),x("tabRiskAccountsBtn",$),x("tabRiskApiKeysBtn",P),x("tabAdminBtn",_),x("tabAdminUsersBtn",h),x("tabAdminApiKeysBtn",b),x("tabAdminStatusBtn",S),x("tabAdminOmsBtn",k),d("tabUserGroupBtn").classList.toggle("active",c),d("tabOmsGroupBtn").classList.toggle("active",f),d("tabPostTradingGroupBtn").classList.toggle("active",y),d("tabRiskGroupBtn").classList.toggle("active",l);const D=_||h||b||S||k;d("tabAdminGroupBtn").classList.toggle("active",D),d("userSubmenu").classList.toggle("is-hidden",!c),d("omsSubmenu").classList.toggle("is-hidden",!f),d("riskSubmenu").classList.toggle("is-hidden",!l),d("adminSubmenu").classList.toggle("is-hidden",!D),d("postTradingSubmenu").classList.toggle("is-hidden",!y),d("loginPanel").classList.toggle("is-hidden",!i),d("userPanel").classList.toggle("is-hidden",!c),d("commandsPanel").classList.toggle("is-hidden",!u),d("positionsPanel").classList.toggle("is-hidden",!g),d("postTradingPanel").classList.toggle("is-hidden",!y),d("systemPanel").classList.toggle("is-hidden",!v),d("strategiesPanel").classList.toggle("is-hidden",!I),d("riskPanel").classList.toggle("is-hidden",!l),d("riskAccountsSection").classList.toggle("is-hidden",!$),d("riskApiKeysSection").classList.toggle("is-hidden",!P),d("adminPanel").classList.toggle("is-hidden",!(_||h||b||S)),d("adminOmsPanel").classList.toggle("is-hidden",!k),d("adminStatusSection").classList.toggle("is-hidden",!S),d("adminAccountsSection").classList.toggle("is-hidden",!_),d("adminUsersSection").classList.toggle("is-hidden",!h),d("adminApiKeysSection").classList.toggle("is-hidden",!b),window.scrollTo({top:0,left:0,behavior:"auto"});const B=document.querySelector(".main-content");if(B&&typeof B.scrollTo=="function"&&B.scrollTo({top:0,left:0,behavior:"auto"}),_&&Promise.all([Ct(),Fs(),xt()]).catch(E=>{p("admin_load_accounts_error",{error:String(E)})}),S&&xt().catch(E=>{p("admin_system_status_load_error",{error:String(E)})}),h&&Promise.all([to(),De()]).catch(E=>{p("admin_load_users_error",{error:String(E)})}),b&&Promise.all([De()]).catch(E=>{p("admin_load_users_keys_error",{error:String(E)})}),k&&ge(!0).catch(E=>{p("admin_oms_load_error",{error:String(E)})}),c){const E=document.getElementById("userProfileSection"),O=document.getElementById("userApiKeysSection");E&&E.classList.toggle("is-hidden",!r),O&&O.classList.toggle("is-hidden",!n),Promise.all([oo(),Lt(),Et()]).catch(j=>{p("user_load_error",{error:String(j)})})}y&&it(!0).catch(E=>{p("post_trading_load_error",{error:String(E)})}),(u||I)&&Se().catch(E=>{p("trade_load_strategies_error",{error:String(E)})}),l&&ke().catch(E=>{p("risk_load_accounts_error",{error:String(E)})})}function xa(){const t=re(M.baseUrls),e=re(M.apiKeys),o=re(M.accountIds),s=re(M.strategyIds),i=String(localStorage.getItem(M.themeMode)||"system").trim();vt(i,!1);const r=String(localStorage.getItem(M.densityMode)||"normal").trim();Tt(r,!1);const n=String(localStorage.getItem(M.language)||"pt-BR").trim();m.locale=Ve[n]?n:"pt-BR",Kr(m.locale),ys(),t[0]?d("baseUrl").value=String(t[0]):d("baseUrl").value="http://127.0.0.1:8000",e[0]&&(d("apiKey").value=String(e[0]));const c=o[0]?String(o[0]):"1";d("sendAccountId").value=c,d("ccxtAccountId").value=c,d("cancelOrderAccountId").value=c,d("closePositionAccountId").value=c,d("riskAccountId").value=c,d("riskStrategyAccountId").value=c,d("riskPermAccountId").value=c,ds([]),us([]);const u=s[0]!==void 0?String(s[0]):"0";d("sendStrategyId").value=u,d("ccxtStrategyId").value=u;const g=d("adminExchangeIdSelect");if(g.options.length===0){const f=document.createElement("option");f.value="",f.textContent="",g.appendChild(f),g.value=""}aa();for(const f of fo){const y=document.getElementById(`${f}PageSize`),v=Math.max(1,Number(y?.value||m.omsPageSize));m.omsPager[f]={page:1,pageSize:v,total:0,totalPages:1},As(f)}Mt()}function zt(){return String(m.adminOmsView||"open_orders")}function ie(t,e){const o=document.getElementById("postTradingMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"post_trading"})}}function qs(){const t=String(document.getElementById("postTradingAccountIds")?.value||"").trim();if(t)return t;const e=Pe();return e.length>0?e.join(","):""}function Us(t=!1){const e=m.omsPager.postTrading,o=t?1:Math.max(1,Number(e?.page||1)),s=Math.max(1,Number(e?.pageSize||m.omsPageSize)),i=String(document.getElementById("postTradingStartDate")?.value||"").trim(),r=String(document.getElementById("postTradingEndDate")?.value||"").trim(),n=document.getElementById("postTradingReconciled"),c=n?[...n.selectedOptions].map($=>String($.value||"").trim().toLowerCase()).filter($=>!!$):["true","false"],u=String(document.getElementById("postTradingOrderStatuses")?.value||"").trim(),g=new Set(c),f=g.has("true"),y=g.has("false"),v=f&&!y?!0:y&&!f?!1:void 0,I=u?u.split(",").map($=>String($||"").trim()).filter($=>!!$):[];return{account_ids:qs(),start_date:i||null,end_date:r||null,...v===void 0?{}:{reconciled:v},reconciled_values:c,order_statuses:I,kinds:["order"],preview:!0,page:o,page_size:s}}async function it(t=!1){const e=C(),o=Us(t),s=await A("/oms/reassign",{method:"POST",body:o},e);let i=Array.isArray(s.items)?s.items:[];const r=new Set((o.reconciled_values||[]).map(c=>String(c||"").toLowerCase()));r.size>0&&r.size<2&&(i=i.filter(c=>{const u=c?.reconciled;if(u==null)return!1;const g=u?"true":"false";return r.has(g)}));const n=i.map(c=>{const u=Number(c?.strategy_id||0);return{...c,target_strategy_id:u>0?u:null}});m.tables.postTrading.setData(n),m.postTradingLastPreview=s,Bt("postTrading",Number((s.deals_total||0)+(s.orders_total||0)),Number(s.page||o.page),Number(s.page_size||o.page_size)),ie("info",a("post_trading.preview_result","Preview: deals={deals} orders={orders}").replace("{deals}",String(s.deals_total||0)).replace("{orders}",String(s.orders_total||0)))}async function La(){const t=C(),e=String(document.getElementById("postTradingReconcileScope")?.value||"short").trim().toLowerCase(),o=String(document.getElementById("postTradingStartDate")?.value||"").trim(),s=String(document.getElementById("postTradingEndDate")?.value||"").trim(),i={account_ids:qs(),scope:e};if(e==="period"){if(!o||!s)throw new Error("period_requires_date_range");i.start_date=o,i.end_date=s}const r=await A("/oms/reconcile",{method:"POST",body:i},t);ie("success",a("post_trading.reconcile_ok","Reconciliação disparada: {count} conta(s).").replace("{count}",String(r?.triggered_count||0))),p("post_trading_reconcile",r)}async function Ea(){const t=m.tables.postTrading;if(!t)return;const e=t.getSelectedData?t.getSelectedData():[];if(!Array.isArray(e)||e.length===0)throw new Error("post_trading_select_rows");const o=C(),s=Us(!1),i=new Map;for(const c of e){const u=Number(c?.id||0),g=Number(c?.target_strategy_id||0);if(!Number.isFinite(u)||u<=0)continue;if(!Number.isFinite(g)||g<=0)throw new Error("post_trading_target_strategy_required");const f=String(g);i.has(f)||i.set(f,{targetStrategyId:g,orderIds:[]}),i.get(f).orderIds.push(u)}if(i.size===0)throw new Error("post_trading_select_rows");let r=0,n=0;for(const c of i.values()){const u=await A("/oms/reassign",{method:"POST",body:{...s,preview:!1,target_strategy_id:Number(c.targetStrategyId),order_ids:[...new Set(c.orderIds)]}},o);r+=Number(u?.deals_updated||0),n+=Number(u?.orders_updated||0)}ie("success",a("post_trading.apply_result","Applied: deals_updated={deals} orders_updated={orders}").replace("{deals}",String(r)).replace("{orders}",String(n))),p("post_trading_apply",{deals_updated:r,orders_updated:n,groups:i.size}),await it(!1)}function Ks(t){return t==="open_orders"||t==="history_orders"?"orders":t==="open_positions"||t==="history_positions"?"positions":"deals"}function Ia(){const t=String(document.getElementById("adminOmsStartDate")?.value||"").trim(),e=String(document.getElementById("adminOmsEndDate")?.value||"").trim();if(t&&!e||!t&&e)throw new Error("start_date and end_date must be together");return{start:t,end:e}}function Pa(){const t=String(document.getElementById("adminOmsAccountIds")?.value||"").trim();if(t)return t;const e=Pe();return e.length>0?e.join(","):""}function Hs(){return!!document.getElementById("adminOmsUnsafeToggle")?.checked}function js(t){return new Promise(e=>{const o=document.getElementById("adminOmsConfirmDialog"),s=document.getElementById("adminOmsConfirmText"),i=document.getElementById("adminOmsConfirmOkBtn"),r=document.getElementById("adminOmsConfirmCancelBtn");if(!o||!i||!r){e(!1);return}s&&(s.textContent=String(t||"Confirm?"));const n=()=>{i.removeEventListener("click",c),r.removeEventListener("click",u),o.open=!1},c=()=>{n(),e(!0)},u=()=>{n(),e(!1)};i.addEventListener("click",c),r.addEventListener("click",u),o.open=!0})}function Vs(t){const e={};for(const[o,s]of Object.entries(t||{}))o.startsWith("_")||s!==void 0&&(e[o]=s);return e}function Ws(){const t=new Date,e=t.getUTCFullYear(),o=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0"),i=String(t.getUTCHours()).padStart(2,"0"),r=String(t.getUTCMinutes()).padStart(2,"0"),n=String(t.getUTCSeconds()).padStart(2,"0");return`${e}-${o}-${s} ${i}:${r}:${n}`}function $a(t){const e={...t||{}},o=Ws(),s=i=>{const r=e[i],n=String(r??"").trim().toLowerCase();(r==null||n===""||n==="null")&&(e[i]=o)};for(const i of["created_at","updated_at","opened_at","executed_at"])s(i);return e}function Gs(t){const o=(Array.isArray(t?.results)?t.results:[]).filter(r=>r&&r.ok===!1);if(o.length===0)return;const s=o[0]||{},i=String(s.error||"unknown_error");throw new Error(i)}function Js(t){const o=(Array.isArray(t?.results)?t.results:[]).filter(s=>s&&s.ok===!0&&Number(s.id||0)>0).map(s=>Number(s.id)).filter((s,i,r)=>r.indexOf(s)===i);return o.length===0?"":` IDs: ${o.join(", ")}`}async function ge(t=!1){const e=C(),o=zt(),s=m.omsPager.adminOms,i=t?1:Math.max(1,Number(s?.page||1)),r=Math.max(1,Number(s?.pageSize||m.omsPageSize)),{start:n,end:c}=Ia(),u=Pa(),g=new URLSearchParams({account_ids:u,page:String(i),page_size:String(r)});n&&c&&(g.set("start_date",n),g.set("end_date",c));const f=await A(`/admin/oms/${encodeURIComponent(o)}?${g.toString()}`,{},e),y=m.tables.adminOms;if(y){const v=Ps(o);W(y,v),y.setData(Array.isArray(f.items)?f.items:[])}Bt("adminOms",Number(f.total||0),Number(f.page||i),Number(f.page_size||r))}function Oa(){const t=zt(),e=m.tables.adminOms;if(!e)return;const o=Number(Pe()[0]||m.availableAccountIds[0]||0),s={account_id:o>0?o:"",created_at:Ws()};t.includes("orders")?Object.assign(s,{symbol:"BTC/USDT",side:"buy",order_type:"market",status:"SUBMITTED",qty:"0",strategy_id:0,position_id:0,reason:"admin",filled_qty:"0"}):t.includes("positions")?Object.assign(s,{symbol:"BTC/USDT",side:"buy",qty:"0",avg_price:"0",strategy_id:0,state:"open",reason:"admin"}):Object.assign(s,{order_id:null,position_id:0,symbol:"BTC/USDT",side:"buy",qty:"0",price:"0",strategy_id:0,reason:"admin",reconciled:!0});const i=e.addData([s],!0);if(i&&typeof i.then=="function"){i.then(r=>{Array.isArray(r)&&r[0]&&typeof r[0].select=="function"&&r[0].select()}).catch(()=>{});return}Array.isArray(i)&&i[0]&&typeof i[0].select=="function"&&i[0].select()}async function Ta(){const t=C(),e=m.tables.adminOms;if(!e)return;const o=e.getSelectedData?e.getSelectedData():[];if(!Array.isArray(o)||o.length===0)throw new Error("admin_oms_select_rows");if(!Hs())throw new Error("admin_oms_unlock_required");if(!await js(a("admin.oms_confirm_save",`Save ${o.length} row(s) to database?`).replace("{count}",String(o.length))))return;const i=zt(),r=Ks(i),n=o.map(u=>{let g=Vs(u);const f=Number(g.id||0);return f<=0&&(g=$a(g)),{op:f>0?"update":"insert",row:g}}),c=await A(`/admin/oms/${r}/mutate`,{method:"POST",body:n},t);Gs(c),p("admin_oms_save_selected",c),T("info","Admin OMS save selected",{entity:r,count:n.length}),Y("success",a("admin.oms_save_success",`Saved successfully (${n.length} row(s)).`).replace("{count}",String(n.length))+Js(c)),await ge(!1)}async function Da(){const t=C(),e=m.tables.adminOms;if(!e)return;const o=e.getSelectedData?e.getSelectedData():[];if(!Array.isArray(o)||o.length===0)throw new Error("admin_oms_select_rows");if(!Hs())throw new Error("admin_oms_unlock_required");const s=zt(),i=Ks(s),r=o.map(u=>Vs(u)).filter(u=>Number(u.id||0)>0).map(u=>({op:"delete",row:{id:Number(u.id),account_id:Number(u.account_id||0)||null}}));if(r.length===0)throw new Error("only rows with id can be deleted");if(!await js(a("admin.oms_confirm_delete",`DELETE ${r.length} row(s) from database?`).replace("{count}",String(r.length))))return;const c=await A(`/admin/oms/${i}/mutate`,{method:"POST",body:r},t);Gs(c),p("admin_oms_delete_selected",c),T("warn","Admin OMS delete selected",{entity:i,count:r.length}),Y("success",a("admin.oms_delete_success",`Deleted successfully (${r.length} row(s)).`).replace("{count}",String(r.length))+Js(c)),await ge(!1)}Sa();xa();Ca();ks().catch(()=>{});{const t=String(localStorage.getItem(M.activeMenu)||"login").trim();R(t)}Ae("ready",!1);ke().catch(t=>{p("accounts_error",{error:String(t)})});
