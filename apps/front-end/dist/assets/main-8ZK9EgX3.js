const Ws=JSON.parse(`{"app.title":"Simple Front","status.disconnected":"desconectado","status.ready":"listo","status.ws_error":"error de ws","status.connected":"conectado {ws} ws | viendo {accounts} cuenta(s)","tabs.login":"Login","tabs.trade":"Trade","tabs.risk":"Risk","tabs.admin":"Admin","menu.login_config":"Login / Configuración","menu.strategies":"Estrategias","menu.oms":"OMS","menu.ccxt_commands":"Comandos CCXT","menu.post_trading":"Post Trading","menu.system_monitor":"Consola del Sistema","menu.risk":"Riesgo","menu.admin":"Administración","menu.admin_oms_crud":"OMS CRUD","menu.api_keys":"API Keys","density.compact":"Compacto","density.normal":"Normal","density.spacious":"Espaciado","login.title":"Login","login.base_url":"URL Base","login.language":"Idioma","login.mode":"Modo","login.mode_api_key":"API Key","login.mode_user_password":"Usuario + Contraseña","login.api_key":"API Key","login.show":"mostrar","login.hide":"ocultar","login.user_name":"Usuario","login.password":"Contraseña","login.api_key_id_optional":"API Key ID (opcional)","login.authenticate":"Autenticar","trade.connection":"Conexión","trade.filter_accounts":"Filtrar Cuentas","trade.view_accounts":"Cuentas a ver","common.select_all":"Seleccionar todas","common.clear":"Limpiar","common.refresh":"Actualizar","common.previous":"Anterior","common.next":"Siguiente","common.page":"Página","common.page_size":"Items/Pág.","common.items_per_page":"Items/Página","common.start_date":"Fecha inicio","common.end_date":"Fecha fin","common.filter":"Filtrar","common.copy":"Copiar","common.export_csv":"Exportar CSV","common.export_excel":"Exportar Excel","common.export_json":"Exportar JSON","common.export_html":"Exportar HTML","common.send":"Enviar","common.change":"Cambiar","common.apply":"Aplicar","common.cancel":"Cancelar","common.close":"Cerrar","common.account_id":"ID de Cuenta","common.account_id_placeholder":"ej: 1","common.create":"Crear","common.load":"Cargar","common.save":"Guardar","common.enable":"Activar","common.disable":"Desactivar","common.optional":"opcional","common.value_or_null":"valor o null","trade.connect_ws":"Conectar WS","trade.disconnect_ws":"Desconectar","trade.refresh_tables":"Actualizar tablas","trade.load_accounts":"Recargar cuentas","trade.commands":"Comandos","cmd.send_order":"Enviar orden","cmd.cancel_order":"Cancelar orden","cmd.change_order":"Modificar orden","cmd.position_change":"Cambiar posición","cmd.position_close":"Cerrar posición","cmd.position_close_by":"Cerrar posición por close by","cmd.merge_positions":"Fusionar posiciones","cmd.load_symbols":"Cargar símbolos","cmd.cancel_ids":"Cancelar IDs","cmd.cancel_all_open":"Cancelar todas abiertas","cmd.run_ccxt":"Ejecutar CCXT","cmd.direct_ccxt":"Llamada CCXT directa","cmd.field.strategy":"Estrategia","cmd.field.symbol":"Símbolo","cmd.field.side":"Lado","cmd.field.type":"Tipo","cmd.field.qty":"Cantidad","cmd.field.price":"Precio","cmd.field.stop_loss":"OMS Stop Loss","cmd.field.stop_gain":"OMS Stop Gain","cmd.field.comment":"Comentario","cmd.field.params_json":"Parámetros adicionales JSON (CCXT)","cmd.field.reduce_only":"reduce_only","cmd.field.post_only":"post_only","cmd.field.time_in_force":"Time in Force","cmd.field.trigger_price":"Trigger Price","cmd.field.stop_price":"Stop Price","cmd.field.take_profit_price":"Take Profit Price","cmd.field.trailing_amount":"Trailing Amount","cmd.field.trailing_percent":"Trailing Percent","cmd.field.order_ids_csv":"Order IDs (1 o CSV)","cmd.field.account_id_cancel_all":"Account ID (Cancel All)","cmd.field.strategy_ids_csv_cancel_all":"Strategy IDs CSV (Cancel All, opcional)","cmd.field.order_id":"Order ID","cmd.field.new_qty":"New Qty","cmd.field.new_price":"New Price","cmd.field.position_id":"Position ID","cmd.field.position_id_a":"ID de Posición A","cmd.field.position_id_b":"ID de Posición B","cmd.field.close_by_qty":"Cantidad de Close By","cmd.field.source_position_id":"ID de Posición Origen","cmd.field.target_position_id":"ID de Posición Destino","cmd.field.stop_mode":"Modo de Stop","cmd.field.mode":"Modo","cmd.field.func":"Función","cmd.field.args_json":"Args JSON","cmd.field.kwargs_json":"Kwargs JSON","cmd.field.core_func":"Core Func","cmd.field.body_json":"Body JSON","cmd.field.result_json":"Result JSON","cmd.field.new_strategy_name":"nuevo nombre (opcional)","cmd.placeholder.required_for_limit":"obligatorio para limit","trade.strategies":"Estrategias","trade.create_strategy":"Agregar estrategia","trade.my_strategies":"Mis estrategias","trade.load_strategies":"Cargar estrategias","trade.name":"Nombre","trade.client_strategy_id":"ID de Estrategia del Cliente","trade.accounts":"Cuentas","trade.col_strategy_id":"Estrategia ID","trade.col_name":"Nombre","trade.col_client_strategy_id":"ID Estrategia Cliente","trade.col_status":"Estado","trade.col_account_ids":"Cuentas","trade.col_save":"Guardar","trade.col_toggle":"Alternar","admin.create_strategy":"Crear estrategia","risk.save_permission":"Guardar permiso","admin.title":"Admin","admin.create_account":"Crear cuenta","admin.create_user_key":"Crear usuario + API Key","admin.load_accounts":"Cargar cuentas","admin.load_users":"Cargar usuarios","admin.load_users_keys":"Cargar usuarios+claves","admin.accounts":"Cuentas","admin.users":"Usuarios","admin.users_keys":"Usuarios / API Keys","admin.oms_load_error":"Error al cargar Admin OMS","admin.oms_save_error":"Error al guardar","admin.oms_delete_error":"Error al eliminar","admin.oms_unlock_before_save":"Active 'Desbloquear modo peligroso' antes de guardar.","admin.oms_unlock_before_delete":"Active 'Desbloquear modo peligroso' antes de eliminar.","admin.oms_select_rows":"Seleccione una o más filas con el checkbox de la izquierda.","admin.oms_unlock_label":"Desbloquear modo peligroso","admin.oms_save_success":"Guardado con éxito ({count} fila(s)).","admin.oms_delete_success":"Eliminado con éxito ({count} fila(s)).","admin.oms_confirm_save":"Guardar {count} fila(s) en la base?","admin.oms_confirm_delete":"ELIMINAR {count} fila(s) de la base?","admin.api_key_created":"API Key creada. user_id={user_id} api_key_id={api_key_id} key={key}","admin.api_key_create_error":"Error al crear API Key","risk.title":"Risk","risk.account_controls":"Controles de riesgo por cuenta","risk.strategy_controls":"Controles de riesgo por estrategia","risk.api_permissions":"Permisos de API Key","risk.permission_rows":"Filas de permisos por API Key","risk.load_permissions":"Cargar permisos","risk.allow_new_positions":"Permitir nuevas posiciones","risk.block_new_positions":"Bloquear nuevas posiciones","risk.set_active":"Definir activa","risk.block_account":"Bloquear cuenta","risk.allow_strategy_opens":"Permitir apertura por estrategia","risk.block_strategy_opens":"Bloquear apertura por estrategia","positions.title":"Monitor de posiciones","positions.open_positions":"Posiciones abiertas","positions.open_orders":"Órdenes abiertas","positions.deals":"Deals","positions.history_positions":"Histórico de posiciones","positions.history_orders":"Histórico de Órdenes","positions.symbol_list":"Lista de símbolos","oms.close_selected_positions":"Cerrar seleccionadas","oms.cancel_selected_orders":"Cancelar seleccionadas","oms.select_open_positions_first":"Seleccione una o más posiciones abiertas primero.","oms.select_open_orders_first":"Seleccione una o más órdenes abiertas primero.","oms.bulk_close_positions_ok":"Cerrar posiciones seleccionadas: ok","oms.bulk_close_positions_partial":"Cerrar posiciones seleccionadas finalizado con errores","oms.bulk_close_positions_failed":"Error al cerrar posiciones seleccionadas","oms.bulk_cancel_orders_ok":"Cancelar órdenes seleccionadas: ok","oms.bulk_cancel_orders_partial":"Cancelar órdenes seleccionadas finalizado con errores","oms.bulk_cancel_orders_failed":"Error al cancelar órdenes seleccionadas","oms.col_id":"ID","oms.col_account_id":"Cuenta","oms.col_symbol":"Símbolo","oms.col_side":"Lado","oms.col_qty":"Cant","oms.col_status":"Estado","oms.col_price":"Precio","oms.col_updated_at":"Actualizado En","oms.col_avg_price":"Precio Medio","oms.col_stop_loss":"Stop Loss","oms.col_stop_gain":"Stop Gain","oms.col_state":"Estado","oms.col_comment":"Comentario","oms.col_opened_at":"Abierto En","oms.col_actions":"Acciones","oms.col_order_type":"Tipo Orden","oms.col_filled_qty":"Cant Llenada","oms.col_exchange_order_id":"ID Orden Exchange","oms.col_order_id":"ID Orden","oms.col_position_id":"ID Posición","oms.col_exchange_trade_id":"ID Trade Exchange","oms.col_executed_at":"Ejecutado En","oms.col_strategy_id":"ID Estrategia","oms.col_reason":"Motivo","oms.col_closed_at":"Cerrado En","oms.col_created_at":"Creado En","oms.col_client_order_id":"ID Orden Cliente","oms.col_avg_fill_price":"Precio Medio Ejec.","oms.col_command_id":"ID Comando","oms.col_fee":"Tarifa","oms.col_fee_currency":"Moneda Tarifa","oms.col_pnl":"PnL","oms.col_reconciled":"Reconciliado","oms.col_market_id":"ID de Mercado","oms.col_base":"Base","oms.col_quote":"Cotización","oms.col_market_type":"Tipo","oms.col_market_active":"Activo","oms.col_price_decimals":"Decimales Precio","oms.col_qty_decimals":"Decimales Cantidad","oms.col_price_min":"Precio Mínimo","oms.col_price_max":"Precio Máximo","oms.col_qty_min":"Cantidad Mínima","oms.col_qty_max":"Cantidad Máxima","oms.col_cost_min":"Costo Mínimo","oms.col_cost_max":"Costo Máximo","oms.col_tick_size":"Tick Size","oms.col_step_size":"Step Size","system.ccxt_orders":"Órdenes CCXT","system.ccxt_trades":"Trades CCXT","system.ws_events":"Eventos WS","system.ui_logs":"Logs de UI","system.ui_logs_clear_view":"Limpiar vista","system.ui_logs_clear_db":"Borrar base local","system.col_seq":"Seq","system.col_at":"En","system.col_kind":"Tipo","system.col_payload":"Payload","system.col_level":"Nivel","system.col_message":"Mensaje","system.col_exchange_id":"Exchange","system.col_observed_at":"Observado En","system.col_raw":"Raw","post_trading.title":"Post Trading","post_trading.account_ids":"IDs de Cuenta CSV","post_trading.reconciled":"Reconciliado","post_trading.kinds":"Tipos","post_trading.order_statuses":"Estados de Orden CSV","post_trading.target_strategy_id":"ID Estrategia Objetivo","post_trading.target_position_id":"ID Posición Objetivo","post_trading.preview":"Preview","post_trading.apply":"Aplicar Reassign","post_trading.col_kind":"Tipo","post_trading.preview_result":"Preview: deals={deals} orders={orders}","post_trading.apply_result":"Aplicado: deals_updated={deals} orders_updated={orders}","post_trading.select_rows":"Seleccione una o más filas para aplicar el reassign.","post_trading.preview_error":"Error en preview","post_trading.apply_error":"Error al aplicar reassign","closeby.title":"Close By","closeby.source_position_id":"Posición de Origen ID","closeby.target_open_position":"Posición Abierta de Destino","closeby.source_prefix":"Origen","closeby.account":"cuenta","menu.user":"Usuario","user.profile":"Mi Perfil","user.tab_profile":"Perfil","user.tab_api_keys":"API Keys","user.user_id":"ID de Usuario","user.user_name":"Nombre de Usuario","user.role":"Rol","user.status":"Estado","user.current_api_key_id":"API Key Actual","user.save_profile":"Guardar Perfil","user.change_password":"Cambiar Contraseña","user.current_password":"Contraseña Actual","user.new_password":"Nueva Contraseña","user.save_password":"Guardar Contraseña","user.api_keys":"Mis API Keys","user.api_key_permissions":"Permisos por API Key","user.new_api_key_optional":"Nueva API Key (opcional)","user.create_api_key":"Crear API Key","user.load_api_keys":"Recargar API Keys","user.profile_updated":"Perfil actualizado con éxito.","user.profile_update_error":"Error al actualizar perfil","user.password_updated":"Contraseña actualizada con éxito.","user.password_update_error":"Error al actualizar contraseña","user.api_key_created":"API Key creada. id={api_key_id} key={key}","user.api_key_created_success":"API Key creada con éxito.","user.api_key_create_error":"Error al crear API Key","user.api_key_status_updated":"Estado de API Key actualizado.","user.api_key_status_update_error":"Error al actualizar estado de API Key","user.reloaded":"Datos de usuario recargados.","user.load_error":"Error al cargar datos de usuario","menu.post_trading_external_orders":"Órdenes Externas","post_trading.external_orders":"Órdenes Externas","post_trading.reconcile_scope":"Alcance de Reconciliación","post_trading.scope_short":"Corto","post_trading.scope_hourly":"Horario","post_trading.scope_long":"Largo","post_trading.scope_period":"Período","post_trading.reconcile":"Reconciliar","post_trading.reconcile_ok":"Reconciliación disparada: {count} cuenta(s).","post_trading.reconcile_error":"Error al reconciliar","post_trading.target_strategy_required":"Complete el ID de estrategia destino (> 0) en las filas seleccionadas.","admin.system_status":"Estado del Sistema","admin.refresh_status":"Actualizar estado","admin.clear_oms_cache":"Limpiar cache OMS","admin.clear_oms_cache_ok":"Cache OMS limpiado ({scope}, antes={count}).","admin.clear_oms_cache_error":"Error al limpiar cache OMS","admin.api_status":"API","admin.dispatcher_status":"Dispatcher","admin.status_error":"Error al consultar estado","post_trading.period_requires_date_range":"Para alcance Período, complete Fecha Inicio y Fecha Fin.","admin.api_key_permissions":"Permisos por API Key","admin.col_user_status":"Estado del Usuario","admin.col_api_key_id":"ID de API Key","admin.col_api_key_status":"Estado de API Key","risk.can_read":"Leer","risk.can_trade":"Operar","risk.can_close_position":"Cerrar Posicion","risk.can_risk_manage":"Gestionar Riesgo","risk.can_block_new_positions":"Bloquear Nuevas Posiciones","risk.can_block_account":"Bloquear Cuenta","risk.restrict_to_strategies":"Restringir a Estrategias","risk.strategy_ids":"IDs de Estrategia"}`),je={"pt-BR":JSON.parse(`{"app.title":"Simple Front","status.disconnected":"desconectado","status.ready":"pronto","status.ws_error":"erro de ws","status.connected":"conectado {ws} ws | visualizando {accounts} conta(s)","tabs.login":"Login","tabs.trade":"Trade","tabs.risk":"Risk","tabs.admin":"Admin","menu.login_config":"Login / Configuração","menu.strategies":"Estratégias","menu.oms":"OMS","menu.ccxt_commands":"Comandos CCXT","menu.post_trading":"Pós Trading","menu.system_monitor":"Console do Sistema","menu.risk":"Risco","menu.admin":"Administração","menu.admin_oms_crud":"OMS CRUD","menu.api_keys":"API Keys","menu.user":"Usuário","density.compact":"Compacto","density.normal":"Normal","density.spacious":"Espaçado","login.title":"Login","login.base_url":"Base URL","login.language":"Idioma","login.mode":"Modo","login.mode_api_key":"API Key","login.mode_user_password":"Usuário + Senha","login.api_key":"API Key","login.show":"mostrar","login.hide":"ocultar","login.user_name":"Usuário","login.password":"Senha","login.api_key_id_optional":"API Key ID (opcional)","login.authenticate":"Autenticar","user.profile":"Meu Perfil","user.tab_profile":"Perfil","user.tab_api_keys":"API Keys","user.user_id":"ID do Usuário","user.user_name":"Nome do Usuário","user.role":"Perfil","user.status":"Status","user.current_api_key_id":"API Key Atual","user.save_profile":"Salvar Perfil","user.change_password":"Alterar Senha","user.current_password":"Senha Atual","user.new_password":"Nova Senha","user.save_password":"Salvar Senha","user.api_keys":"Minhas API Keys","user.api_key_permissions":"Permissões por API Key","user.new_api_key_optional":"Nova API Key (opcional)","user.create_api_key":"Criar API Key","user.load_api_keys":"Recarregar API Keys","user.profile_updated":"Perfil atualizado com sucesso.","user.profile_update_error":"Erro ao atualizar perfil","user.password_updated":"Senha atualizada com sucesso.","user.password_update_error":"Erro ao atualizar senha","user.api_key_created":"API Key criada. id={api_key_id} key={key}","user.api_key_created_success":"API Key criada com sucesso.","user.api_key_create_error":"Erro ao criar API Key","user.api_key_status_updated":"Status da API Key atualizado.","user.api_key_status_update_error":"Erro ao atualizar status da API Key","user.reloaded":"Dados do usuário recarregados.","user.load_error":"Erro ao carregar dados do usuário","trade.connection":"Conexão","trade.filter_accounts":"Filtrar Contas","trade.view_accounts":"Contas para visualizar","common.select_all":"Selecionar todas","common.clear":"Limpar","common.refresh":"Atualizar","common.previous":"Anterior","common.next":"Próxima","common.page":"Página","common.page_size":"Itens/Pág.","common.items_per_page":"Itens/Página","common.start_date":"Data início","common.end_date":"Data fim","common.filter":"Filtrar","common.copy":"Copiar","common.export_csv":"Exportar CSV","common.export_excel":"Exportar Excel","common.export_json":"Exportar JSON","common.export_html":"Exportar HTML","common.send":"Enviar","common.change":"Alterar","common.apply":"Aplicar","common.cancel":"Cancelar","common.close":"Fechar","common.account_id":"ID da Conta","common.account_id_placeholder":"ex: 1","common.create":"Criar","common.load":"Carregar","common.save":"Salvar","common.enable":"Ativar","common.disable":"Desativar","common.optional":"opcional","common.value_or_null":"valor ou null","trade.connect_ws":"Conectar WS","trade.disconnect_ws":"Desconectar","trade.refresh_tables":"Atualizar tabelas","trade.load_accounts":"Recarregar contas","trade.commands":"Comandos","cmd.send_order":"Enviar ordem","cmd.cancel_order":"Cancelar ordem","cmd.change_order":"Alterar ordem","cmd.position_change":"Alterar posição","cmd.position_close":"Fechar posição","cmd.position_close_by":"Fechar posição com posição","cmd.merge_positions":"Mesclar posições","cmd.load_symbols":"Carregar símbolos","cmd.cancel_ids":"Cancelar IDs","cmd.cancel_all_open":"Cancelar todas abertas","cmd.run_ccxt":"Executar CCXT","cmd.direct_ccxt":"Chamada CCXT direta","cmd.field.strategy":"Estratégia","cmd.field.symbol":"Símbolo","cmd.field.side":"Lado","cmd.field.type":"Tipo","cmd.field.qty":"Quantidade","cmd.field.price":"Preço","cmd.field.stop_loss":"OMS Stop Loss","cmd.field.stop_gain":"OMS Stop Gain","cmd.field.comment":"Comentário","cmd.field.params_json":"Parâmetros adicionais JSON (CCXT)","cmd.field.reduce_only":"reduce_only","cmd.field.post_only":"post_only","cmd.field.time_in_force":"Tempo em Força (TIF)","cmd.field.trigger_price":"Preço de Disparo","cmd.field.stop_price":"Preço de Stop","cmd.field.take_profit_price":"Preço de Take Profit","cmd.field.trailing_amount":"Valor do Trailing","cmd.field.trailing_percent":"Percentual do Trailing","cmd.field.order_ids_csv":"IDs de Ordem (1 ou CSV)","cmd.field.account_id_cancel_all":"ID da Conta (Cancelar Todas)","cmd.field.strategy_ids_csv_cancel_all":"IDs de Estratégia CSV (Cancelar Todas, opcional)","cmd.field.order_id":"ID da Ordem","cmd.field.new_qty":"Nova Quantidade","cmd.field.new_price":"Novo Preço","cmd.field.position_id":"ID da Posição","cmd.field.position_id_a":"ID da Posição A","cmd.field.position_id_b":"ID da Posição B","cmd.field.close_by_qty":"Quantidade do Close By","cmd.field.source_position_id":"ID da Posição de Origem","cmd.field.target_position_id":"ID da Posição de Destino","cmd.field.stop_mode":"Modo de Stop","cmd.field.mode":"Modo","cmd.field.func":"Função","cmd.field.args_json":"Args JSON","cmd.field.kwargs_json":"Kwargs JSON","cmd.field.core_func":"Função Core","cmd.field.body_json":"Body JSON","cmd.field.result_json":"JSON de Resultado","cmd.field.new_strategy_name":"Novo nome (opcional)","cmd.placeholder.required_for_limit":"obrigatório para limit","trade.strategies":"Estratégias","trade.create_strategy":"Adicionar estratégia","trade.my_strategies":"Minhas estratégias","trade.load_strategies":"Carregar estratégias","trade.name":"Nome","trade.client_strategy_id":"ID da Estratégia do Cliente","trade.accounts":"Contas","trade.col_strategy_id":"Estratégia ID","trade.col_name":"Nome","trade.col_client_strategy_id":"ID Estratégia Cliente","trade.col_status":"Status","trade.col_account_ids":"Contas","trade.col_save":"Salvar","trade.col_toggle":"Alternar","admin.create_strategy":"Criar estratégia","risk.save_permission":"Salvar permissão","admin.title":"Admin","admin.create_account":"Criar conta","admin.create_user_key":"Criar usuário + API Key","admin.load_accounts":"Carregar contas","admin.load_users":"Carregar usuários","admin.load_users_keys":"Carregar usuários+chaves","admin.accounts":"Contas","admin.users":"Usuários","admin.users_keys":"Usuários / API Keys","admin.oms_load_error":"Erro ao carregar Admin OMS","admin.oms_save_error":"Erro ao salvar","admin.oms_delete_error":"Erro ao deletar","admin.oms_unlock_before_save":"Ative 'Destravar modo perigoso' antes de salvar.","admin.oms_unlock_before_delete":"Ative 'Destravar modo perigoso' antes de deletar.","admin.oms_select_rows":"Selecione uma ou mais linhas no checkbox da esquerda.","admin.oms_unlock_label":"Destravar modo perigoso","admin.oms_save_success":"Salvo com sucesso ({count} linha(s)).","admin.oms_delete_success":"Removido com sucesso ({count} linha(s)).","admin.oms_confirm_save":"Salvar {count} linha(s) no banco?","admin.oms_confirm_delete":"DELETAR {count} linha(s) do banco?","admin.api_key_created":"API Key criada. user_id={user_id} api_key_id={api_key_id} key={key}","admin.api_key_create_error":"Erro ao criar API Key","risk.title":"Risk","risk.account_controls":"Controles de risco por conta","risk.strategy_controls":"Controles de risco por estratégia","risk.api_permissions":"Permissões de API Key","risk.permission_rows":"Linhas de permissão por API Key","risk.load_permissions":"Carregar permissões","risk.allow_new_positions":"Permitir novas posições","risk.block_new_positions":"Bloquear novas posições","risk.set_active":"Definir ativa","risk.block_account":"Bloquear conta","risk.allow_strategy_opens":"Permitir abertura por estratégia","risk.block_strategy_opens":"Bloquear abertura por estratégia","positions.title":"Monitor de posições","positions.open_positions":"Posições abertas","positions.open_orders":"Ordens abertas","positions.deals":"Negócios","positions.history_positions":"Histórico de posições","positions.history_orders":"Histórico de ordens","positions.symbol_list":"Lista de símbolos","oms.close_selected_positions":"Fechar selecionadas","oms.cancel_selected_orders":"Cancelar selecionadas","oms.select_open_positions_first":"Selecione uma ou mais posições abertas primeiro.","oms.select_open_orders_first":"Selecione uma ou mais ordens abertas primeiro.","oms.bulk_close_positions_ok":"Fechar posições selecionadas: ok","oms.bulk_close_positions_partial":"Fechar posições selecionadas finalizado com erros","oms.bulk_close_positions_failed":"Falha ao fechar posições selecionadas","oms.bulk_cancel_orders_ok":"Cancelar ordens selecionadas: ok","oms.bulk_cancel_orders_partial":"Cancelar ordens selecionadas finalizado com erros","oms.bulk_cancel_orders_failed":"Falha ao cancelar ordens selecionadas","oms.col_id":"ID","oms.col_account_id":"Conta","oms.col_symbol":"Símbolo","oms.col_side":"Lado","oms.col_qty":"Quantidade","oms.col_status":"Status","oms.col_price":"Preço","oms.col_updated_at":"Atualizado Em","oms.col_avg_price":"Preço Médio","oms.col_stop_loss":"Stop Loss","oms.col_stop_gain":"Stop Gain","oms.col_state":"Estado","oms.col_comment":"Comentário","oms.col_opened_at":"Aberto Em","oms.col_actions":"Ações","oms.col_order_type":"Tipo Ordem","oms.col_filled_qty":"Qtd Preenchida","oms.col_exchange_order_id":"ID Ordem Exchange","oms.col_order_id":"ID Ordem","oms.col_position_id":"ID Posição","oms.col_exchange_trade_id":"ID Trade Exchange","oms.col_executed_at":"Executado Em","oms.col_strategy_id":"ID Estratégia","oms.col_reason":"Motivo","oms.col_closed_at":"Fechado Em","oms.col_created_at":"Criado Em","oms.col_client_order_id":"ID Ordem Cliente","oms.col_avg_fill_price":"Preço Médio Exec.","oms.col_command_id":"ID Comando","oms.col_fee":"Taxa","oms.col_fee_currency":"Moeda Taxa","oms.col_pnl":"PnL","oms.col_reconciled":"Reconciliado","oms.col_market_id":"ID do Mercado","oms.col_base":"Base","oms.col_quote":"Cotação","oms.col_market_type":"Tipo","oms.col_market_active":"Ativo","oms.col_price_decimals":"Casas Preço","oms.col_qty_decimals":"Casas Quantidade","oms.col_price_min":"Preço Mínimo","oms.col_price_max":"Preço Máximo","oms.col_qty_min":"Quantidade Mínima","oms.col_qty_max":"Quantidade Máxima","oms.col_cost_min":"Custo Mínimo","oms.col_cost_max":"Custo Máximo","oms.col_tick_size":"Tick Size","oms.col_step_size":"Step Size","system.ccxt_orders":"Ordens CCXT","system.ccxt_trades":"Trades CCXT","system.ws_events":"Eventos WS","system.ui_logs":"Logs da UI","system.ui_logs_clear_view":"Limpar visualização","system.ui_logs_clear_db":"Apagar banco local","system.col_seq":"Seq","system.col_at":"Em","system.col_kind":"Tipo","system.col_payload":"Payload","system.col_level":"Nível","system.col_message":"Mensagem","system.col_exchange_id":"Exchange","system.col_observed_at":"Observado Em","system.col_raw":"Raw","post_trading.title":"Pós Trading","post_trading.account_ids":"IDs de Conta CSV","post_trading.reconciled":"Reconciliado","post_trading.kinds":"Tipos","post_trading.order_statuses":"Status de Ordens CSV","post_trading.target_strategy_id":"ID Estratégia Alvo","post_trading.target_position_id":"ID Posição Alvo","post_trading.preview":"Preview","post_trading.apply":"Aplicar Reassign","post_trading.col_kind":"Tipo","post_trading.preview_result":"Preview: deals={deals} orders={orders}","post_trading.apply_result":"Aplicado: deals_updated={deals} orders_updated={orders}","post_trading.select_rows":"Selecione uma ou mais linhas para aplicar o reassign.","post_trading.preview_error":"Erro no preview","post_trading.apply_error":"Erro ao aplicar reassign","closeby.title":"Close By","closeby.source_position_id":"Posição de Origem ID","closeby.target_open_position":"Posição Aberta de Destino","closeby.source_prefix":"Origem","closeby.account":"conta","menu.post_trading_external_orders":"Ordens Externas","post_trading.external_orders":"Ordens Externas","post_trading.reconcile_scope":"Escopo de Reconciliação","post_trading.scope_short":"Curto","post_trading.scope_hourly":"Horário","post_trading.scope_long":"Longo","post_trading.scope_period":"Período","post_trading.reconcile":"Reconciliar","post_trading.reconcile_ok":"Reconciliação disparada: {count} conta(s).","post_trading.reconcile_error":"Erro ao reconciliar","post_trading.target_strategy_required":"Preencha o ID da estratégia alvo (> 0) nas linhas selecionadas.","admin.system_status":"Estado do Sistema","admin.refresh_status":"Atualizar estado","admin.clear_oms_cache":"Limpar cache OMS","admin.clear_oms_cache_ok":"Cache OMS limpo ({scope}, antes={count}).","admin.clear_oms_cache_error":"Erro ao limpar cache OMS","admin.api_status":"API","admin.dispatcher_status":"Dispatcher","admin.status_error":"Erro ao consultar estado","post_trading.period_requires_date_range":"Para scope Período, preencha Data Início e Data Fim.","admin.api_key_permissions":"Permissoes por API Key","admin.col_user_status":"Status do Usuario","admin.col_api_key_id":"ID da API Key","admin.col_api_key_status":"Status da API Key","risk.can_read":"Ler","risk.can_trade":"Negociar","risk.can_close_position":"Fechar Posicao","risk.can_risk_manage":"Gerenciar Risco","risk.can_block_new_positions":"Bloquear Novas Posicoes","risk.can_block_account":"Bloquear Conta","risk.restrict_to_strategies":"Restringir as Estrategias","risk.strategy_ids":"IDs de Estrategia"}`),"en-US":JSON.parse(`{"app.title":"Simple Front","status.disconnected":"disconnected","status.ready":"ready","status.ws_error":"ws error","status.connected":"connected {ws} ws | viewing {accounts} account(s)","tabs.login":"Login","tabs.trade":"Trade","tabs.risk":"Risk","tabs.admin":"Admin","menu.login_config":"Login / Config","menu.strategies":"Strategies","menu.oms":"OMS","menu.ccxt_commands":"CCXT Commands","menu.post_trading":"Post Trading","menu.system_monitor":"System Console","menu.risk":"Risk","menu.admin":"Administrator","menu.admin_oms_crud":"OMS CRUD","menu.api_keys":"API Keys","density.compact":"Compact","density.normal":"Normal","density.spacious":"Spacious","login.title":"Login","login.base_url":"Base URL","login.language":"Language","login.mode":"Mode","login.mode_api_key":"API Key","login.mode_user_password":"User + Password","login.api_key":"API Key","login.show":"show","login.hide":"hide","login.user_name":"User Name","login.password":"Password","login.api_key_id_optional":"API Key ID (optional)","login.authenticate":"Authenticate","user.profile":"My Profile","user.tab_profile":"Profile","user.tab_api_keys":"API Keys","user.user_id":"User ID","user.user_name":"User Name","user.role":"Role","user.status":"Status","user.current_api_key_id":"Current API Key","user.save_profile":"Save Profile","user.change_password":"Change Password","user.current_password":"Current Password","user.new_password":"New Password","user.save_password":"Save Password","user.api_keys":"My API Keys","user.api_key_permissions":"Permissions by API Key","user.new_api_key_optional":"New API Key (optional)","user.create_api_key":"Create API Key","user.load_api_keys":"Reload API Keys","user.profile_updated":"Profile updated successfully.","user.profile_update_error":"Failed to update profile","user.password_updated":"Password updated successfully.","user.password_update_error":"Failed to update password","user.api_key_created":"API Key created. id={api_key_id} key={key}","user.api_key_created_success":"API Key created successfully.","user.api_key_create_error":"Failed to create API Key","user.api_key_status_updated":"API Key status updated.","user.api_key_status_update_error":"Failed to update API Key status","user.reloaded":"User data reloaded.","user.load_error":"Failed to load user data","trade.connection":"Connection","trade.filter_accounts":"Filter Accounts","trade.view_accounts":"View Accounts","common.select_all":"Select All","common.clear":"Clear","common.refresh":"Refresh","common.previous":"Previous","common.next":"Next","common.page":"Page","common.page_size":"Items/Page","common.items_per_page":"Items/Page","common.start_date":"Start Date","common.end_date":"End Date","common.filter":"Filter","common.copy":"Copy","common.export_csv":"Export CSV","common.export_excel":"Export Excel","common.export_json":"Export JSON","common.export_html":"Export HTML","common.send":"Send","common.change":"Change","common.apply":"Apply","common.cancel":"Cancel","common.close":"Close","common.account_id":"Account ID","common.account_id_placeholder":"e.g. 1","common.create":"Create","common.load":"Load","common.save":"Save","common.enable":"Enable","common.disable":"Disable","common.optional":"optional","common.value_or_null":"value or null","trade.connect_ws":"Connect WS","trade.disconnect_ws":"Disconnect","trade.refresh_tables":"Refresh Tables","trade.load_accounts":"Reload Accounts","trade.commands":"Commands","cmd.send_order":"Send Order","cmd.cancel_order":"Cancel Order","cmd.change_order":"Change Order","cmd.position_change":"Position Change","cmd.position_close":"Position Close","cmd.position_close_by":"Position Close By","cmd.merge_positions":"Merge Positions","cmd.load_symbols":"Load Symbols","cmd.cancel_ids":"Cancel IDs","cmd.cancel_all_open":"Cancel All Open","cmd.run_ccxt":"Run CCXT","cmd.direct_ccxt":"Direct CCXT Call","cmd.field.strategy":"Strategy","cmd.field.symbol":"Symbol","cmd.field.side":"Side","cmd.field.type":"Type","cmd.field.qty":"Qty","cmd.field.price":"Price","cmd.field.stop_loss":"OMS Stop Loss","cmd.field.stop_gain":"OMS Stop Gain","cmd.field.comment":"Comment","cmd.field.params_json":"Additional JSON Parameters (CCXT)","cmd.field.reduce_only":"reduce_only","cmd.field.post_only":"post_only","cmd.field.time_in_force":"Time in Force","cmd.field.trigger_price":"Trigger Price","cmd.field.stop_price":"Stop Price","cmd.field.take_profit_price":"Take Profit Price","cmd.field.trailing_amount":"Trailing Amount","cmd.field.trailing_percent":"Trailing Percent","cmd.field.order_ids_csv":"Order IDs (1 or CSV)","cmd.field.account_id_cancel_all":"Account ID (Cancel All)","cmd.field.strategy_ids_csv_cancel_all":"Strategy IDs CSV (Cancel All, optional)","cmd.field.order_id":"Order ID","cmd.field.new_qty":"New Qty","cmd.field.new_price":"New Price","cmd.field.position_id":"Position ID","cmd.field.position_id_a":"Position ID A","cmd.field.position_id_b":"Position ID B","cmd.field.close_by_qty":"Close By Qty","cmd.field.source_position_id":"Source Position ID","cmd.field.target_position_id":"Target Position ID","cmd.field.stop_mode":"Stop Mode","cmd.field.mode":"Mode","cmd.field.func":"Func","cmd.field.args_json":"Args JSON","cmd.field.kwargs_json":"Kwargs JSON","cmd.field.core_func":"Core Func","cmd.field.body_json":"Body JSON","cmd.field.result_json":"Result JSON","cmd.field.new_strategy_name":"new name (optional)","cmd.placeholder.required_for_limit":"required for limit","trade.strategies":"Strategies","trade.create_strategy":"Add Strategy","trade.my_strategies":"My Strategies","trade.load_strategies":"Load Strategies","trade.name":"Name","trade.client_strategy_id":"Client Strategy ID","trade.accounts":"Accounts","trade.col_strategy_id":"Strategy ID","trade.col_name":"Name","trade.col_client_strategy_id":"Client Strategy ID","trade.col_status":"Status","trade.col_account_ids":"Accounts","trade.col_save":"Save","trade.col_toggle":"Toggle","admin.create_strategy":"Create Strategy","risk.save_permission":"Save Permission","admin.title":"Admin","admin.create_account":"Create Account","admin.create_user_key":"Create User + API Key","admin.load_accounts":"Load Accounts","admin.load_users":"Load Users","admin.load_users_keys":"Load Users+Keys","admin.accounts":"Accounts","admin.users":"Users","admin.users_keys":"Users / API Keys","admin.oms_load_error":"Failed to load Admin OMS","admin.oms_save_error":"Save failed","admin.oms_delete_error":"Delete failed","admin.oms_unlock_before_save":"Enable 'Unlock dangerous mode' before saving.","admin.oms_unlock_before_delete":"Enable 'Unlock dangerous mode' before deleting.","admin.oms_select_rows":"Select one or more rows using the left checkbox.","admin.oms_unlock_label":"Unlock dangerous mode","admin.oms_save_success":"Saved successfully ({count} row(s)).","admin.oms_delete_success":"Deleted successfully ({count} row(s)).","admin.oms_confirm_save":"Save {count} row(s) to database?","admin.oms_confirm_delete":"DELETE {count} row(s) from database?","admin.api_key_created":"API Key created. user_id={user_id} api_key_id={api_key_id} key={key}","admin.api_key_create_error":"Failed to create API Key","risk.title":"Risk","risk.account_controls":"Account Risk Controls","risk.strategy_controls":"Strategy Risk Controls","risk.api_permissions":"API Key Permissions","risk.permission_rows":"API Key Permission Rows","risk.load_permissions":"Load Permissions","risk.allow_new_positions":"Allow New Positions","risk.block_new_positions":"Block New Positions","risk.set_active":"Set Active","risk.block_account":"Block Account","risk.allow_strategy_opens":"Allow Strategy Opens","risk.block_strategy_opens":"Block Strategy Opens","positions.title":"Position Monitor","positions.open_positions":"Open Positions","positions.open_orders":"Open Orders","positions.deals":"Deals","positions.history_positions":"History Positions","positions.history_orders":"History Orders","positions.symbol_list":"Symbol List","oms.close_selected_positions":"Close Selected","oms.cancel_selected_orders":"Cancel Selected","oms.select_open_positions_first":"Select one or more open positions first.","oms.select_open_orders_first":"Select one or more open orders first.","oms.bulk_close_positions_ok":"Close selected positions: ok","oms.bulk_close_positions_partial":"Close selected positions finished with errors","oms.bulk_close_positions_failed":"Close selected positions failed","oms.bulk_cancel_orders_ok":"Cancel selected orders: ok","oms.bulk_cancel_orders_partial":"Cancel selected orders finished with errors","oms.bulk_cancel_orders_failed":"Cancel selected orders failed","oms.col_id":"ID","oms.col_account_id":"Account","oms.col_symbol":"Symbol","oms.col_side":"Side","oms.col_qty":"Qty","oms.col_status":"Status","oms.col_price":"Price","oms.col_updated_at":"Updated At","oms.col_avg_price":"Avg Price","oms.col_stop_loss":"Stop Loss","oms.col_stop_gain":"Stop Gain","oms.col_state":"State","oms.col_comment":"Comment","oms.col_opened_at":"Opened At","oms.col_actions":"Actions","oms.col_order_type":"Order Type","oms.col_filled_qty":"Filled Qty","oms.col_exchange_order_id":"Exchange Order ID","oms.col_order_id":"Order ID","oms.col_position_id":"Position ID","oms.col_exchange_trade_id":"Exchange Trade ID","oms.col_executed_at":"Executed At","oms.col_strategy_id":"Strategy ID","oms.col_reason":"Reason","oms.col_closed_at":"Closed At","oms.col_created_at":"Created At","oms.col_client_order_id":"Client Order ID","oms.col_avg_fill_price":"Avg Fill Price","oms.col_command_id":"Command ID","oms.col_fee":"Fee","oms.col_fee_currency":"Fee Ccy","oms.col_pnl":"PnL","oms.col_reconciled":"Reconciled","oms.col_market_id":"Market ID","oms.col_base":"Base","oms.col_quote":"Quote","oms.col_market_type":"Type","oms.col_market_active":"Active","oms.col_price_decimals":"Price Decimals","oms.col_qty_decimals":"Qty Decimals","oms.col_price_min":"Min Price","oms.col_price_max":"Max Price","oms.col_qty_min":"Min Qty","oms.col_qty_max":"Max Qty","oms.col_cost_min":"Min Cost","oms.col_cost_max":"Max Cost","oms.col_tick_size":"Tick Size","oms.col_step_size":"Step Size","system.ccxt_orders":"CCXT Orders","system.ccxt_trades":"CCXT Trades","system.ws_events":"WS Events","system.ui_logs":"UI Logs","system.ui_logs_clear_view":"Clear View","system.ui_logs_clear_db":"Clear Local DB","system.col_seq":"Seq","system.col_at":"At","system.col_kind":"Kind","system.col_payload":"Payload","system.col_level":"Level","system.col_message":"Message","system.col_exchange_id":"Exchange","system.col_observed_at":"Observed At","system.col_raw":"Raw","post_trading.title":"Post Trading","post_trading.account_ids":"Account IDs CSV","post_trading.reconciled":"Reconciled","post_trading.kinds":"Kinds","post_trading.order_statuses":"Order Statuses CSV","post_trading.target_strategy_id":"Target Strategy ID","post_trading.target_position_id":"Target Position ID","post_trading.preview":"Preview","post_trading.apply":"Apply Reassign","post_trading.col_kind":"Kind","post_trading.preview_result":"Preview: deals={deals} orders={orders}","post_trading.apply_result":"Applied: deals_updated={deals} orders_updated={orders}","post_trading.select_rows":"Select one or more rows to apply reassign.","post_trading.preview_error":"Preview failed","post_trading.apply_error":"Apply reassign failed","closeby.title":"Close By","closeby.source_position_id":"Source Position ID","closeby.target_open_position":"Target Open Position","closeby.source_prefix":"Source","closeby.account":"account","menu.user":"User","menu.post_trading_external_orders":"External Orders","post_trading.external_orders":"External Orders","post_trading.reconcile_scope":"Reconcile Scope","post_trading.scope_short":"Short","post_trading.scope_hourly":"Hourly","post_trading.scope_long":"Long","post_trading.scope_period":"Period","post_trading.reconcile":"Reconcile","post_trading.reconcile_ok":"Reconcile triggered: {count} account(s).","post_trading.reconcile_error":"Reconcile failed","post_trading.target_strategy_required":"Fill target strategy ID (> 0) on selected rows.","admin.system_status":"System Status","admin.refresh_status":"Refresh status","admin.clear_oms_cache":"Clear OMS cache","admin.clear_oms_cache_ok":"OMS cache cleared ({scope}, before={count}).","admin.clear_oms_cache_error":"Failed to clear OMS cache","admin.api_status":"API","admin.dispatcher_status":"Dispatcher","admin.status_error":"Failed to query status","post_trading.period_requires_date_range":"For Period scope, fill Start Date and End Date.","admin.api_key_permissions":"API Key Permissions","admin.col_user_status":"User Status","admin.col_api_key_id":"API Key ID","admin.col_api_key_status":"API Key Status","risk.can_read":"Read","risk.can_trade":"Trade","risk.can_close_position":"Close Position","risk.can_risk_manage":"Risk Manage","risk.can_block_new_positions":"Block New Positions","risk.can_block_account":"Block Account","risk.restrict_to_strategies":"Restrict To Strategies","risk.strategy_ids":"Strategy IDs"}`),es:Ws};var Gs=()=>({checkValidity(t){const e=t.input,o={message:"",isValid:!0,invalidKeys:[]};if(!e)return o;let s=!0;if("checkValidity"in e&&(s=e.checkValidity()),s)return o;if(o.isValid=!1,"validationMessage"in e&&(o.message=e.validationMessage),!("validity"in e))return o.invalidKeys.push("customError"),o;for(const r in e.validity){if(r==="valid")continue;const i=r;e.validity[i]&&o.invalidKeys.push(i)}return o}});var Wo=class extends Event{constructor(){super("wa-invalid",{bubbles:!0,cancelable:!1,composed:!0})}};var Js=Object.defineProperty,Qs=Object.getOwnPropertyDescriptor,Go=t=>{throw TypeError(t)},w=(t,e,o,s)=>{for(var r=s>1?void 0:s?Qs(e,o):e,i=t.length-1,a;i>=0;i--)(a=t[i])&&(r=(s?a(e,o,r):a(r))||r);return s&&r&&Js(e,o,r),r},Jo=(t,e,o)=>e.has(t)||Go("Cannot "+o),Xs=(t,e,o)=>(Jo(t,e,"read from private field"),e.get(t)),Ys=(t,e,o)=>e.has(t)?Go("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),Zs=(t,e,o,s)=>(Jo(t,e,"write to private field"),e.set(t,o),o);const _t=globalThis,eo=_t.ShadowRoot&&(_t.ShadyCSS===void 0||_t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,to=Symbol(),yo=new WeakMap;let Qo=class{constructor(e,o,s){if(this._$cssResult$=!0,s!==to)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=o}get styleSheet(){let e=this.o;const o=this.t;if(eo&&e===void 0){const s=o!==void 0&&o.length===1;s&&(e=yo.get(o)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&yo.set(o,e))}return e}toString(){return this.cssText}};const er=t=>new Qo(typeof t=="string"?t:t+"",void 0,to),Z=(t,...e)=>{const o=t.length===1?t[0]:e.reduce((s,r,i)=>s+(a=>{if(a._$cssResult$===!0)return a.cssText;if(typeof a=="number")return a;throw Error("Value passed to 'css' function must be a 'css' function result: "+a+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+t[i+1],t[0]);return new Qo(o,t,to)},tr=(t,e)=>{if(eo)t.adoptedStyleSheets=e.map(o=>o instanceof CSSStyleSheet?o:o.styleSheet);else for(const o of e){const s=document.createElement("style"),r=_t.litNonce;r!==void 0&&s.setAttribute("nonce",r),s.textContent=o.cssText,t.appendChild(s)}},bo=eo?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let o="";for(const s of e.cssRules)o+=s.cssText;return er(o)})(t):t;const{is:or,defineProperty:sr,getOwnPropertyDescriptor:rr,getOwnPropertyNames:ir,getOwnPropertySymbols:ar,getPrototypeOf:nr}=Object,Lt=globalThis,wo=Lt.trustedTypes,cr=wo?wo.emptyScript:"",lr=Lt.reactiveElementPolyfillSupport,qe=(t,e)=>t,ft={toAttribute(t,e){switch(e){case Boolean:t=t?cr:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let o=t;switch(e){case Boolean:o=t!==null;break;case Number:o=t===null?null:Number(t);break;case Object:case Array:try{o=JSON.parse(t)}catch{o=null}}return o}},oo=(t,e)=>!or(t,e),vo={attribute:!0,type:String,converter:ft,reflect:!1,useDefault:!1,hasChanged:oo};Symbol.metadata??=Symbol("metadata"),Lt.litPropertyMetadata??=new WeakMap;let Ie=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,o=vo){if(o.state&&(o.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((o=Object.create(o)).wrapped=!0),this.elementProperties.set(e,o),!o.noAccessor){const s=Symbol(),r=this.getPropertyDescriptor(e,s,o);r!==void 0&&sr(this.prototype,e,r)}}static getPropertyDescriptor(e,o,s){const{get:r,set:i}=rr(this.prototype,e)??{get(){return this[o]},set(a){this[o]=a}};return{get:r,set(a){const l=r?.call(this);i?.call(this,a),this.requestUpdate(e,l,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??vo}static _$Ei(){if(this.hasOwnProperty(qe("elementProperties")))return;const e=nr(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(qe("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(qe("properties"))){const o=this.properties,s=[...ir(o),...ar(o)];for(const r of s)this.createProperty(r,o[r])}const e=this[Symbol.metadata];if(e!==null){const o=litPropertyMetadata.get(e);if(o!==void 0)for(const[s,r]of o)this.elementProperties.set(s,r)}this._$Eh=new Map;for(const[o,s]of this.elementProperties){const r=this._$Eu(o,s);r!==void 0&&this._$Eh.set(r,o)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const o=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const r of s)o.unshift(bo(r))}else e!==void 0&&o.push(bo(e));return o}static _$Eu(e,o){const s=o.attribute;return s===!1?void 0:typeof s=="string"?s:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,o=this.constructor.elementProperties;for(const s of o.keys())this.hasOwnProperty(s)&&(e.set(s,this[s]),delete this[s]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return tr(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,o,s){this._$AK(e,s)}_$ET(e,o){const s=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,s);if(r!==void 0&&s.reflect===!0){const i=(s.converter?.toAttribute!==void 0?s.converter:ft).toAttribute(o,s.type);this._$Em=e,i==null?this.removeAttribute(r):this.setAttribute(r,i),this._$Em=null}}_$AK(e,o){const s=this.constructor,r=s._$Eh.get(e);if(r!==void 0&&this._$Em!==r){const i=s.getPropertyOptions(r),a=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:ft;this._$Em=r;const l=a.fromAttribute(o,i.type);this[r]=l??this._$Ej?.get(r)??l,this._$Em=null}}requestUpdate(e,o,s,r=!1,i){if(e!==void 0){const a=this.constructor;if(r===!1&&(i=this[e]),s??=a.getPropertyOptions(e),!((s.hasChanged??oo)(i,o)||s.useDefault&&s.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(a._$Eu(e,s))))return;this.C(e,o,s)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,o,{useDefault:s,reflect:r,wrapped:i},a){s&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,a??o??this[e]),i!==!0||a!==void 0)||(this._$AL.has(e)||(this.hasUpdated||s||(o=void 0),this._$AL.set(e,o)),r===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(o){Promise.reject(o)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[r,i]of this._$Ep)this[r]=i;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[r,i]of s){const{wrapped:a}=i,l=this[r];a!==!0||this._$AL.has(r)||l===void 0||this.C(r,void 0,i,l)}}let e=!1;const o=this._$AL;try{e=this.shouldUpdate(o),e?(this.willUpdate(o),this._$EO?.forEach(s=>s.hostUpdate?.()),this.update(o)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(o)}willUpdate(e){}_$AE(e){this._$EO?.forEach(o=>o.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(o=>this._$ET(o,this[o])),this._$EM()}updated(e){}firstUpdated(e){}};Ie.elementStyles=[],Ie.shadowRootOptions={mode:"open"},Ie[qe("elementProperties")]=new Map,Ie[qe("finalized")]=new Map,lr?.({ReactiveElement:Ie}),(Lt.reactiveElementVersions??=[]).push("2.1.2");const so=globalThis,So=t=>t,yt=so.trustedTypes,ko=yt?yt.createPolicy("lit-html",{createHTML:t=>t}):void 0,Xo="$lit$",ue=`lit$${Math.random().toFixed(9).slice(2)}$`,Yo="?"+ue,dr=`<${Yo}>`,Ae=document,Ve=()=>Ae.createComment(""),We=t=>t===null||typeof t!="object"&&typeof t!="function",ro=Array.isArray,ur=t=>ro(t)||typeof t?.[Symbol.iterator]=="function",Nt=`[ 	
\f\r]`,Fe=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ao=/-->/g,Co=/>/g,he=RegExp(`>|${Nt}(?:([^\\s"'>=/]+)(${Nt}*=${Nt}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),xo=/'/g,Lo=/"/g,Zo=/^(?:script|style|textarea|title)$/i,mr=t=>(e,...o)=>({_$litType$:t,strings:e,values:o}),W=mr(1),Ce=Symbol.for("lit-noChange"),F=Symbol.for("lit-nothing"),Eo=new WeakMap,we=Ae.createTreeWalker(Ae,129);function es(t,e){if(!ro(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return ko!==void 0?ko.createHTML(e):e}const pr=(t,e)=>{const o=t.length-1,s=[];let r,i=e===2?"<svg>":e===3?"<math>":"",a=Fe;for(let l=0;l<o;l++){const u=t[l];let h,f,y=-1,S=0;for(;S<u.length&&(a.lastIndex=S,f=a.exec(u),f!==null);)S=a.lastIndex,a===Fe?f[1]==="!--"?a=Ao:f[1]!==void 0?a=Co:f[2]!==void 0?(Zo.test(f[2])&&(r=RegExp("</"+f[2],"g")),a=he):f[3]!==void 0&&(a=he):a===he?f[0]===">"?(a=r??Fe,y=-1):f[1]===void 0?y=-2:(y=a.lastIndex-f[2].length,h=f[1],a=f[3]===void 0?he:f[3]==='"'?Lo:xo):a===Lo||a===xo?a=he:a===Ao||a===Co?a=Fe:(a=he,r=void 0);const P=a===he&&t[l+1].startsWith("/>")?" ":"";i+=a===Fe?u+dr:y>=0?(s.push(h),u.slice(0,y)+Xo+u.slice(y)+ue+P):u+ue+(y===-2?l:P)}return[es(t,i+(t[o]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),s]};class Ge{constructor({strings:e,_$litType$:o},s){let r;this.parts=[];let i=0,a=0;const l=e.length-1,u=this.parts,[h,f]=pr(e,o);if(this.el=Ge.createElement(h,s),we.currentNode=this.el.content,o===2||o===3){const y=this.el.content.firstChild;y.replaceWith(...y.childNodes)}for(;(r=we.nextNode())!==null&&u.length<l;){if(r.nodeType===1){if(r.hasAttributes())for(const y of r.getAttributeNames())if(y.endsWith(Xo)){const S=f[a++],P=r.getAttribute(y).split(ue),$=/([.?@])?(.*)/.exec(S);u.push({type:1,index:i,name:$[2],strings:P,ctor:$[1]==="."?gr:$[1]==="?"?hr:$[1]==="@"?fr:Et}),r.removeAttribute(y)}else y.startsWith(ue)&&(u.push({type:6,index:i}),r.removeAttribute(y));if(Zo.test(r.tagName)){const y=r.textContent.split(ue),S=y.length-1;if(S>0){r.textContent=yt?yt.emptyScript:"";for(let P=0;P<S;P++)r.append(y[P],Ve()),we.nextNode(),u.push({type:2,index:++i});r.append(y[S],Ve())}}}else if(r.nodeType===8)if(r.data===Yo)u.push({type:2,index:i});else{let y=-1;for(;(y=r.data.indexOf(ue,y+1))!==-1;)u.push({type:7,index:i}),y+=ue.length-1}i++}}static createElement(e,o){const s=Ae.createElement("template");return s.innerHTML=e,s}}function De(t,e,o=t,s){if(e===Ce)return e;let r=s!==void 0?o._$Co?.[s]:o._$Cl;const i=We(e)?void 0:e._$litDirective$;return r?.constructor!==i&&(r?._$AO?.(!1),i===void 0?r=void 0:(r=new i(t),r._$AT(t,o,s)),s!==void 0?(o._$Co??=[])[s]=r:o._$Cl=r),r!==void 0&&(e=De(t,r._$AS(t,e.values),r,s)),e}class _r{constructor(e,o){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=o}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:o},parts:s}=this._$AD,r=(e?.creationScope??Ae).importNode(o,!0);we.currentNode=r;let i=we.nextNode(),a=0,l=0,u=s[0];for(;u!==void 0;){if(a===u.index){let h;u.type===2?h=new Xe(i,i.nextSibling,this,e):u.type===1?h=new u.ctor(i,u.name,u.strings,this,e):u.type===6&&(h=new yr(i,this,e)),this._$AV.push(h),u=s[++l]}a!==u?.index&&(i=we.nextNode(),a++)}return we.currentNode=Ae,r}p(e){let o=0;for(const s of this._$AV)s!==void 0&&(s.strings!==void 0?(s._$AI(e,s,o),o+=s.strings.length-2):s._$AI(e[o])),o++}}class Xe{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,o,s,r){this.type=2,this._$AH=F,this._$AN=void 0,this._$AA=e,this._$AB=o,this._$AM=s,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const o=this._$AM;return o!==void 0&&e?.nodeType===11&&(e=o.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,o=this){e=De(this,e,o),We(e)?e===F||e==null||e===""?(this._$AH!==F&&this._$AR(),this._$AH=F):e!==this._$AH&&e!==Ce&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):ur(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==F&&We(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ae.createTextNode(e)),this._$AH=e}$(e){const{values:o,_$litType$:s}=e,r=typeof s=="number"?this._$AC(e):(s.el===void 0&&(s.el=Ge.createElement(es(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===r)this._$AH.p(o);else{const i=new _r(r,this),a=i.u(this.options);i.p(o),this.T(a),this._$AH=i}}_$AC(e){let o=Eo.get(e.strings);return o===void 0&&Eo.set(e.strings,o=new Ge(e)),o}k(e){ro(this._$AH)||(this._$AH=[],this._$AR());const o=this._$AH;let s,r=0;for(const i of e)r===o.length?o.push(s=new Xe(this.O(Ve()),this.O(Ve()),this,this.options)):s=o[r],s._$AI(i),r++;r<o.length&&(this._$AR(s&&s._$AB.nextSibling,r),o.length=r)}_$AR(e=this._$AA.nextSibling,o){for(this._$AP?.(!1,!0,o);e!==this._$AB;){const s=So(e).nextSibling;So(e).remove(),e=s}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Et{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,o,s,r,i){this.type=1,this._$AH=F,this._$AN=void 0,this.element=e,this.name=o,this._$AM=r,this.options=i,s.length>2||s[0]!==""||s[1]!==""?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=F}_$AI(e,o=this,s,r){const i=this.strings;let a=!1;if(i===void 0)e=De(this,e,o,0),a=!We(e)||e!==this._$AH&&e!==Ce,a&&(this._$AH=e);else{const l=e;let u,h;for(e=i[0],u=0;u<i.length-1;u++)h=De(this,l[s+u],o,u),h===Ce&&(h=this._$AH[u]),a||=!We(h)||h!==this._$AH[u],h===F?e=F:e!==F&&(e+=(h??"")+i[u+1]),this._$AH[u]=h}a&&!r&&this.j(e)}j(e){e===F?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class gr extends Et{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===F?void 0:e}}class hr extends Et{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==F)}}class fr extends Et{constructor(e,o,s,r,i){super(e,o,s,r,i),this.type=5}_$AI(e,o=this){if((e=De(this,e,o,0)??F)===Ce)return;const s=this._$AH,r=e===F&&s!==F||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,i=e!==F&&(s===F||r);r&&this.element.removeEventListener(this.name,this,s),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class yr{constructor(e,o,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=o,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){De(this,e)}}const br=so.litHtmlPolyfillSupport;br?.(Ge,Xe),(so.litHtmlVersions??=[]).push("3.3.2");const wr=(t,e,o)=>{const s=o?.renderBefore??e;let r=s._$litPart$;if(r===void 0){const i=o?.renderBefore??null;s._$litPart$=r=new Xe(e.insertBefore(Ve(),i),i,void 0,o??{})}return r._$AI(t),r};const io=globalThis;let Ke=class extends Ie{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const o=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=wr(o,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Ce}};Ke._$litElement$=!0,Ke.finalized=!0,io.litElementHydrateSupport?.({LitElement:Ke});const vr=io.litElementPolyfillSupport;vr?.({LitElement:Ke});(io.litElementVersions??=[]).push("4.2.2");const Le=t=>(e,o)=>{o!==void 0?o.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)};const Sr={attribute:!0,type:String,converter:ft,reflect:!1,hasChanged:oo},kr=(t=Sr,e,o)=>{const{kind:s,metadata:r}=o;let i=globalThis.litPropertyMetadata.get(r);if(i===void 0&&globalThis.litPropertyMetadata.set(r,i=new Map),s==="setter"&&((t=Object.create(t)).wrapped=!0),i.set(o.name,t),s==="accessor"){const{name:a}=o;return{set(l){const u=e.get.call(this);e.set.call(this,l),this.requestUpdate(a,u,t,!0,l)},init(l){return l!==void 0&&this.C(a,void 0,t,l),l}}}if(s==="setter"){const{name:a}=o;return function(l){const u=this[a];e.call(this,l),this.requestUpdate(a,u,t,!0,l)}}throw Error("Unsupported decorator location: "+s)};function L(t){return(e,o)=>typeof o=="object"?kr(t,e,o):((s,r,i)=>{const a=r.hasOwnProperty(i);return r.constructor.createProperty(i,s),a?Object.getOwnPropertyDescriptor(r,i):void 0})(t,e,o)}function Pt(t){return L({...t,state:!0,attribute:!1})}const Ar=(t,e,o)=>(o.configurable=!0,o.enumerable=!0,Reflect.decorate&&typeof e!="object"&&Object.defineProperty(t,e,o),o);function Ee(t,e){return(o,s,r)=>{const i=a=>a.renderRoot?.querySelector(t)??null;return Ar(o,s,{get(){return i(this)}})}}var Cr=Z`
  :host {
    box-sizing: border-box !important;
  }

  :host *,
  :host *::before,
  :host *::after {
    box-sizing: inherit !important;
  }

  [hidden] {
    display: none !important;
  }
`,gt,ee=class extends Ke{constructor(){super(),Ys(this,gt,!1),this.initialReflectedProperties=new Map,this.didSSR=!!this.shadowRoot,this.customStates={set:(e,o)=>{if(this.internals?.states)try{o?this.internals.states.add(e):this.internals.states.delete(e)}catch(s){if(String(s).includes("must start with '--'"))console.error("Your browser implements an outdated version of CustomStateSet. Consider using a polyfill");else throw s}},has:e=>{if(!this.internals?.states)return!1;try{return this.internals.states.has(e)}catch{return!1}}};try{this.internals=this.attachInternals()}catch{console.error("Element internals are not supported in your browser. Consider using a polyfill")}this.customStates.set("wa-defined",!0);let t=this.constructor;for(let[e,o]of t.elementProperties)o.default==="inherit"&&o.initial!==void 0&&typeof e=="string"&&this.customStates.set(`initial-${e}-${o.initial}`,!0)}static get styles(){const t=Array.isArray(this.css)?this.css:this.css?[this.css]:[];return[Cr,...t]}attributeChangedCallback(t,e,o){Xs(this,gt)||(this.constructor.elementProperties.forEach((s,r)=>{s.reflect&&this[r]!=null&&this.initialReflectedProperties.set(r,this[r])}),Zs(this,gt,!0)),super.attributeChangedCallback(t,e,o)}willUpdate(t){super.willUpdate(t),this.initialReflectedProperties.forEach((e,o)=>{t.has(o)&&this[o]==null&&(this[o]=e)})}firstUpdated(t){super.firstUpdated(t),this.didSSR&&this.shadowRoot?.querySelectorAll("slot").forEach(e=>{e.dispatchEvent(new Event("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))})}update(t){try{super.update(t)}catch(e){if(this.didSSR&&!this.hasUpdated){const o=new Event("lit-hydration-error",{bubbles:!0,composed:!0,cancelable:!1});o.error=e,this.dispatchEvent(o)}throw e}}relayNativeEvent(t,e){t.stopImmediatePropagation(),this.dispatchEvent(new t.constructor(t.type,{...t,...e}))}};gt=new WeakMap;w([L()],ee.prototype,"dir",2);w([L()],ee.prototype,"lang",2);w([L({type:Boolean,reflect:!0,attribute:"did-ssr"})],ee.prototype,"didSSR",2);var xr=()=>({observedAttributes:["custom-error"],checkValidity(t){const e={message:"",isValid:!0,invalidKeys:[]};return t.customError&&(e.message=t.customError,e.isValid=!1,e.invalidKeys=["customError"]),e}}),ie=class extends ee{constructor(){super(),this.name=null,this.disabled=!1,this.required=!1,this.assumeInteractionOn=["input"],this.validators=[],this.valueHasChanged=!1,this.hasInteracted=!1,this.customError=null,this.emittedEvents=[],this.emitInvalid=t=>{t.target===this&&(this.hasInteracted=!0,this.dispatchEvent(new Wo))},this.handleInteraction=t=>{const e=this.emittedEvents;e.includes(t.type)||e.push(t.type),e.length===this.assumeInteractionOn?.length&&(this.hasInteracted=!0)},this.addEventListener("invalid",this.emitInvalid)}static get validators(){return[xr()]}static get observedAttributes(){const t=new Set(super.observedAttributes||[]);for(const e of this.validators)if(e.observedAttributes)for(const o of e.observedAttributes)t.add(o);return[...t]}connectedCallback(){super.connectedCallback(),this.updateValidity(),this.assumeInteractionOn.forEach(t=>{this.addEventListener(t,this.handleInteraction)})}firstUpdated(...t){super.firstUpdated(...t),this.updateValidity()}willUpdate(t){if(t.has("customError")&&(this.customError||(this.customError=null),this.setCustomValidity(this.customError||"")),t.has("value")||t.has("disabled")){const e=this.value;if(Array.isArray(e)){if(this.name){const o=new FormData;for(const s of e)o.append(this.name,s);this.setValue(o,o)}}else this.setValue(e,e)}t.has("disabled")&&(this.customStates.set("disabled",this.disabled),(this.hasAttribute("disabled")||!this.matches(":disabled"))&&this.toggleAttribute("disabled",this.disabled)),this.updateValidity(),super.willUpdate(t)}get labels(){return this.internals.labels}getForm(){return this.internals.form}set form(t){t?this.setAttribute("form",t):this.removeAttribute("form")}get form(){return this.internals.form}get validity(){return this.internals.validity}get willValidate(){return this.internals.willValidate}get validationMessage(){return this.internals.validationMessage}checkValidity(){return this.updateValidity(),this.internals.checkValidity()}reportValidity(){return this.updateValidity(),this.hasInteracted=!0,this.internals.reportValidity()}get validationTarget(){return this.input||void 0}setValidity(...t){const e=t[0],o=t[1];let s=t[2];s||(s=this.validationTarget),this.internals.setValidity(e,o,s||void 0),this.requestUpdate("validity"),this.setCustomStates()}setCustomStates(){const t=!!this.required,e=this.internals.validity.valid,o=this.hasInteracted;this.customStates.set("required",t),this.customStates.set("optional",!t),this.customStates.set("invalid",!e),this.customStates.set("valid",e),this.customStates.set("user-invalid",!e&&o),this.customStates.set("user-valid",e&&o)}setCustomValidity(t){if(!t){this.customError=null,this.setValidity({});return}this.customError=t,this.setValidity({customError:!0},t,this.validationTarget)}formResetCallback(){this.resetValidity(),this.hasInteracted=!1,this.valueHasChanged=!1,this.emittedEvents=[],this.updateValidity()}formDisabledCallback(t){this.disabled=t,this.updateValidity()}formStateRestoreCallback(t,e){this.value=t,e==="restore"&&this.resetValidity(),this.updateValidity()}setValue(...t){const[e,o]=t;this.internals.setFormValue(e,o)}get allValidators(){const t=this.constructor.validators||[],e=this.validators||[];return[...t,...e]}resetValidity(){this.setCustomValidity(""),this.setValidity({})}updateValidity(){if(this.disabled||this.hasAttribute("disabled")||!this.willValidate){this.resetValidity();return}const t=this.allValidators;if(!t?.length)return;const e={customError:!!this.customError},o=this.validationTarget||this.input||void 0;let s="";for(const r of t){const{isValid:i,message:a,invalidKeys:l}=r.checkValidity(this);i||(s||(s=a),l?.length>=0&&l.forEach(u=>e[u]=!0))}s||(s=this.validationMessage),this.setValidity(e,s,o)}};ie.formAssociated=!0;w([L({reflect:!0})],ie.prototype,"name",2);w([L({type:Boolean})],ie.prototype,"disabled",2);w([L({state:!0,attribute:!1})],ie.prototype,"valueHasChanged",2);w([L({state:!0,attribute:!1})],ie.prototype,"hasInteracted",2);w([L({attribute:"custom-error",reflect:!0})],ie.prototype,"customError",2);w([L({attribute:!1,state:!0,type:Object})],ie.prototype,"validity",1);var Lr=Z`
  @layer wa-component {
    :host {
      display: inline-block;

      /* Workaround because Chrome doesn't like :host(:has()) below
       * https://issues.chromium.org/issues/40062355
       * Firefox doesn't like this nested rule, so both are needed */
      &:has(wa-badge) {
        position: relative;
      }
    }

    /* Apply relative positioning only when needed to position wa-badge
     * This avoids creating a new stacking context for every button */
    :host(:has(wa-badge)) {
      position: relative;
    }
  }

  .button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    user-select: none;
    -webkit-user-select: none;
    white-space: nowrap;
    vertical-align: middle;
    transition-property: background, border, box-shadow, color, opacity;
    transition-duration: var(--wa-transition-fast);
    transition-timing-function: var(--wa-transition-easing);
    cursor: pointer;
    padding: 0 var(--wa-form-control-padding-inline);
    font-family: inherit;
    font-size: inherit;
    font-weight: var(--wa-font-weight-action);
    line-height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
    height: var(--wa-form-control-height);
    width: 100%;

    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    border-radius: var(--wa-form-control-border-radius);
    border-style: var(--wa-border-style);
    border-width: var(--wa-border-width-s);
  }

  /* Appearance modifiers */
  :host([appearance='plain']) {
    .button {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: transparent;
      border-color: transparent;
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
        background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='outlined']) {
    .button {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: transparent;
      border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
        background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='filled']) {
    .button {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
      border-color: transparent;
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
        background-color: color-mix(
          in oklab,
          var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
          var(--wa-color-mix-hover)
        );
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='filled-outlined']) {
    .button {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
      border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
        background-color: color-mix(
          in oklab,
          var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
          var(--wa-color-mix-hover)
        );
      }
    }
    .button:not(.disabled):not(.loading):active {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-active)
      );
    }
  }

  :host([appearance='accent']) {
    .button {
      color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
      background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
      border-color: transparent;
    }
    @media (hover: hover) {
      .button:not(.disabled):not(.loading):hover {
        background-color: color-mix(
          in oklab,
          var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
          var(--wa-color-mix-hover)
        );
      }
    }
    .button:not(.disabled):not(.loading):active {
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
        var(--wa-color-mix-active)
      );
    }
  }

  /* Focus states */
  .button:focus {
    outline: none;
  }

  .button:focus-visible {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }

  /* Disabled state */
  :host([disabled]) {
    opacity: 0.5;
    cursor: not-allowed;

    /* When disabled, prevent mouse events from bubbling up from children */
    .button {
      pointer-events: none;
    }
  }

  /* Keep it last so Safari doesn't stop parsing this block */
  .button::-moz-focus-inner {
    border: 0;
  }

  /* Icon buttons */
  .button.is-icon-button {
    outline-offset: 2px;
    width: var(--wa-form-control-height);
    aspect-ratio: 1;
  }

  .button.is-icon-button:has(wa-icon) {
    width: auto;
  }

  /* Pill modifier */
  :host([pill]) .button {
    border-radius: var(--wa-border-radius-pill);
  }

  /*
   * Label
   */

  .start,
  .end {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    pointer-events: none;
  }

  .label {
    display: inline-block;
  }

  .is-icon-button .label {
    display: flex;
  }

  .label::slotted(wa-icon) {
    align-self: center;
  }

  /*
   * Caret modifier
   */

  wa-icon[part='caret'] {
    display: flex;
    align-self: center;
    align-items: center;

    &::part(svg) {
      width: 0.875em;
      height: 0.875em;
    }

    .button:has(&) .end {
      display: none;
    }
  }

  /*
   * Loading modifier
   */

  .loading {
    position: relative;
    cursor: wait;

    .start,
    .label,
    .end,
    .caret {
      visibility: hidden;
    }

    wa-spinner {
      --indicator-color: currentColor;
      --track-color: color-mix(in oklab, currentColor, transparent 90%);

      position: absolute;
      font-size: 1em;
      height: 1em;
      width: 1em;
      top: calc(50% - 0.5em);
      left: calc(50% - 0.5em);
    }
  }

  /*
   * Badges
   */

  .button ::slotted(wa-badge) {
    border-color: var(--wa-color-surface-default);
    position: absolute;
    inset-block-start: 0;
    inset-inline-end: 0;
    translate: 50% -50%;
    pointer-events: none;
  }

  :host(:dir(rtl)) ::slotted(wa-badge) {
    translate: -50% -50%;
  }

  /*
  * Button spacing
  */

  slot[name='start']::slotted(*) {
    margin-inline-end: 0.75em;
  }

  slot[name='end']::slotted(*),
  .button:not(.visually-hidden-label) [part='caret'] {
    margin-inline-start: 0.75em;
  }

  /*
   * Button group border radius modifications
   */

  /* Remove border radius from all grouped buttons by default */
  :host(.wa-button-group__button) .button {
    border-radius: 0;
  }

  /* Horizontal orientation */
  :host(.wa-button-group__horizontal.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-form-control-border-radius);
    border-end-start-radius: var(--wa-form-control-border-radius);
  }

  :host(.wa-button-group__horizontal.wa-button-group__button-last) .button {
    border-start-end-radius: var(--wa-form-control-border-radius);
    border-end-end-radius: var(--wa-form-control-border-radius);
  }

  /* Vertical orientation */
  :host(.wa-button-group__vertical) {
    flex: 1 1 auto;
  }

  :host(.wa-button-group__vertical) .button {
    width: 100%;
    justify-content: start;
  }

  :host(.wa-button-group__vertical.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-form-control-border-radius);
    border-start-end-radius: var(--wa-form-control-border-radius);
  }

  :host(.wa-button-group__vertical.wa-button-group__button-last) .button {
    border-end-start-radius: var(--wa-form-control-border-radius);
    border-end-end-radius: var(--wa-form-control-border-radius);
  }

  /* Handle pill modifier for button groups */
  :host([pill].wa-button-group__horizontal.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-border-radius-pill);
    border-end-start-radius: var(--wa-border-radius-pill);
  }

  :host([pill].wa-button-group__horizontal.wa-button-group__button-last) .button {
    border-start-end-radius: var(--wa-border-radius-pill);
    border-end-end-radius: var(--wa-border-radius-pill);
  }

  :host([pill].wa-button-group__vertical.wa-button-group__button-first) .button {
    border-start-start-radius: var(--wa-border-radius-pill);
    border-start-end-radius: var(--wa-border-radius-pill);
  }

  :host([pill].wa-button-group__vertical.wa-button-group__button-last) .button {
    border-end-start-radius: var(--wa-border-radius-pill);
    border-end-end-radius: var(--wa-border-radius-pill);
  }
`;var ts=class{constructor(t,...e){this.slotNames=[],this.handleSlotChange=o=>{const s=o.target;(this.slotNames.includes("[default]")&&!s.name||s.name&&this.slotNames.includes(s.name))&&this.host.requestUpdate()},(this.host=t).addController(this),this.slotNames=e}hasDefaultSlot(){return[...this.host.childNodes].some(t=>{if(t.nodeType===Node.TEXT_NODE&&t.textContent.trim()!=="")return!0;if(t.nodeType===Node.ELEMENT_NODE){const e=t;if(e.tagName.toLowerCase()==="wa-visually-hidden")return!1;if(!e.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(t){return this.host.querySelector(`:scope > [slot="${t}"]`)!==null}test(t){return t==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(t)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};var Er=Z`
  :host([size='small']),
  .wa-size-s {
    font-size: var(--wa-font-size-s);
  }

  :host([size='medium']),
  .wa-size-m {
    font-size: var(--wa-font-size-m);
  }

  :host([size='large']),
  .wa-size-l {
    font-size: var(--wa-font-size-l);
  }
`;var Pr=Z`
  :where(:root),
  .wa-neutral,
  :host([variant='neutral']) {
    --wa-color-fill-loud: var(--wa-color-neutral-fill-loud);
    --wa-color-fill-normal: var(--wa-color-neutral-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-neutral-fill-quiet);
    --wa-color-border-loud: var(--wa-color-neutral-border-loud);
    --wa-color-border-normal: var(--wa-color-neutral-border-normal);
    --wa-color-border-quiet: var(--wa-color-neutral-border-quiet);
    --wa-color-on-loud: var(--wa-color-neutral-on-loud);
    --wa-color-on-normal: var(--wa-color-neutral-on-normal);
    --wa-color-on-quiet: var(--wa-color-neutral-on-quiet);
  }

  .wa-brand,
  :host([variant='brand']) {
    --wa-color-fill-loud: var(--wa-color-brand-fill-loud);
    --wa-color-fill-normal: var(--wa-color-brand-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-brand-fill-quiet);
    --wa-color-border-loud: var(--wa-color-brand-border-loud);
    --wa-color-border-normal: var(--wa-color-brand-border-normal);
    --wa-color-border-quiet: var(--wa-color-brand-border-quiet);
    --wa-color-on-loud: var(--wa-color-brand-on-loud);
    --wa-color-on-normal: var(--wa-color-brand-on-normal);
    --wa-color-on-quiet: var(--wa-color-brand-on-quiet);
  }

  .wa-success,
  :host([variant='success']) {
    --wa-color-fill-loud: var(--wa-color-success-fill-loud);
    --wa-color-fill-normal: var(--wa-color-success-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-success-fill-quiet);
    --wa-color-border-loud: var(--wa-color-success-border-loud);
    --wa-color-border-normal: var(--wa-color-success-border-normal);
    --wa-color-border-quiet: var(--wa-color-success-border-quiet);
    --wa-color-on-loud: var(--wa-color-success-on-loud);
    --wa-color-on-normal: var(--wa-color-success-on-normal);
    --wa-color-on-quiet: var(--wa-color-success-on-quiet);
  }

  .wa-warning,
  :host([variant='warning']) {
    --wa-color-fill-loud: var(--wa-color-warning-fill-loud);
    --wa-color-fill-normal: var(--wa-color-warning-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-warning-fill-quiet);
    --wa-color-border-loud: var(--wa-color-warning-border-loud);
    --wa-color-border-normal: var(--wa-color-warning-border-normal);
    --wa-color-border-quiet: var(--wa-color-warning-border-quiet);
    --wa-color-on-loud: var(--wa-color-warning-on-loud);
    --wa-color-on-normal: var(--wa-color-warning-on-normal);
    --wa-color-on-quiet: var(--wa-color-warning-on-quiet);
  }

  .wa-danger,
  :host([variant='danger']) {
    --wa-color-fill-loud: var(--wa-color-danger-fill-loud);
    --wa-color-fill-normal: var(--wa-color-danger-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-danger-fill-quiet);
    --wa-color-border-loud: var(--wa-color-danger-border-loud);
    --wa-color-border-normal: var(--wa-color-danger-border-normal);
    --wa-color-border-quiet: var(--wa-color-danger-border-quiet);
    --wa-color-on-loud: var(--wa-color-danger-on-loud);
    --wa-color-on-normal: var(--wa-color-danger-on-normal);
    --wa-color-on-quiet: var(--wa-color-danger-on-quiet);
  }
`;const jt=new Set,$e=new Map;let ye,ao="ltr",no="en";const os=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(os){const t=new MutationObserver(rs);ao=document.documentElement.dir||"ltr",no=document.documentElement.lang||navigator.language,t.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function ss(...t){t.map(e=>{const o=e.$code.toLowerCase();$e.has(o)?$e.set(o,Object.assign(Object.assign({},$e.get(o)),e)):$e.set(o,e),ye||(ye=e)}),rs()}function rs(){os&&(ao=document.documentElement.dir||"ltr",no=document.documentElement.lang||navigator.language),[...jt.keys()].map(t=>{typeof t.requestUpdate=="function"&&t.requestUpdate()})}let Ir=class{constructor(e){this.host=e,this.host.addController(this)}hostConnected(){jt.add(this.host)}hostDisconnected(){jt.delete(this.host)}dir(){return`${this.host.dir||ao}`.toLowerCase()}lang(){return`${this.host.lang||no}`.toLowerCase()}getTranslationData(e){var o,s;const r=new Intl.Locale(e.replace(/_/g,"-")),i=r?.language.toLowerCase(),a=(s=(o=r?.region)===null||o===void 0?void 0:o.toLowerCase())!==null&&s!==void 0?s:"",l=$e.get(`${i}-${a}`),u=$e.get(i);return{locale:r,language:i,region:a,primary:l,secondary:u}}exists(e,o){var s;const{primary:r,secondary:i}=this.getTranslationData((s=o.lang)!==null&&s!==void 0?s:this.lang());return o=Object.assign({includeFallback:!1},o),!!(r&&r[e]||i&&i[e]||o.includeFallback&&ye&&ye[e])}term(e,...o){const{primary:s,secondary:r}=this.getTranslationData(this.lang());let i;if(s&&s[e])i=s[e];else if(r&&r[e])i=r[e];else if(ye&&ye[e])i=ye[e];else return console.error(`No translation found for: ${String(e)}`),String(e);return typeof i=="function"?i(...o):i}date(e,o){return e=new Date(e),new Intl.DateTimeFormat(this.lang(),o).format(e)}number(e,o){return e=Number(e),isNaN(e)?"":new Intl.NumberFormat(this.lang(),o).format(e)}relativeTime(e,o,s){return new Intl.RelativeTimeFormat(this.lang(),s).format(e,o)}};var is={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",dropFileHere:"Drop file here or click to browse",decrement:"Decrement",dropFilesHere:"Drop files here or click to browse",error:"Error",goToSlide:(t,e)=>`Go to slide ${t} of ${e}`,hidePassword:"Hide password",increment:"Increment",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:t=>t===0?"No options selected":t===1?"1 option selected":`${t} options selected`,pauseAnimation:"Pause animation",playAnimation:"Play animation",previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollableRegion:"Scrollable region",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:t=>`Slide ${t}`,toggleColorFormat:"Toggle color format",zoomIn:"Zoom in",zoomOut:"Zoom out"};ss(is);var $r=is;var It=class extends Ir{};ss($r);function ae(t,e){const o={waitUntilFirstUpdate:!1,...e};return(s,r)=>{const{update:i}=s,a=Array.isArray(t)?t:[t];s.update=function(l){a.forEach(u=>{const h=u;if(l.has(h)){const f=l.get(h),y=this[h];f!==y&&(!o.waitUntilFirstUpdate||this.hasUpdated)&&this[r](f,y)}}),i.call(this,l)}}}const Tr={ATTRIBUTE:1},Or=t=>(...e)=>({_$litDirective$:t,values:e});let Dr=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,o,s){this._$Ct=e,this._$AM=o,this._$Ci=s}_$AS(e,o){return this.update(e,o)}update(e,o){return this.render(...o)}};const Ye=Or(class extends Dr{constructor(t){if(super(t),t.type!==Tr.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in e)e[s]&&!this.nt?.has(s)&&this.st.add(s);return this.render(e)}const o=t.element.classList;for(const s of this.st)s in e||(o.remove(s),this.st.delete(s));for(const s in e){const r=!!e[s];r===this.st.has(s)||this.nt?.has(s)||(r?(o.add(s),this.st.add(s)):(o.remove(s),this.st.delete(s)))}return Ce}});const J=t=>t??F;const as=Symbol.for(""),Br=t=>{if(t?.r===as)return t?._$litStatic$},Po=(t,...e)=>({_$litStatic$:e.reduce((o,s,r)=>o+(i=>{if(i._$litStatic$!==void 0)return i._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${i}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(s)+t[r+1],t[0]),r:as}),Io=new Map,Mr=t=>(e,...o)=>{const s=o.length;let r,i;const a=[],l=[];let u,h=0,f=!1;for(;h<s;){for(u=e[h];h<s&&(i=o[h],(r=Br(i))!==void 0);)u+=r+e[++h],f=!0;h!==s&&l.push(i),a.push(u),h++}if(h===s&&a.push(e[s]),f){const y=a.join("$$lit$$");(e=Io.get(y))===void 0&&(a.raw=a,Io.set(y,e=a)),o=l}return t(e,...o)},zt=Mr(W);var B=class extends ie{constructor(){super(...arguments),this.assumeInteractionOn=["click"],this.hasSlotController=new ts(this,"[default]","start","end"),this.localize=new It(this),this.invalid=!1,this.isIconButton=!1,this.title="",this.variant="neutral",this.appearance="accent",this.size="medium",this.withCaret=!1,this.disabled=!1,this.loading=!1,this.pill=!1,this.type="button"}static get validators(){return[...super.validators,Gs()]}constructLightDOMButton(){const t=document.createElement("button");for(const e of this.attributes)e.name!=="style"&&t.setAttribute(e.name,e.value);return t.type=this.type,t.style.position="absolute !important",t.style.width="0 !important",t.style.height="0 !important",t.style.clipPath="inset(50%) !important",t.style.overflow="hidden !important",t.style.whiteSpace="nowrap !important",this.name&&(t.name=this.name),t.value=this.value||"",t}handleClick(t){if(this.disabled||this.loading){t.preventDefault(),t.stopImmediatePropagation();return}if(this.type!=="submit"&&this.type!=="reset"||!this.getForm())return;const o=this.constructLightDOMButton();this.parentElement?.append(o),o.click(),o.remove()}handleInvalid(){this.dispatchEvent(new Wo)}handleLabelSlotChange(){const t=this.labelSlot.assignedNodes({flatten:!0});let e=!1,o=!1,s=!1,r=!1;[...t].forEach(i=>{if(i.nodeType===Node.ELEMENT_NODE){const a=i;a.localName==="wa-icon"?(o=!0,e||(e=a.label!==void 0)):r=!0}else i.nodeType===Node.TEXT_NODE&&(i.textContent?.trim()||"").length>0&&(s=!0)}),this.isIconButton=o&&!s&&!r,this.isIconButton&&!e&&console.warn('Icon buttons must have a label for screen readers. Add <wa-icon label="..."> to remove this warning.',this)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.updateValidity()}setValue(...t){}click(){this.button.click()}focus(t){this.button.focus(t)}blur(){this.button.blur()}render(){const t=this.isLink(),e=t?Po`a`:Po`button`;return zt`
      <${e}
        part="base"
        class=${Ye({button:!0,caret:this.withCaret,disabled:this.disabled,loading:this.loading,rtl:this.localize.dir()==="rtl","has-label":this.hasSlotController.test("[default]"),"has-start":this.hasSlotController.test("start"),"has-end":this.hasSlotController.test("end"),"is-icon-button":this.isIconButton})}
        ?disabled=${J(t?void 0:this.disabled)}
        type=${J(t?void 0:this.type)}
        title=${this.title}
        name=${J(t?void 0:this.name)}
        value=${J(t?void 0:this.value)}
        href=${J(t?this.href:void 0)}
        target=${J(t?this.target:void 0)}
        download=${J(t?this.download:void 0)}
        rel=${J(t&&this.rel?this.rel:void 0)}
        role=${J(t?void 0:"button")}
        aria-disabled=${J(t&&this.disabled?"true":void 0)}
        tabindex=${this.disabled?"-1":"0"}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="start" part="start" class="start"></slot>
        <slot part="label" class="label" @slotchange=${this.handleLabelSlotChange}></slot>
        <slot name="end" part="end" class="end"></slot>
        ${this.withCaret?zt`
                <wa-icon part="caret" class="caret" library="system" name="chevron-down" variant="solid"></wa-icon>
              `:""}
        ${this.loading?zt`<wa-spinner part="spinner"></wa-spinner>`:""}
      </${e}>
    `}};B.shadowRootOptions={...ie.shadowRootOptions,delegatesFocus:!0};B.css=[Lr,Pr,Er];w([Ee(".button")],B.prototype,"button",2);w([Ee("slot:not([name])")],B.prototype,"labelSlot",2);w([Pt()],B.prototype,"invalid",2);w([Pt()],B.prototype,"isIconButton",2);w([L()],B.prototype,"title",2);w([L({reflect:!0})],B.prototype,"variant",2);w([L({reflect:!0})],B.prototype,"appearance",2);w([L({reflect:!0})],B.prototype,"size",2);w([L({attribute:"with-caret",type:Boolean,reflect:!0})],B.prototype,"withCaret",2);w([L({type:Boolean})],B.prototype,"disabled",2);w([L({type:Boolean,reflect:!0})],B.prototype,"loading",2);w([L({type:Boolean,reflect:!0})],B.prototype,"pill",2);w([L()],B.prototype,"type",2);w([L({reflect:!0})],B.prototype,"name",2);w([L({reflect:!0})],B.prototype,"value",2);w([L({reflect:!0})],B.prototype,"href",2);w([L()],B.prototype,"target",2);w([L()],B.prototype,"rel",2);w([L()],B.prototype,"download",2);w([L({attribute:"formaction"})],B.prototype,"formAction",2);w([L({attribute:"formenctype"})],B.prototype,"formEnctype",2);w([L({attribute:"formmethod"})],B.prototype,"formMethod",2);w([L({attribute:"formnovalidate",type:Boolean})],B.prototype,"formNoValidate",2);w([L({attribute:"formtarget"})],B.prototype,"formTarget",2);w([ae("disabled",{waitUntilFirstUpdate:!0})],B.prototype,"handleDisabledChange",1);B=w([Le("wa-button")],B);var Nr=Z`
  :host {
    --track-width: 2px;
    --track-color: var(--wa-color-neutral-fill-normal);
    --indicator-color: var(--wa-color-brand-fill-loud);
    --speed: 2s;

    /*
      Resizing a spinner element using anything but font-size will break the animation because the animation uses em
      units. Therefore, if a spinner is used in a flex container without \`flex: none\` applied, the spinner can
      grow/shrink and break the animation. The use of \`flex: none\` on the host element prevents this by always having
      the spinner sized according to its actual dimensions.
    */
    flex: none;
    display: inline-flex;
    width: 1em;
    height: 1em;
  }

  svg {
    width: 100%;
    height: 100%;
    aspect-ratio: 1;
    animation: spin var(--speed) linear infinite;
  }

  .track {
    stroke: var(--track-color);
  }

  .indicator {
    stroke: var(--indicator-color);
    stroke-dasharray: 75, 100;
    stroke-dashoffset: -5;
    animation: dash 1.5s ease-in-out infinite;
    stroke-linecap: round;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  @keyframes dash {
    0% {
      stroke-dasharray: 1, 150;
      stroke-dashoffset: 0;
    }
    50% {
      stroke-dasharray: 90, 150;
      stroke-dashoffset: -35;
    }
    100% {
      stroke-dasharray: 90, 150;
      stroke-dashoffset: -124;
    }
  }
`;var Vt=class extends ee{constructor(){super(...arguments),this.localize=new It(this)}render(){return W`
      <svg
        part="base"
        role="progressbar"
        aria-label=${this.localize.term("loading")}
        fill="none"
        viewBox="0 0 50 50"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle class="track" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
        <circle class="indicator" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
      </svg>
    `}};Vt.css=Nr;Vt=w([Le("wa-spinner")],Vt);var zr=class extends Event{constructor(){super("wa-error",{bubbles:!0,cancelable:!1,composed:!0})}};var Rr=class extends Event{constructor(){super("wa-load",{bubbles:!0,cancelable:!1,composed:!0})}};var Fr=Z`
  :host {
    --primary-color: currentColor;
    --primary-opacity: 1;
    --secondary-color: currentColor;
    --secondary-opacity: 0.4;
    --rotate-angle: 0deg;

    box-sizing: content-box;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: -0.125em;
  }

  /* Standard */
  :host(:not([auto-width])) {
    width: 1.25em;
    height: 1em;
  }

  /* Auto-width */
  :host([auto-width]) {
    width: auto;
    height: 1em;
  }

  svg {
    height: 1em;
    overflow: visible;
    width: auto;

    /* Duotone colors with path-specific opacity fallback */
    path[data-duotone-primary] {
      color: var(--primary-color);
      opacity: var(--path-opacity, var(--primary-opacity));
    }

    path[data-duotone-secondary] {
      color: var(--secondary-color);
      opacity: var(--path-opacity, var(--secondary-opacity));
    }
  }

  /* Rotation */
  :host([rotate]) {
    transform: rotate(var(--rotate-angle, 0deg));
  }

  /* Flipping */
  :host([flip='x']) {
    transform: scaleX(-1);
  }
  :host([flip='y']) {
    transform: scaleY(-1);
  }
  :host([flip='both']) {
    transform: scale(-1, -1);
  }

  /* Rotation and Flipping combined */
  :host([rotate][flip='x']) {
    transform: rotate(var(--rotate-angle, 0deg)) scaleX(-1);
  }
  :host([rotate][flip='y']) {
    transform: rotate(var(--rotate-angle, 0deg)) scaleY(-1);
  }
  :host([rotate][flip='both']) {
    transform: rotate(var(--rotate-angle, 0deg)) scale(-1, -1);
  }

  /* Animations */
  :host([animation='beat']) {
    animation-name: beat;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, ease-in-out);
  }

  :host([animation='fade']) {
    animation-name: fade;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
  }

  :host([animation='beat-fade']) {
    animation-name: beat-fade;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
  }

  :host([animation='bounce']) {
    animation-name: bounce;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
  }

  :host([animation='flip']) {
    animation-name: flip;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, ease-in-out);
  }

  :host([animation='shake']) {
    animation-name: shake;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, linear);
  }

  :host([animation='spin']) {
    animation-name: spin;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 2s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, linear);
  }

  :host([animation='spin-pulse']) {
    animation-name: spin-pulse;
    animation-direction: var(--animation-direction, normal);
    animation-duration: var(--animation-duration, 1s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, steps(8));
  }

  :host([animation='spin-reverse']) {
    animation-name: spin;
    animation-delay: var(--animation-delay, 0s);
    animation-direction: var(--animation-direction, reverse);
    animation-duration: var(--animation-duration, 2s);
    animation-iteration-count: var(--animation-iteration-count, infinite);
    animation-timing-function: var(--animation-timing, linear);
  }

  /* Keyframes */
  @media (prefers-reduced-motion: reduce) {
    :host([animation='beat']),
    :host([animation='bounce']),
    :host([animation='fade']),
    :host([animation='beat-fade']),
    :host([animation='flip']),
    :host([animation='shake']),
    :host([animation='spin']),
    :host([animation='spin-pulse']),
    :host([animation='spin-reverse']) {
      animation: none !important;
      transition: none !important;
    }
  }
  @keyframes beat {
    0%,
    90% {
      transform: scale(1);
    }
    45% {
      transform: scale(var(--beat-scale, 1.25));
    }
  }

  @keyframes fade {
    50% {
      opacity: var(--fade-opacity, 0.4);
    }
  }

  @keyframes beat-fade {
    0%,
    100% {
      opacity: var(--beat-fade-opacity, 0.4);
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(var(--beat-fade-scale, 1.125));
    }
  }

  @keyframes bounce {
    0% {
      transform: scale(1, 1) translateY(0);
    }
    10% {
      transform: scale(var(--bounce-start-scale-x, 1.1), var(--bounce-start-scale-y, 0.9)) translateY(0);
    }
    30% {
      transform: scale(var(--bounce-jump-scale-x, 0.9), var(--bounce-jump-scale-y, 1.1))
        translateY(var(--bounce-height, -0.5em));
    }
    50% {
      transform: scale(var(--bounce-land-scale-x, 1.05), var(--bounce-land-scale-y, 0.95)) translateY(0);
    }
    57% {
      transform: scale(1, 1) translateY(var(--bounce-rebound, -0.125em));
    }
    64% {
      transform: scale(1, 1) translateY(0);
    }
    100% {
      transform: scale(1, 1) translateY(0);
    }
  }

  @keyframes flip {
    50% {
      transform: rotate3d(var(--flip-x, 0), var(--flip-y, 1), var(--flip-z, 0), var(--flip-angle, -180deg));
    }
  }

  @keyframes shake {
    0% {
      transform: rotate(-15deg);
    }
    4% {
      transform: rotate(15deg);
    }
    8%,
    24% {
      transform: rotate(-18deg);
    }
    12%,
    28% {
      transform: rotate(18deg);
    }
    16% {
      transform: rotate(-22deg);
    }
    20% {
      transform: rotate(22deg);
    }
    32% {
      transform: rotate(-12deg);
    }
    36% {
      transform: rotate(12deg);
    }
    40%,
    100% {
      transform: rotate(0deg);
    }
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  @keyframes spin-pulse {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
`;function Ur(t){return`data:image/svg+xml,${encodeURIComponent(t)}`}var Rt={solid:{check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M434.8 70.1c14.3 10.4 17.5 30.4 7.1 44.7l-256 352c-5.5 7.6-14 12.3-23.4 13.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l101.5 101.5 234-321.7c10.4-14.3 30.4-17.5 44.7-7.1z"/></svg>',"chevron-down":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M311.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L243.2 256 73.9 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0z"/></svg>',eyedropper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M341.6 29.2l-101.6 101.6-9.4-9.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-9.4-9.4 101.6-101.6c39-39 39-102.2 0-141.1s-102.2-39-141.1 0zM55.4 323.3c-15 15-23.4 35.4-23.4 56.6l0 42.4-26.6 39.9c-8.5 12.7-6.8 29.6 4 40.4s27.7 12.5 40.4 4l39.9-26.6 42.4 0c21.2 0 41.6-8.4 56.6-23.4l109.4-109.4-45.3-45.3-109.4 109.4c-3 3-7.1 4.7-11.3 4.7l-36.1 0 0-36.1c0-4.2 1.7-8.3 4.7-11.3l109.4-109.4-45.3-45.3-109.4 109.4z"/></svg>',file:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M192 64C156.7 64 128 92.7 128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 234.5C512 217.5 505.3 201.2 493.3 189.2L386.7 82.7C374.7 70.7 358.5 64 341.5 64L192 64zM453.5 240L360 240C346.7 240 336 229.3 336 216L336 122.5L453.5 240z"/></svg>',"file-audio":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM389.8 307.7C380.7 301.4 368.3 303.6 362 312.7C355.7 321.8 357.9 334.2 367 340.5C390.9 357.2 406.4 384.8 406.4 416C406.4 447.2 390.8 474.9 367 491.5C357.9 497.8 355.7 510.3 362 519.3C368.3 528.3 380.8 530.6 389.8 524.3C423.9 500.5 446.4 460.8 446.4 416C446.4 371.2 424 331.5 389.8 307.7zM208 376C199.2 376 192 383.2 192 392L192 440C192 448.8 199.2 456 208 456L232 456L259.2 490C262.2 493.8 266.8 496 271.7 496L272 496C280.8 496 288 488.8 288 480L288 352C288 343.2 280.8 336 272 336L271.7 336C266.8 336 262.2 338.2 259.2 342L232 376L208 376zM336 448.2C336 458.9 346.5 466.4 354.9 459.8C367.8 449.5 376 433.7 376 416C376 398.3 367.8 382.5 354.9 372.2C346.5 365.5 336 373.1 336 383.8L336 448.3z"/></svg>',"file-code":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM282.2 359.6C290.8 349.5 289.7 334.4 279.6 325.8C269.5 317.2 254.4 318.3 245.8 328.4L197.8 384.4C190.1 393.4 190.1 406.6 197.8 415.6L245.8 471.6C254.4 481.7 269.6 482.8 279.6 474.2C289.6 465.6 290.8 450.4 282.2 440.4L247.6 400L282.2 359.6zM394.2 328.4C385.6 318.3 370.4 317.2 360.4 325.8C350.4 334.4 349.2 349.6 357.8 359.6L392.4 400L357.8 440.4C349.2 450.5 350.3 465.6 360.4 474.2C370.5 482.8 385.6 481.7 394.2 471.6L442.2 415.6C449.9 406.6 449.9 393.4 442.2 384.4L394.2 328.4z"/></svg>',"file-excel":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM292 330.7C284.6 319.7 269.7 316.7 258.7 324C247.7 331.3 244.7 346.3 252 357.3L291.2 416L252 474.7C244.6 485.7 247.6 500.6 258.7 508C269.8 515.4 284.6 512.4 292 501.3L320 459.3L348 501.3C355.4 512.3 370.3 515.3 381.3 508C392.3 500.7 395.3 485.7 388 474.7L348.8 416L388 357.3C395.4 346.3 392.4 331.4 381.3 324C370.2 316.6 355.4 319.6 348 330.7L320 372.7L292 330.7z"/></svg>',"file-image":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM256 320C256 302.3 241.7 288 224 288C206.3 288 192 302.3 192 320C192 337.7 206.3 352 224 352C241.7 352 256 337.7 256 320zM220.6 512L419.4 512C435.2 512 448 499.2 448 483.4C448 476.1 445.2 469 440.1 463.7L343.3 361.9C337.3 355.6 328.9 352 320.1 352L319.8 352C311 352 302.7 355.6 296.6 361.9L199.9 463.7C194.8 469 192 476.1 192 483.4C192 499.2 204.8 512 220.6 512z"/></svg>',"file-pdf":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 64C92.7 64 64 92.7 64 128L64 512C64 547.3 92.7 576 128 576L208 576L208 464C208 428.7 236.7 400 272 400L448 400L448 234.5C448 217.5 441.3 201.2 429.3 189.2L322.7 82.7C310.7 70.7 294.5 64 277.5 64L128 64zM389.5 240L296 240C282.7 240 272 229.3 272 216L272 122.5L389.5 240zM272 444C261 444 252 453 252 464L252 592C252 603 261 612 272 612C283 612 292 603 292 592L292 564L304 564C337.1 564 364 537.1 364 504C364 470.9 337.1 444 304 444L272 444zM304 524L292 524L292 484L304 484C315 484 324 493 324 504C324 515 315 524 304 524zM400 444C389 444 380 453 380 464L380 592C380 603 389 612 400 612L432 612C460.7 612 484 588.7 484 560L484 496C484 467.3 460.7 444 432 444L400 444zM420 572L420 484L432 484C438.6 484 444 489.4 444 496L444 560C444 566.6 438.6 572 432 572L420 572zM508 464L508 592C508 603 517 612 528 612C539 612 548 603 548 592L548 548L576 548C587 548 596 539 596 528C596 517 587 508 576 508L548 508L548 484L576 484C587 484 596 475 596 464C596 453 587 444 576 444L528 444C517 444 508 453 508 464z"/></svg>',"file-powerpoint":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM280 320C266.7 320 256 330.7 256 344L256 488C256 501.3 266.7 512 280 512C293.3 512 304 501.3 304 488L304 464L328 464C367.8 464 400 431.8 400 392C400 352.2 367.8 320 328 320L280 320zM328 416L304 416L304 368L328 368C341.3 368 352 378.7 352 392C352 405.3 341.3 416 328 416z"/></svg>',"file-video":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM208 368L208 464C208 481.7 222.3 496 240 496L336 496C353.7 496 368 481.7 368 464L368 440L403 475C406.2 478.2 410.5 480 415 480C424.4 480 432 472.4 432 463L432 368.9C432 359.5 424.4 351.9 415 351.9C410.5 351.9 406.2 353.7 403 356.9L368 391.9L368 367.9C368 350.2 353.7 335.9 336 335.9L240 335.9C222.3 335.9 208 350.2 208 367.9z"/></svg>',"file-word":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM263.4 338.8C260.5 325.9 247.7 317.7 234.8 320.6C221.9 323.5 213.7 336.3 216.6 349.2L248.6 493.2C250.9 503.7 260 511.4 270.8 512C281.6 512.6 291.4 505.9 294.8 495.6L320 419.9L345.2 495.6C348.6 505.8 358.4 512.5 369.2 512C380 511.5 389.1 503.8 391.4 493.2L423.4 349.2C426.3 336.3 418.1 323.4 405.2 320.6C392.3 317.8 379.4 325.9 376.6 338.8L363.4 398.2L342.8 336.4C339.5 326.6 330.4 320 320 320C309.6 320 300.5 326.6 297.2 336.4L276.6 398.2L263.4 338.8z"/></svg>',"file-zipper":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M128 128C128 92.7 156.7 64 192 64L341.5 64C358.5 64 374.8 70.7 386.8 82.7L493.3 189.3C505.3 201.3 512 217.6 512 234.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM336 122.5L336 216C336 229.3 346.7 240 360 240L453.5 240L336 122.5zM192 136C192 149.3 202.7 160 216 160L264 160C277.3 160 288 149.3 288 136C288 122.7 277.3 112 264 112L216 112C202.7 112 192 122.7 192 136zM192 232C192 245.3 202.7 256 216 256L264 256C277.3 256 288 245.3 288 232C288 218.7 277.3 208 264 208L216 208C202.7 208 192 218.7 192 232zM256 304L224 304C206.3 304 192 318.3 192 336L192 384C192 410.5 213.5 432 240 432C266.5 432 288 410.5 288 384L288 336C288 318.3 273.7 304 256 304zM240 368C248.8 368 256 375.2 256 384C256 392.8 248.8 400 240 400C231.2 400 224 392.8 224 384C224 375.2 231.2 368 240 368z"/></svg>',"grip-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M128 40c0-22.1-17.9-40-40-40L40 0C17.9 0 0 17.9 0 40L0 88c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM0 424l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 40c0-22.1-17.9-40-40-40L232 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM192 232l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 424c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48z"/></svg>',indeterminate:'<svg part="indeterminate-icon" class="icon" viewBox="0 0 16 16"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"><g stroke="currentColor" stroke-width="2"><g transform="translate(2.285714 6.857143)"><path d="M10.2857143,1.14285714 L1.14285714,1.14285714"/></g></g></g></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80L0 432c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48L48 32zm224 0c-26.5 0-48 21.5-48 48l0 352c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48l-64 0z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M91.2 36.9c-12.4-6.8-27.4-6.5-39.6 .7S32 57.9 32 72l0 368c0 14.1 7.5 27.2 19.6 34.4s27.2 7.5 39.6 .7l336-184c12.8-7 20.8-20.5 20.8-35.1s-8-28.1-20.8-35.1l-336-184z"/></svg>',plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M352 128C352 110.3 337.7 96 320 96C302.3 96 288 110.3 288 128L288 288L128 288C110.3 288 96 302.3 96 320C96 337.7 110.3 352 128 352L288 352L288 512C288 529.7 302.3 544 320 544C337.7 544 352 529.7 352 512L352 352L512 352C529.7 352 544 337.7 544 320C544 302.3 529.7 288 512 288L352 288L352 128z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg>',upload:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill="currentColor" d="M352 173.3L352 384C352 401.7 337.7 416 320 416C302.3 416 288 401.7 288 384L288 173.3L246.6 214.7C234.1 227.2 213.8 227.2 201.3 214.7C188.8 202.2 188.8 181.9 201.3 169.4L297.3 73.4C309.8 60.9 330.1 60.9 342.6 73.4L438.6 169.4C451.1 181.9 451.1 202.2 438.6 214.7C426.1 227.2 405.8 227.2 393.3 214.7L352 173.3zM320 464C364.2 464 400 428.2 400 384L480 384C515.3 384 544 412.7 544 448L544 480C544 515.3 515.3 544 480 544L160 544C124.7 544 96 515.3 96 480L96 448C96 412.7 124.7 384 160 384L240 384C240 428.2 275.8 464 320 464zM464 488C477.3 488 488 477.3 488 464C488 450.7 477.3 440 464 440C450.7 440 440 450.7 440 464C440 477.3 450.7 488 464 488z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M224 248a120 120 0 1 0 0-240 120 120 0 1 0 0 240zm-29.7 56C95.8 304 16 383.8 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3l-59.4 0z"/></svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M55.1 73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L147.2 256 9.9 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192.5 301.3 329.9 438.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.8 256 375.1 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192.5 210.7 55.1 73.4z"/></svg>'},regular:{"circle-question":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M464 256a208 208 0 1 0 -416 0 208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0zm256-80c-17.7 0-32 14.3-32 32 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-44.2 35.8-80 80-80s80 35.8 80 80c0 47.2-36 67.2-56 74.5l0 3.8c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-8.1c0-20.5 14.8-35.2 30.1-40.2 6.4-2.1 13.2-5.5 18.2-10.3 4.3-4.2 7.7-10 7.7-19.6 0-17.7-14.3-32-32-32zM224 368a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>',"circle-xmark":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c-9.4 9.4-9.4 24.6 0 33.9l55 55-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l55-55 55 55c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55 55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-55 55-55-55c-9.4-9.4-24.6-9.4-33.9 0z"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l58.5 58.5c3 3 4.7 7.1 4.7 11.3L400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-197.5c0-17-6.7-33.3-18.7-45.3L370.7 18.7C358.7 6.7 342.5 0 325.5 0L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-48 0 0 16c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l16 0 0-48-16 0z"/></svg>',eye:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/></svg>',"eye-slash":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM176.9 111.1c32.1-18.9 69.2-31.1 111.1-31.1 65.2 0 118.8 29.6 159.9 67.7 38.5 35.7 65.1 78.3 78.6 108.3-13.6 30-40.2 72.5-78.6 108.3-3.1 2.8-6.2 5.6-9.4 8.4L393.8 328c14-20.5 22.2-45.3 22.2-72 0-70.7-57.3-128-128-128-26.7 0-51.5 8.2-72 22.2l-39.1-39.1zm182 182l-108-108c11.1-5.8 23.7-9.1 37.1-9.1 44.2 0 80 35.8 80 80 0 13.4-3.3 26-9.1 37.1zM103.4 173.2l-34-34c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6L352.2 422c-20 6.4-41.4 10-64.2 10-65.2 0-118.8-29.6-159.9-67.7-38.5-35.7-65.1-78.3-78.6-108.3 10.4-23.1 28.6-53.6 54-82.8z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288.1-32c9 0 17.3 5.1 21.4 13.1L383 125.3 542.9 150.7c8.9 1.4 16.3 7.7 19.1 16.3s.5 18-5.8 24.4L441.7 305.9 467 465.8c1.4 8.9-2.3 17.9-9.6 23.2s-17 6.1-25 2L288.1 417.6 143.8 491c-8 4.1-17.7 3.3-25-2s-11-14.2-9.6-23.2L134.4 305.9 20 191.4c-6.4-6.4-8.6-15.8-5.8-24.4s10.1-14.9 19.1-16.3l159.9-25.4 73.6-144.2c4.1-8 12.4-13.1 21.4-13.1zm0 76.8L230.3 158c-3.5 6.8-10 11.6-17.6 12.8l-125.5 20 89.8 89.9c5.4 5.4 7.9 13.1 6.7 20.7l-19.8 125.5 113.3-57.6c6.8-3.5 14.9-3.5 21.8 0l113.3 57.6-19.8-125.5c-1.2-7.6 1.3-15.3 6.7-20.7l89.8-89.9-125.5-20c-7.6-1.2-14.1-6-17.6-12.8L288.1 44.8z"/></svg>'}},qr={name:"system",resolver:(t,e="classic",o="solid")=>{let r=Rt[o][t]??Rt.regular[t]??Rt.regular["circle-question"];return r?Ur(r):""}},Kr=qr;var Wt="";function Hr(t){Wt=t}function jr(){if(!Wt){const t=document.querySelector("[data-fa-kit-code]");t&&Hr(t.getAttribute("data-fa-kit-code")||"")}return Wt}var $o="7.1.0";function Vr(t,e,o){const s=jr(),r=s.length>0;let i="solid";return e==="notdog"&&(o==="solid"&&(i="notdog-solid"),o==="duo-solid"&&(i="notdog-duo-solid")),e==="notdog-duo"&&(i="notdog-duo-solid"),e==="chisel"&&(i="chisel-regular"),e==="etch"&&(i="etch-solid"),e==="jelly"&&(i="jelly-regular",o==="duo-regular"&&(i="jelly-duo-regular"),o==="fill-regular"&&(i="jelly-fill-regular")),e==="jelly-duo"&&(i="jelly-duo-regular"),e==="jelly-fill"&&(i="jelly-fill-regular"),e==="slab"&&((o==="solid"||o==="regular")&&(i="slab-regular"),o==="press-regular"&&(i="slab-press-regular")),e==="slab-press"&&(i="slab-press-regular"),e==="thumbprint"&&(i="thumbprint-light"),e==="whiteboard"&&(i="whiteboard-semibold"),e==="utility"&&(i="utility-semibold"),e==="utility-duo"&&(i="utility-duo-semibold"),e==="utility-fill"&&(i="utility-fill-semibold"),e==="classic"&&(o==="thin"&&(i="thin"),o==="light"&&(i="light"),o==="regular"&&(i="regular"),o==="solid"&&(i="solid")),e==="sharp"&&(o==="thin"&&(i="sharp-thin"),o==="light"&&(i="sharp-light"),o==="regular"&&(i="sharp-regular"),o==="solid"&&(i="sharp-solid")),e==="duotone"&&(o==="thin"&&(i="duotone-thin"),o==="light"&&(i="duotone-light"),o==="regular"&&(i="duotone-regular"),o==="solid"&&(i="duotone")),e==="sharp-duotone"&&(o==="thin"&&(i="sharp-duotone-thin"),o==="light"&&(i="sharp-duotone-light"),o==="regular"&&(i="sharp-duotone-regular"),o==="solid"&&(i="sharp-duotone-solid")),e==="brands"&&(i="brands"),r?`https://ka-p.fontawesome.com/releases/v${$o}/svgs/${i}/${t}.svg?token=${encodeURIComponent(s)}`:`https://ka-f.fontawesome.com/releases/v${$o}/svgs/${i}/${t}.svg`}var Wr={name:"default",resolver:(t,e="classic",o="solid")=>Vr(t,e,o),mutator:(t,e)=>{if(e?.family&&!t.hasAttribute("data-duotone-initialized")){const{family:o,variant:s}=e;if(o==="duotone"||o==="sharp-duotone"||o==="notdog-duo"||o==="notdog"&&s==="duo-solid"||o==="jelly-duo"||o==="jelly"&&s==="duo-regular"||o==="utility-duo"||o==="thumbprint"){const r=[...t.querySelectorAll("path")],i=r.find(l=>!l.hasAttribute("opacity")),a=r.find(l=>l.hasAttribute("opacity"));if(!i||!a)return;if(i.setAttribute("data-duotone-primary",""),a.setAttribute("data-duotone-secondary",""),e.swapOpacity&&i&&a){const l=a.getAttribute("opacity")||"0.4";i.style.setProperty("--path-opacity",l),a.style.setProperty("--path-opacity","1")}t.setAttribute("data-duotone-initialized","")}}}},Gr=Wr;var Jr="classic",Qr=[Gr,Kr],Gt=[];function Xr(t){Gt.push(t)}function Yr(t){Gt=Gt.filter(e=>e!==t)}function Ft(t){return Qr.find(e=>e.name===t)}function Zr(){return Jr}const ei=(t,e)=>t?._$litType$!==void 0;var Ue=Symbol(),it=Symbol(),Ut,qt=new Map,q=class extends ee{constructor(){super(...arguments),this.svg=null,this.autoWidth=!1,this.swapOpacity=!1,this.label="",this.library="default",this.rotate=0,this.resolveIcon=async(t,e)=>{let o;if(e?.spriteSheet){this.hasUpdated||await this.updateComplete,this.svg=W`<svg part="svg">
        <use part="use" href="${t}"></use>
      </svg>`,await this.updateComplete;const s=this.shadowRoot.querySelector("[part='svg']");return typeof e.mutator=="function"&&e.mutator(s,this),this.svg}try{if(o=await fetch(t,{mode:"cors"}),!o.ok)return o.status===410?Ue:it}catch{return it}try{const s=document.createElement("div");s.innerHTML=await o.text();const r=s.firstElementChild;if(r?.tagName?.toLowerCase()!=="svg")return Ue;Ut||(Ut=new DOMParser);const a=Ut.parseFromString(r.outerHTML,"text/html").body.querySelector("svg");return a?(a.part.add("svg"),document.adoptNode(a)):Ue}catch{return Ue}}}connectedCallback(){super.connectedCallback(),Xr(this)}firstUpdated(t){super.firstUpdated(t),this.hasAttribute("rotate")&&this.style.setProperty("--rotate-angle",`${this.rotate}deg`),this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),Yr(this)}getIconSource(){const t=Ft(this.library),e=this.family||Zr();return this.name&&t?{url:t.resolver(this.name,e,this.variant,this.autoWidth),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){const{url:t,fromLibrary:e}=this.getIconSource(),o=e?Ft(this.library):void 0;if(!t){this.svg=null;return}let s=qt.get(t);s||(s=this.resolveIcon(t,o),qt.set(t,s));const r=await s;if(r===it&&qt.delete(t),t===this.getIconSource().url){if(ei(r)){this.svg=r;return}switch(r){case it:case Ue:this.svg=null,this.dispatchEvent(new zr);break;default:this.svg=r.cloneNode(!0),o?.mutator?.(this.svg,this),this.dispatchEvent(new Rr)}}}updated(t){super.updated(t);const e=Ft(this.library);this.hasAttribute("rotate")&&this.style.setProperty("--rotate-angle",`${this.rotate}deg`);const o=this.shadowRoot?.querySelector("svg");o&&e?.mutator?.(o,this)}render(){return this.hasUpdated?this.svg:W`<svg part="svg" width="16" height="16"></svg>`}};q.css=Fr;w([Pt()],q.prototype,"svg",2);w([L({reflect:!0})],q.prototype,"name",2);w([L({reflect:!0})],q.prototype,"family",2);w([L({reflect:!0})],q.prototype,"variant",2);w([L({attribute:"auto-width",type:Boolean,reflect:!0})],q.prototype,"autoWidth",2);w([L({attribute:"swap-opacity",type:Boolean,reflect:!0})],q.prototype,"swapOpacity",2);w([L()],q.prototype,"src",2);w([L()],q.prototype,"label",2);w([L({reflect:!0})],q.prototype,"library",2);w([L({type:Number,reflect:!0})],q.prototype,"rotate",2);w([L({type:String,reflect:!0})],q.prototype,"flip",2);w([L({type:String,reflect:!0})],q.prototype,"animation",2);w([ae("label")],q.prototype,"handleLabelChange",1);w([ae(["family","name","library","variant","src","autoWidth","swapOpacity"],{waitUntilFirstUpdate:!0})],q.prototype,"setIcon",1);q=w([Le("wa-icon")],q);var ti=class extends Event{constructor(t){super("wa-tab-hide",{bubbles:!0,cancelable:!1,composed:!0}),this.detail=t}};var oi=class extends Event{constructor(t){super("wa-tab-show",{bubbles:!0,cancelable:!1,composed:!0}),this.detail=t}};var si=Z`
  :host {
    --indicator-color: var(--wa-color-brand-fill-loud);
    --track-color: var(--wa-color-neutral-fill-normal);
    --track-width: 0.125rem;

    /* Private */
    --safe-track-width: max(0.5px, round(var(--track-width), 0.5px));

    display: block;
  }

  .tab-group {
    display: flex;
    border-radius: 0;
  }

  .tabs {
    display: flex;
    position: relative;
  }

  .indicator {
    position: absolute;
  }

  .tab-group-has-scroll-controls .nav-container {
    position: relative;
    padding: 0 1.5em;
  }

  .body {
    display: block;
  }

  .scroll-button {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    bottom: 0;
    width: 1.5em;
  }

  .scroll-button-start {
    inset-inline-start: 0;
  }

  .scroll-button-end {
    inset-inline-end: 0;
  }

  /*
    * Top
    */

  .tab-group-top {
    flex-direction: column;
  }

  .tab-group-top .nav-container {
    order: 1;
  }

  .tab-group-top .nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group-top .nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group-top .tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-bottom: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-top .indicator {
    bottom: calc(-1 * var(--safe-track-width));
    border-bottom: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-top .body {
    order: 2;
  }

  .tab-group-top ::slotted(wa-tab[active]) {
    border-block-end: solid var(--safe-track-width) var(--indicator-color);
    margin-block-end: calc(-1 * var(--safe-track-width));
  }

  .tab-group-top ::slotted(wa-tab-panel) {
    --padding: var(--wa-space-xl) 0;
  }

  /*
    * Bottom
    */

  .tab-group-bottom {
    flex-direction: column;
  }

  .tab-group-bottom .nav-container {
    order: 2;
  }

  .tab-group-bottom .nav {
    display: flex;
    overflow-x: auto;

    /* Hide scrollbar in Firefox */
    scrollbar-width: none;
  }

  /* Hide scrollbar in Chrome/Safari */
  .tab-group-bottom .nav::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .tab-group-bottom .tabs {
    flex: 1 1 auto;
    position: relative;
    flex-direction: row;
    border-top: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-bottom .indicator {
    top: calc(-1 * var(--safe-track-width));
    border-top: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-bottom .body {
    order: 1;
  }

  .tab-group-bottom ::slotted(wa-tab[active]) {
    border-block-start: solid var(--safe-track-width) var(--indicator-color);
    margin-block-start: calc(-1 * var(--safe-track-width));
  }

  .tab-group-bottom ::slotted(wa-tab-panel) {
    --padding: var(--wa-space-xl) 0;
  }

  /*
    * Start
    */

  .tab-group-start {
    flex-direction: row;
  }

  .tab-group-start .nav-container {
    order: 1;
  }

  .tab-group-start .tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-inline-end: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-start .indicator {
    inset-inline-end: calc(-1 * var(--safe-track-width));
    border-right: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-start .body {
    flex: 1 1 auto;
    order: 2;
  }

  .tab-group-start ::slotted(wa-tab[active]) {
    border-inline-end: solid var(--safe-track-width) var(--indicator-color);
    margin-inline-end: calc(-1 * var(--safe-track-width));
  }

  .tab-group-start ::slotted(wa-tab-panel) {
    --padding: 0 var(--wa-space-xl);
  }

  /*
    * End
    */

  .tab-group-end {
    flex-direction: row;
  }

  .tab-group-end .nav-container {
    order: 2;
  }

  .tab-group-end .tabs {
    flex: 0 0 auto;
    flex-direction: column;
    border-left: solid var(--safe-track-width) var(--track-color);
  }

  .tab-group-end .indicator {
    inset-inline-start: calc(-1 * var(--safe-track-width));
    border-inline-start: solid var(--safe-track-width) var(--indicator-color);
  }

  .tab-group-end .body {
    flex: 1 1 auto;
    order: 1;
  }

  .tab-group-end ::slotted(wa-tab[active]) {
    border-inline-start: solid var(--safe-track-width) var(--indicator-color);
    margin-inline-start: calc(-1 * var(--safe-track-width));
  }

  .tab-group-end ::slotted(wa-tab-panel) {
    --padding: 0 var(--wa-space-xl);
  }
`;function ri(t,e){return{top:Math.round(t.getBoundingClientRect().top-e.getBoundingClientRect().top),left:Math.round(t.getBoundingClientRect().left-e.getBoundingClientRect().left)}}var Jt=new Set;function ii(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function ai(){const t=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(t)||!t?0:t}function To(t){if(Jt.add(t),!document.documentElement.classList.contains("wa-scroll-lock")){const e=ii()+ai();let o=getComputedStyle(document.documentElement).scrollbarGutter;(!o||o==="auto")&&(o="stable"),e<2&&(o=""),document.documentElement.style.setProperty("--wa-scroll-lock-gutter",o),document.documentElement.classList.add("wa-scroll-lock"),document.documentElement.style.setProperty("--wa-scroll-lock-size",`${e}px`)}}function Oo(t){Jt.delete(t),Jt.size===0&&(document.documentElement.classList.remove("wa-scroll-lock"),document.documentElement.style.removeProperty("--wa-scroll-lock-size"))}function Do(t,e,o="vertical",s="smooth"){const r=ri(t,e),i=r.top+e.scrollTop,a=r.left+e.scrollLeft,l=e.scrollLeft,u=e.scrollLeft+e.offsetWidth,h=e.scrollTop,f=e.scrollTop+e.offsetHeight;(o==="horizontal"||o==="both")&&(a<l?e.scrollTo({left:a,behavior:s}):a+t.clientWidth>u&&e.scrollTo({left:a-e.offsetWidth+t.clientWidth,behavior:s})),(o==="vertical"||o==="both")&&(i<h?e.scrollTo({top:i,behavior:s}):i+t.clientHeight>f&&e.scrollTo({top:i-e.offsetHeight+t.clientHeight,behavior:s}))}var j=class extends ee{constructor(){super(...arguments),this.tabs=[],this.focusableTabs=[],this.panels=[],this.localize=new It(this),this.hasScrollControls=!1,this.active="",this.placement="top",this.activation="auto",this.withoutScrollControls=!1}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver(()=>{this.updateScrollControls()}),this.mutationObserver=new MutationObserver(t=>{t.some(o=>!["aria-labelledby","aria-controls"].includes(o.attributeName))&&setTimeout(()=>this.setAriaLabels());const e=t.filter(o=>o.target.closest("wa-tab-group")===this);if(e.some(o=>o.attributeName==="disabled"))this.syncTabsAndPanels();else if(e.some(o=>o.attributeName==="active")){const s=e.filter(r=>r.attributeName==="active"&&r.target.tagName.toLowerCase()==="wa-tab").map(r=>r.target).find(r=>r.active);s&&s.closest("wa-tab-group")===this&&this.setActiveTab(s)}}),this.updateComplete.then(()=>{this.syncTabsAndPanels(),this.mutationObserver.observe(this,{attributes:!0,childList:!0,subtree:!0}),this.resizeObserver.observe(this.nav),new IntersectionObserver((e,o)=>{if(e[0].intersectionRatio>0){if(this.setAriaLabels(),this.active){const s=this.tabs.find(r=>r.panel===this.active);s&&this.setActiveTab(s)}else this.setActiveTab(this.getActiveTab()??this.tabs[0],{emitEvents:!1});o.unobserve(e[0].target)}}).observe(this.tabGroup)})}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.nav&&this.resizeObserver?.unobserve(this.nav)}getAllTabs(){return[...this.shadowRoot.querySelector('slot[name="nav"]').assignedElements()].filter(e=>e.tagName.toLowerCase()==="wa-tab")}getAllPanels(){return[...this.body.assignedElements()].filter(t=>t.tagName.toLowerCase()==="wa-tab-panel")}getActiveTab(){return this.tabs.find(t=>t.active)}handleClick(t){const o=t.target.closest("wa-tab");o?.closest("wa-tab-group")===this&&o!==null&&this.setActiveTab(o,{scrollBehavior:"smooth"})}handleKeyDown(t){const o=t.target.closest("wa-tab");if(o?.closest("wa-tab-group")===this){if(["Enter"," "].includes(t.key)){o!==null&&(this.setActiveTab(o,{scrollBehavior:"smooth"}),t.preventDefault());return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(t.key)){const r=this.tabs.find(l=>l.matches(":focus")),i=this.localize.dir()==="rtl";let a=null;if(r?.tagName.toLowerCase()==="wa-tab"){if(t.key==="Home")a=this.focusableTabs[0];else if(t.key==="End")a=this.focusableTabs[this.focusableTabs.length-1];else if(["top","bottom"].includes(this.placement)&&t.key===(i?"ArrowRight":"ArrowLeft")||["start","end"].includes(this.placement)&&t.key==="ArrowUp"){const l=this.tabs.findIndex(u=>u===r);a=this.findNextFocusableTab(l,"backward")}else if(["top","bottom"].includes(this.placement)&&t.key===(i?"ArrowLeft":"ArrowRight")||["start","end"].includes(this.placement)&&t.key==="ArrowDown"){const l=this.tabs.findIndex(u=>u===r);a=this.findNextFocusableTab(l,"forward")}if(!a)return;a.tabIndex=0,a.focus({preventScroll:!0}),this.activation==="auto"?this.setActiveTab(a,{scrollBehavior:"smooth"}):this.tabs.forEach(l=>{l.tabIndex=l===a?0:-1}),["top","bottom"].includes(this.placement)&&Do(a,this.nav,"horizontal"),t.preventDefault()}}}}findNextFocusableTab(t,e){let o=null;const s=e==="forward"?1:-1;let r=t+s;for(;t<this.tabs.length;){if(o=this.tabs[r]||null,o===null){e==="forward"?o=this.focusableTabs[0]:o=this.focusableTabs[this.focusableTabs.length-1];break}if(!o.disabled)break;r+=s}return o}handleScrollToStart(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft+this.nav.clientWidth:this.nav.scrollLeft-this.nav.clientWidth,behavior:"smooth"})}handleScrollToEnd(){this.nav.scroll({left:this.localize.dir()==="rtl"?this.nav.scrollLeft-this.nav.clientWidth:this.nav.scrollLeft+this.nav.clientWidth,behavior:"smooth"})}setActiveTab(t,e){if(e={emitEvents:!0,scrollBehavior:"auto",...e},t.closest("wa-tab-group")===this&&t!==this.activeTab&&!t.disabled){const o=this.activeTab;this.active=t.panel,this.activeTab=t,this.tabs.forEach(s=>{s.active=s===this.activeTab,s.tabIndex=s===this.activeTab?0:-1}),this.panels.forEach(s=>s.active=s.name===this.activeTab?.panel),["top","bottom"].includes(this.placement)&&Do(this.activeTab,this.nav,"horizontal",e.scrollBehavior),e.emitEvents&&(o&&this.dispatchEvent(new ti({name:o.panel})),this.dispatchEvent(new oi({name:this.activeTab.panel})))}}setAriaLabels(){this.tabs.forEach(t=>{const e=this.panels.find(o=>o.name===t.panel);e&&(t.setAttribute("aria-controls",e.getAttribute("id")),e.setAttribute("aria-labelledby",t.getAttribute("id")))})}syncTabsAndPanels(){this.tabs=this.getAllTabs(),this.focusableTabs=this.tabs.filter(t=>!t.disabled),this.panels=this.getAllPanels(),this.updateComplete.then(()=>this.updateScrollControls())}updateActiveTab(){const t=this.tabs.find(e=>e.panel===this.active);t&&this.setActiveTab(t,{scrollBehavior:"smooth"})}updateScrollControls(){this.withoutScrollControls?this.hasScrollControls=!1:this.hasScrollControls=["top","bottom"].includes(this.placement)&&this.nav.scrollWidth>this.nav.clientWidth+1}render(){const t=this.hasUpdated?this.localize.dir()==="rtl":this.dir==="rtl";return W`
      <div
        part="base"
        class=${Ye({"tab-group":!0,"tab-group-top":this.placement==="top","tab-group-bottom":this.placement==="bottom","tab-group-start":this.placement==="start","tab-group-end":this.placement==="end","tab-group-has-scroll-controls":this.hasScrollControls})}
        @click=${this.handleClick}
        @keydown=${this.handleKeyDown}
      >
        <div class="nav-container" part="nav">
          ${this.hasScrollControls?W`
                <wa-button
                  part="scroll-button scroll-button-start"
                  exportparts="base:scroll-button__base"
                  class="scroll-button scroll-button-start"
                  appearance="plain"
                  @click=${this.handleScrollToStart}
                >
                  <wa-icon
                    name=${t?"chevron-right":"chevron-left"}
                    library="system"
                    variant="solid"
                    label=${this.localize.term("scrollToStart")}
                  ></wa-icon>
                </wa-button>
              `:""}

          <!-- We have a focus listener because in Firefox (and soon to be Chrome) overflow containers are focusable. -->
          <div class="nav" @focus=${()=>this.activeTab?.focus({preventScroll:!0})}>
            <div part="tabs" class="tabs" role="tablist">
              <slot name="nav" @slotchange=${this.syncTabsAndPanels}></slot>
            </div>
          </div>

          ${this.hasScrollControls?W`
                <wa-button
                  part="scroll-button scroll-button-end"
                  class="scroll-button scroll-button-end"
                  exportparts="base:scroll-button__base"
                  appearance="plain"
                  @click=${this.handleScrollToEnd}
                >
                  <wa-icon
                    name=${t?"chevron-left":"chevron-right"}
                    library="system"
                    variant="solid"
                    label=${this.localize.term("scrollToEnd")}
                  ></wa-icon>
                </wa-button>
              `:""}
        </div>

        <slot part="body" class="body" @slotchange=${this.syncTabsAndPanels}></slot>
      </div>
    `}};j.css=si;w([Ee(".tab-group")],j.prototype,"tabGroup",2);w([Ee(".body")],j.prototype,"body",2);w([Ee(".nav")],j.prototype,"nav",2);w([Pt()],j.prototype,"hasScrollControls",2);w([L({reflect:!0})],j.prototype,"active",2);w([L()],j.prototype,"placement",2);w([L()],j.prototype,"activation",2);w([L({attribute:"without-scroll-controls",type:Boolean})],j.prototype,"withoutScrollControls",2);w([ae("active")],j.prototype,"updateActiveTab",1);w([ae("withoutScrollControls",{waitUntilFirstUpdate:!0})],j.prototype,"updateScrollControls",1);j=w([Le("wa-tab-group")],j);var ni=Z`
  :host {
    display: inline-block;
    color: var(--wa-color-neutral-on-quiet);
    font-weight: var(--wa-font-weight-action);
  }

  .tab {
    display: inline-flex;
    align-items: center;
    font: inherit;
    padding: 1em 1.5em;
    white-space: nowrap;
    user-select: none;
    -webkit-user-select: none;
    cursor: pointer;
    transition: color var(--wa-transition-fast) var(--wa-transition-easing);

    ::slotted(wa-icon:first-child) {
      margin-inline-end: 0.5em;
    }

    ::slotted(wa-icon:last-child) {
      margin-inline-start: 0.5em;
    }
  }

  @media (hover: hover) {
    :host(:hover:not([disabled])) .tab {
      color: currentColor;
    }
  }

  :host(:focus) {
    outline: transparent;
  }

  :host(:focus-visible) .tab {
    outline: var(--wa-focus-ring);
    outline-offset: calc(-1 * var(--wa-border-width-l) - var(--wa-focus-ring-offset));
  }

  :host([active]:not([disabled])) {
    color: var(--wa-color-brand-on-quiet);
  }

  :host([disabled]) .tab {
    opacity: 0.5;
    cursor: not-allowed;
  }

  @media (forced-colors: active) {
    :host([active]:not([disabled])) {
      outline: solid 1px transparent;
      outline-offset: -3px;
    }
  }
`;var ci=0,Y=class extends ee{constructor(){super(...arguments),this.attrId=++ci,this.componentId=`wa-tab-${this.attrId}`,this.panel="",this.active=!1,this.disabled=!1,this.tabIndex=0}connectedCallback(){this.slot||(this.slot="nav"),super.connectedCallback(),this.setAttribute("role","tab")}handleActiveChange(){this.setAttribute("aria-selected",this.active?"true":"false")}handleDisabledChange(){this.setAttribute("aria-disabled",this.disabled?"true":"false"),this.disabled&&!this.active?this.tabIndex=-1:this.tabIndex=0}render(){return this.id=this.id?.length>0?this.id:this.componentId,W`
      <div
        part="base"
        class=${Ye({tab:!0,"tab-active":this.active})}
      >
        <slot></slot>
      </div>
    `}};Y.css=ni;w([Ee(".tab")],Y.prototype,"tab",2);w([L({reflect:!0})],Y.prototype,"panel",2);w([L({type:Boolean,reflect:!0})],Y.prototype,"active",2);w([L({type:Boolean,reflect:!0})],Y.prototype,"disabled",2);w([L({type:Number,reflect:!0})],Y.prototype,"tabIndex",2);w([ae("active")],Y.prototype,"handleActiveChange",1);w([ae("disabled")],Y.prototype,"handleDisabledChange",1);Y=w([Le("wa-tab")],Y);var li=Z`
  :host {
    --padding: 0;

    display: none;
  }

  :host([active]) {
    display: block;
  }

  .tab-panel {
    display: block;
    padding: var(--padding);
  }
`;var di=0,Be=class extends ee{constructor(){super(...arguments),this.attrId=++di,this.componentId=`wa-tab-panel-${this.attrId}`,this.name="",this.active=!1}connectedCallback(){super.connectedCallback(),this.id=this.id.length>0?this.id:this.componentId,this.setAttribute("role","tabpanel")}handleActiveChange(){this.setAttribute("aria-hidden",this.active?"false":"true")}render(){return W`
      <slot
        part="base"
        class=${Ye({"tab-panel":!0,"tab-panel-active":this.active})}
      ></slot>
    `}};Be.css=li;w([L({reflect:!0})],Be.prototype,"name",2);w([L({type:Boolean,reflect:!0})],Be.prototype,"active",2);w([ae("active")],Be.prototype,"handleActiveChange",1);Be=w([Le("wa-tab-panel")],Be);var ui=Z`
  :host {
    --width: 31rem;
    --spacing: var(--wa-space-l);
    --show-duration: 200ms;
    --hide-duration: 200ms;

    display: none;
  }

  :host([open]) {
    display: block;
  }

  .dialog {
    display: flex;
    flex-direction: column;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    width: var(--width);
    max-width: calc(100% - var(--wa-space-2xl));
    max-height: calc(100% - var(--wa-space-2xl));
    background-color: var(--wa-color-surface-raised);
    border-radius: var(--wa-panel-border-radius);
    border: none;
    box-shadow: var(--wa-shadow-l);
    padding: 0;
    margin: auto;

    &.show {
      animation: show-dialog var(--show-duration) ease;

      &::backdrop {
        animation: show-backdrop var(--show-duration, 200ms) ease;
      }
    }

    &.hide {
      animation: show-dialog var(--hide-duration) ease reverse;

      &::backdrop {
        animation: show-backdrop var(--hide-duration, 200ms) ease reverse;
      }
    }

    &.pulse {
      animation: pulse 250ms ease;
    }
  }

  .dialog:focus {
    outline: none;
  }

  /* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
  @media screen and (max-width: 420px) {
    .dialog {
      max-height: 80vh;
    }
  }

  .open {
    display: flex;
    opacity: 1;
  }

  .header {
    flex: 0 0 auto;
    display: flex;
    flex-wrap: nowrap;

    padding-inline-start: var(--spacing);
    padding-block-end: 0;

    /* Subtract the close button's padding so that the X is visually aligned with the edges of the dialog content */
    padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));
    padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));
  }

  .title {
    align-self: center;
    flex: 1 1 auto;
    font-family: inherit;
    font-size: var(--wa-font-size-l);
    font-weight: var(--wa-font-weight-heading);
    line-height: var(--wa-line-height-condensed);
    margin: 0;
  }

  .header-actions {
    align-self: start;
    display: flex;
    flex-shrink: 0;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--wa-space-2xs);
    padding-inline-start: var(--spacing);
  }

  .header-actions wa-button,
  .header-actions ::slotted(wa-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
  }

  .body {
    flex: 1 1 auto;
    display: block;
    padding: var(--spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;

    &:focus {
      outline: none;
    }

    &:focus-visible {
      outline: var(--wa-focus-ring);
      outline-offset: var(--wa-focus-ring-offset);
    }
  }

  .footer {
    flex: 0 0 auto;
    display: flex;
    flex-wrap: wrap;
    gap: var(--wa-space-xs);
    justify-content: end;
    padding: var(--spacing);
    padding-block-start: 0;
  }

  .footer ::slotted(wa-button:not(:first-of-type)) {
    margin-inline-start: var(--wa-spacing-xs);
  }

  .dialog::backdrop {
    /*
      NOTE: the ::backdrop element doesn't inherit properly in Safari yet, but it will in 17.4! At that time, we can
      remove the fallback values here.
    */
    background-color: var(--wa-color-overlay-modal, rgb(0 0 0 / 0.25));
  }

  @keyframes pulse {
    0% {
      scale: 1;
    }
    50% {
      scale: 1.02;
    }
    100% {
      scale: 1;
    }
  }

  @keyframes show-dialog {
    from {
      opacity: 0;
      scale: 0.8;
    }
    to {
      opacity: 1;
      scale: 1;
    }
  }

  @keyframes show-backdrop {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @media (forced-colors: active) {
    .dialog {
      border: solid 1px white;
    }
  }
`;function mi(t){return t.split(" ").map(e=>e.trim()).filter(e=>e!=="")}var pi=class extends Event{constructor(){super("wa-show",{bubbles:!0,cancelable:!0,composed:!0})}};var _i=class extends Event{constructor(t){super("wa-hide",{bubbles:!0,cancelable:!0,composed:!0}),this.detail=t}};var gi=class extends Event{constructor(){super("wa-after-hide",{bubbles:!0,cancelable:!1,composed:!0})}};var hi=class extends Event{constructor(){super("wa-after-show",{bubbles:!0,cancelable:!1,composed:!0})}};function at(t,e){return new Promise(o=>{const s=new AbortController,{signal:r}=s;if(t.classList.contains(e))return;t.classList.remove(e),t.classList.add(e);let i=()=>{t.classList.remove(e),o(),s.abort()};t.addEventListener("animationend",i,{once:!0,signal:r}),t.addEventListener("animationcancel",i,{once:!0,signal:r})})}var re=class extends ee{constructor(){super(...arguments),this.localize=new It(this),this.hasSlotController=new ts(this,"footer","header-actions","label"),this.open=!1,this.label="",this.withoutHeader=!1,this.lightDismiss=!1,this.handleDocumentKeyDown=t=>{t.key==="Escape"&&this.open&&(t.preventDefault(),t.stopPropagation(),this.requestClose(this.dialog))}}firstUpdated(){this.open&&(this.addOpenListeners(),this.dialog.showModal(),To(this))}disconnectedCallback(){super.disconnectedCallback(),Oo(this),this.removeOpenListeners()}async requestClose(t){const e=new _i({source:t});if(this.dispatchEvent(e),e.defaultPrevented){this.open=!0,at(this.dialog,"pulse");return}this.removeOpenListeners(),await at(this.dialog,"hide"),this.open=!1,this.dialog.close(),Oo(this);const o=this.originalTrigger;typeof o?.focus=="function"&&setTimeout(()=>o.focus()),this.dispatchEvent(new gi)}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}handleDialogCancel(t){t.preventDefault(),!this.dialog.classList.contains("hide")&&t.target===this.dialog&&this.requestClose(this.dialog)}handleDialogClick(t){const o=t.target.closest('[data-dialog="close"]');o&&(t.stopPropagation(),this.requestClose(o))}async handleDialogPointerDown(t){t.target===this.dialog&&(this.lightDismiss?this.requestClose(this.dialog):await at(this.dialog,"pulse"))}handleOpenChange(){this.open&&!this.dialog.open?this.show():!this.open&&this.dialog.open&&(this.open=!0,this.requestClose(this.dialog))}async show(){const t=new pi;if(this.dispatchEvent(t),t.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.originalTrigger=document.activeElement,this.open=!0,this.dialog.showModal(),To(this),requestAnimationFrame(()=>{const e=this.querySelector("[autofocus]");e&&typeof e.focus=="function"?e.focus():this.dialog.focus()}),await at(this.dialog,"show"),this.dispatchEvent(new hi)}render(){const t=!this.withoutHeader,e=this.hasSlotController.test("footer");return W`
      <dialog
        part="dialog"
        class=${Ye({dialog:!0,open:this.open})}
        @cancel=${this.handleDialogCancel}
        @click=${this.handleDialogClick}
        @pointerdown=${this.handleDialogPointerDown}
      >
        ${t?W`
              <header part="header" class="header">
                <h2 part="title" class="title" id="title">
                  <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                  <slot name="label"> ${this.label.length>0?this.label:"​"} </slot>
                </h2>
                <div part="header-actions" class="header-actions">
                  <slot name="header-actions"></slot>
                  <wa-button
                    part="close-button"
                    exportparts="base:close-button__base"
                    class="close"
                    appearance="plain"
                    @click="${o=>this.requestClose(o.target)}"
                  >
                    <wa-icon
                      name="xmark"
                      label=${this.localize.term("close")}
                      library="system"
                      variant="solid"
                    ></wa-icon>
                  </wa-button>
                </div>
              </header>
            `:""}

        <div part="body" class="body"><slot></slot></div>

        ${e?W`
              <footer part="footer" class="footer">
                <slot name="footer"></slot>
              </footer>
            `:""}
      </dialog>
    `}};re.css=ui;w([Ee(".dialog")],re.prototype,"dialog",2);w([L({type:Boolean,reflect:!0})],re.prototype,"open",2);w([L({reflect:!0})],re.prototype,"label",2);w([L({attribute:"without-header",type:Boolean,reflect:!0})],re.prototype,"withoutHeader",2);w([L({attribute:"light-dismiss",type:Boolean})],re.prototype,"lightDismiss",2);w([ae("open",{waitUntilFirstUpdate:!0})],re.prototype,"handleOpenChange",1);re=w([Le("wa-dialog")],re);document.addEventListener("click",t=>{const e=t.target.closest("[data-dialog]");if(e instanceof Element){const[o,s]=mi(e.getAttribute("data-dialog")||"");if(o==="open"&&s?.length){const i=e.getRootNode().getElementById(s);i?.localName==="wa-dialog"?i.open=!0:console.warn(`A dialog with an ID of "${s}" could not be found in this document.`)}}});document.addEventListener("pointerdown",()=>{});const fi=50,ns=["adminUsers","adminUsersKeys","adminUsersPermissions"],M={baseUrls:"simple_front.base_urls",apiKeys:"simple_front.api_keys",accountIds:"simple_front.account_ids",strategyIds:"simple_front.strategy_ids",language:"simple_front.language",themeMode:"simple_front.theme_mode",densityMode:"simple_front.density_mode",activeMenu:"simple_front.active_menu"},m={wsConnections:new Map,pingTimer:null,connected:!1,eventSeq:0,uiLogSeq:0,tables:{},availableAccountIds:[],accountLabels:new Map,accountExchanges:new Map,subscribedAccountIds:[],locale:"pt-BR",userRole:"",themeMode:"system",densityMode:"normal",postTradingLastPreview:null,adminOmsView:"open_orders",closeBySourceRow:null,omsPageSize:100,omsLocalData:{openPositions:[],openOrders:[],symbolsList:[],adminAccounts:[]},adminLocalData:{adminUsers:[],adminUsersKeys:[],adminUsersPermissions:[]},omsPager:{openPositions:{page:1,pageSize:100,total:0,totalPages:1},openOrders:{page:1,pageSize:100,total:0,totalPages:1},symbolsList:{page:1,pageSize:100,total:0,totalPages:1},deals:{page:1,pageSize:100,total:0,totalPages:1},historyPositions:{page:1,pageSize:100,total:0,totalPages:1},historyOrders:{page:1,pageSize:100,total:0,totalPages:1},ccxtOrders:{page:1,pageSize:100,total:0,totalPages:1},ccxtTrades:{page:1,pageSize:100,total:0,totalPages:1},postTrading:{page:1,pageSize:100,total:0,totalPages:1},adminAccounts:{page:1,pageSize:100,total:0,totalPages:1},adminOms:{page:1,pageSize:100,total:0,totalPages:1}},adminPager:{adminUsers:{page:1,pageSize:20,total:0,totalPages:1},adminUsersKeys:{page:1,pageSize:20,total:0,totalPages:1},adminUsersPermissions:{page:1,pageSize:20,total:0,totalPages:1}}},bt={decimalPlaces:14,smartSteps:[14,5,2,0]};function ce(t){if(t==null)return"";const e=String(t).trim();if(!e)return"";const o=Number(e);if(!Number.isFinite(o))return e;const s=Math.max(0,Number(bt.decimalPlaces)||14),r=10**-s;if(Math.abs(o)<r)return"0";const i=(y,S)=>Number(y.toFixed(S)),a=(y,S)=>{const $=y.toFixed(S).replace(/\.?0+$/,"");return $==="-0"?"0":$},l=i(o,s),u=new Set,h=[];for(const y of bt.smartSteps||[]){const S=Math.max(0,Number(y)||0);u.has(S)||(u.add(S),h.push(S))}u.has(s)||h.unshift(s);let f=s;for(const y of h)i(o,y)===l&&(f=y);return a(o,f)}const V={dbName:"ccxt_oms_ui_logs",storeName:"ui_logs",version:1,maxRows:null},yi={"pt-BR":"Português (Brasil)","en-US":"English (US)",es:"Español"};function d(t){const e=document.getElementById(t);if(!e)throw new Error(`missing element ${t}`);return e}function se(t){try{const e=localStorage.getItem(t),o=e?JSON.parse(e):[];return Array.isArray(o)?o:[]}catch{return[]}}function be(t,e){if(!e)return;const o=se(t).filter(s=>String(s)!==String(e));o.unshift(e),localStorage.setItem(t,JSON.stringify(o.slice(0,fi)))}function He(t,e){const o=d(t);o.innerHTML="";for(const s of e){const r=document.createElement("option");r.value=String(s),o.appendChild(r)}}function bi(t){const e=d("accountHistory");e.innerHTML="";for(const o of t){const s=Number(o);if(!Number.isFinite(s)||s<=0)continue;const r=m.accountLabels.get(s)||"",i=document.createElement("option");i.value=String(s),r&&(i.label=`${s} - ${r}`,i.textContent=`${s} - ${r}`),e.appendChild(i)}}function ke(t,e=!1){const o=String(t||""),s=o&&`${o.charAt(0).toUpperCase()}${o.slice(1)}`,r=i=>{const a=document.getElementById(i);a&&(a.textContent=s,a.classList.toggle("status-connected",!!e),a.classList.toggle("status-idle",!e))};r("status"),r("loginStatus"),wi(!!e)}function wi(t){const e=document.getElementById("connectBtn"),o=document.getElementById("disconnectBtn");!e||!o||(e.classList.toggle("is-hidden",!!t),o.classList.toggle("is-hidden",!t))}function vi(t){return t==="dark"?"dark":t==="light"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function wt(t,e=!0){const o=["system","light","dark"].includes(String(t))?String(t):"system";m.themeMode=o;const s=vi(o);document.documentElement.setAttribute("data-theme",s);const r=document.getElementById("themeModeBtn");if(r){const i={"pt-BR":{system:"Sistema",light:"Claro",dark:"Escuro"},"en-US":{system:"System",light:"Light",dark:"Dark"},es:{system:"Sistema",light:"Claro",dark:"Oscuro"}},a=i[m.locale]||i["en-US"],l={system:{iconHtml:'<span class="theme-icon-dual" aria-hidden="true"><i class="fa-solid fa-sun"></i><span>/</span><i class="fa-solid fa-moon"></i></span>',text:a.system},light:{iconHtml:'<i class="fa-solid fa-sun" aria-hidden="true"></i>',text:a.light},dark:{iconHtml:'<i class="fa-solid fa-moon" aria-hidden="true"></i>',text:a.dark}},u=l[o]||l.system;r.innerHTML=`${u.iconHtml}<span>${u.text}</span>`;const h=m.locale==="pt-BR"||m.locale==="es"?"Tema":"Theme";r.setAttribute("title",`${h}: ${u.text}`)}e&&localStorage.setItem(M.themeMode,o)}function Si(){const t=["system","light","dark"],e=t.indexOf(m.themeMode),o=t[(e+1)%t.length];wt(o,!0)}function $t(t,e=!0){const o=["compact","normal","spacious"].includes(String(t))?String(t):"normal";m.densityMode=o,document.documentElement.setAttribute("data-density",o);const s=document.getElementById("densityModeBtn");if(s){const r={compact:"fa-table-cells",normal:"fa-table-cells-large",spacious:"fa-grip"},i=`density.${o}`,a=n(i,o),l=r[o]||r.normal;s.innerHTML=`<i class="fa-solid ${l}" aria-hidden="true"></i><span>${a}</span>`;const u=m.locale==="pt-BR"?"Densidade":m.locale==="es"?"Densidad":"Density";s.setAttribute("title",`${u}: ${a}`)}e&&localStorage.setItem(M.densityMode,o)}function ki(){const t=["compact","normal","spacious"],e=t.indexOf(m.densityMode),o=t[(e+1)%t.length];$t(o,!0)}function co(){return{baseUrl:d("baseUrl").value.trim().replace(/\/+$/,""),apiKey:d("apiKey").value.trim(),viewAccountIds:Pe()}}function C(){const t=co();if(!t.baseUrl)throw new Error("base_url is required");if(!t.apiKey)throw new Error("api_key is required");return t}function G(t){const o=String(t||"").trim().match(/^(\d+)\b/);if(!o)return null;const s=Number(o[1]);return Number.isFinite(s)&&s>0?s:null}function U(t,e){const o=G(d(t).value);if(!o)throw new Error(`${e} account_id is required`);return o}function vt(t){const e=Number(d(t).value||"0");return Number.isFinite(e)&&e>=0?e:0}function Pe(){const t=[...d("viewAccountsSelect").selectedOptions].map(e=>Number(e.value)).filter(e=>Number.isFinite(e)&&e>0);return[...new Set(t)]}function cs(t){const e=d("viewAccountsSelect"),o=new Set(Pe());e.innerHTML="";const s=new Map;for(const r of t){const i=String(m.accountExchanges.get(r)||"unknown");s.has(i)||s.set(i,[]),s.get(i).push(r)}for(const r of[...s.keys()].sort((i,a)=>i.localeCompare(a))){const i=document.createElement("optgroup");i.label=r;const a=s.get(r).sort((l,u)=>Number(l)-Number(u));for(const l of a){const u=document.createElement("option");u.value=String(l);const h=m.accountLabels.get(l)||"";u.textContent=h?`${l} - ${h}`:String(l),u.selected=o.has(l),i.appendChild(u)}e.appendChild(i)}}function ls(t){const e=d("tradeStrategyAccountIds"),o=new Set([...e.selectedOptions].map(s=>Number(s.value)));e.innerHTML="";for(const s of t){const r=document.createElement("option");r.value=String(s);const i=m.accountLabels.get(s)||"";r.textContent=i?`${s} - ${i}`:String(s),r.selected=o.has(s),e.appendChild(r)}}function Ai(t){const e=d("sendStrategyId"),o=String(e.value||"0");e.innerHTML="";const s=document.createElement("option");s.value="0",s.textContent="0 - sem strategy",e.appendChild(s);for(const r of t||[]){const i=Number(r.strategy_id);if(!Number.isFinite(i)||i<=0)continue;const a=document.createElement("option");a.value=String(i),a.textContent=`${i} - ${String(r.name||"").trim()||"strategy"}`,e.appendChild(a)}e.value=[...e.options].some(r=>r.value===o)?o:"0"}function Ci(t){const e=document.getElementById("adminUserOptions");if(!e)return;e.innerHTML="";let o=null;for(const r of t||[]){const i=Number(r&&r.user_id||0);if(!Number.isFinite(i)||i<=0)continue;const a=document.createElement("option");a.value=String(i);const l=String(r&&r.user_name||"").trim();a.textContent=l?`${i} - ${l}`:String(i),e.appendChild(a),o===null&&(o=i)}const s=document.getElementById("adminApiKeyUserId");s&&(!s.value||Number(s.value)<=0)&&o!==null&&(s.value=String(o))}function xi({userId:t,apiKeyId:e,key:o,label:s}){const r=document.getElementById("adminApiKeyCreatedDialog");if(!r)return;const i=document.getElementById("adminApiKeyCreatedMessage");if(i){const u=n("admin.api_key_modal_message","API Key criada para usuário {user_id} (ID {api_key_id})").replace("{user_id}",String(t)).replace("{api_key_id}",String(e));i.textContent=u}const a=document.getElementById("adminApiKeyCreatedLabel");a&&(a.textContent=s||"-");const l=document.getElementById("adminApiKeyCreatedValue");l&&(l.value=String(o||"")),r.open=!0}function Li(){const t=document.getElementById("adminApiKeyCreatedDialog");t&&(t.open=!1)}function Ei(){return[...d("tradeStrategyAccountIds").selectedOptions].map(t=>Number(t.value)).filter(t=>Number.isFinite(t)&&t>0)}function ht(t){return String(t||"").split(",").map(e=>Number(String(e).trim())).filter(e=>Number.isFinite(e)&&e>0)}function ds(t,e="value"){if(t==null)return null;const o=String(t).trim();if(!o)return null;const s=Number(o);if(!Number.isFinite(s)||s<=0||!Number.isInteger(s))throw new Error(`${e} inválido`);return s}function Pi(t,e=[]){const o=[...new Set((e||[]).map(r=>Number(r)).filter(r=>Number.isFinite(r)&&r>0))];if(Array.isArray(t))return[...new Set(t.map(r=>Number(r)).filter(r=>Number.isFinite(r)&&r>0))];const s=String(t||"").trim().toLowerCase();if(!s||s==="all"||s==="*"){if(o.length>0)return o;throw new Error("nenhuma conta disponível para aplicar 'all'")}return[...new Set(ht(t))]}function Ii(){if(m.availableAccountIds.length>0)return Number(m.availableAccountIds[0]);const t=lo();return t.length>0?Number(t[0]):1}function $i(t){const e=Ii(),o=String(t||"").trim().toLowerCase();return o==="admin"?[]:o==="risk"?[{account_id:e,can_read:!0,can_trade:!1,can_close_position:!0,can_risk_manage:!0,can_block_new_positions:!0,can_block_account:!0,restrict_to_strategies:!1,strategy_ids:[]}]:o==="readonly"?[{account_id:e,can_read:!0,can_trade:!1,can_close_position:!1,can_risk_manage:!1,can_block_new_positions:!1,can_block_account:!1,restrict_to_strategies:!1,strategy_ids:[]}]:o==="robot"?[{account_id:e,can_read:!0,can_trade:!0,can_close_position:!0,can_risk_manage:!1,can_block_new_positions:!1,can_block_account:!1,restrict_to_strategies:!0,strategy_ids:[]}]:[{account_id:e,can_read:!0,can_trade:!0,can_close_position:!0,can_risk_manage:!1,can_block_new_positions:!1,can_block_account:!1,restrict_to_strategies:!1,strategy_ids:[]}]}async function A(t,e={},o=null){const s=o||C(),r=new Headers(e.headers||{});r.set("x-api-key",s.apiKey),e.body!==void 0&&r.set("Content-Type","application/json");const i=await fetch(`${s.baseUrl}${t}`,{method:e.method||"GET",headers:r,body:e.body!==void 0?JSON.stringify(e.body):void 0}),a=await i.text(),l=a?JSON.parse(a):{};if(!i.ok){const u=l?.detail&&typeof l.detail=="object"?l.detail:null,h=String(u?.message||u?.code||"").trim(),f=Array.isArray(u?.results)?u.results[0]?.error:null,y=String(f?.message||f?.code||"").trim(),S=h||y;throw S?new Error(`${i.status} ${S}`):new Error(`${i.status} ${JSON.stringify(l)}`)}return l}function Ze(t,e="oms_command"){if(!t||!Array.isArray(t.results))return t;const o=t.results.find(l=>l&&l.ok===!1);if(!o)return t;const s=o.error||{},r=String(s.code||"dispatcher_error"),i=String(s.message||"").trim(),a=i?`: ${i}`:"";throw new Error(`${e} -> ${r}${a}`)}async function et(t){if(t.viewAccountIds.length>0)return t.viewAccountIds;m.availableAccountIds.length===0&&await Se(t);const e=Pe();if(e.length>0)return e;const o=lo();if(o.length>0)return o;throw new Error("view accounts is empty; selecione uma ou mais contas")}function Ti(t){const e=new URL(t);return e.protocol=e.protocol==="https:"?"wss:":"ws:",e.pathname="/ws",e.search="",e.toString()}function le(t,e){const o=t.trim();return o?JSON.parse(o):e}function Kt(t){const e=typeof t=="string"?t:JSON.stringify(t,null,2);d("ccxtResultBox").value=e}function us(t){const e=r=>{if(r==null||r==="")return null;const i=Number(r);return Number.isFinite(i)?i:null},o=r=>{const i=r&&typeof r=="object"?r:{},a=i.info&&typeof i.info=="object"?i.info:{},l=Array.isArray(a.filters)?a.filters:[],u=$=>l.find(c=>String(c?.filterType||"").toUpperCase()===String($).toUpperCase())||{},h=u("PRICE_FILTER"),f=u("LOT_SIZE"),y=u("MARKET_LOT_SIZE"),S=e(i.tick_size)??e(i.tickSize)??e(a.tickSize)??e(h.tickSize)??null,P=e(i.step_size)??e(i.stepSize)??e(a.stepSize)??e(f.stepSize)??e(y.stepSize)??null;return{tickSize:S,stepSize:P}};let s=[];return Array.isArray(t)?s=t.map((r,i)=>{const a=r&&typeof r=="object"?r:{},l=String(a.symbol||"").trim(),u=String(a.id||"").trim(),h=String(a.base||"").trim(),f=String(a.quote||"").trim(),y=a.precision&&typeof a.precision=="object"?a.precision:{},S=a.limits&&typeof a.limits=="object"?a.limits:{},P=S.amount&&typeof S.amount=="object"?S.amount:{},$=S.price&&typeof S.price=="object"?S.price:{},c=S.cost&&typeof S.cost=="object"?S.cost:{},p=`${l||u||i}`,{tickSize:g,stepSize:b}=o(a);return{id:p,row_id:p,symbol:l||(h&&f?`${h}/${f}`:""),market_id:u,base:h,quote:f,type:String(a.type||"").trim(),active:a.active===!0?!0:a.active===!1?!1:null,qty_decimals:y.amount??null,price_decimals:y.price??null,qty_min:P.min??null,qty_max:P.max??null,price_min:$.min??null,price_max:$.max??null,cost_min:c.min??null,cost_max:c.max??null,tick_size:g,step_size:b}}):t&&typeof t=="object"&&(s=Object.entries(t).map(([r,i],a)=>{const l=i&&typeof i=="object"?i:{},u=String(l.symbol||"").trim(),h=String(l.id||r||"").trim(),f=String(l.base||"").trim(),y=String(l.quote||"").trim(),S=l.precision&&typeof l.precision=="object"?l.precision:{},P=l.limits&&typeof l.limits=="object"?l.limits:{},$=P.amount&&typeof P.amount=="object"?P.amount:{},c=P.price&&typeof P.price=="object"?P.price:{},p=P.cost&&typeof P.cost=="object"?P.cost:{},g=`${h||u||a}`,{tickSize:b,stepSize:v}=o(l);return{id:g,row_id:g,symbol:u||(f&&y?`${f}/${y}`:String(r||"").trim()),market_id:h,base:f,quote:y,type:String(l.type||"").trim(),active:l.active===!0?!0:l.active===!1?!1:null,qty_decimals:S.amount??null,price_decimals:S.price??null,qty_min:$.min??null,qty_max:$.max??null,price_min:c.min??null,price_max:c.max??null,cost_min:p.min??null,cost_max:p.max??null,tick_size:b,step_size:v}})),s.filter(r=>String(r.symbol||"").trim()||String(r.market_id||"").trim()).sort((r,i)=>String(r.symbol||r.market_id||"").localeCompare(String(i.symbol||i.market_id||"")))}function ms(t){return[...new Set((t||[]).map(e=>String(e.symbol||e.market_id||"").trim()).filter(e=>!!e))].sort()}async function ps(t=!0){const e=C(),o=U("omsSymbolsAccountId","oms_symbols"),s=await A(`/ccxt/${o}/load_markets`,{method:"POST",body:{args:[],kwargs:{}}},e),r=us(s.result);xe("symbolsList",r,t?1:null);const i=ms(r);He("symbolHistory",i.slice(0,2e3)),!d("sendSymbol").value&&i[0]&&(d("sendSymbol").value=i[0]),_("oms_symbols_loaded",{account_id:o,count:r.length}),T("info","OMS symbol list loaded",{account_id:o,count:r.length})}function _s(t){return!!(t&&t.__ccxtBuilt===!0)}function de(t,e){if(!t)return;const o=uo(e);if(_s(t)&&typeof t.setColumns=="function"){t.setColumns(o);return}t.__pendingColumns=o}function gs(t){if(t){if(_s(t)&&typeof t.redraw=="function"){t.redraw(!0);return}t.__pendingRedraw=!0}}function Ht(t){const o={paneOpenPositions:"openPositions",paneOpenOrders:"openOrders",paneDeals:"deals",paneHistoryPositions:"historyPositions",paneHistoryOrders:"historyOrders",paneSymbolsList:"omsSymbols",paneCcxtOrders:"ccxtOrders",paneCcxtTrades:"ccxtTrades",paneWsEvents:"events",paneUiLogs:"uiLogs"}[t];if(!o)return;const s=m.tables[o];gs(s)}function Oi(t){if(Dt.has(t))return(m.omsLocalData[t]||[]).length>0;const e=m.tables[t];return!e||typeof e.getData!="function"?!1:(e.getData()||[]).length>0}async function Di(t){const e=String(t||"").trim(),s={openPositions:()=>Re(),openOrders:()=>ot(),deals:()=>K("deals",!1),historyPositions:()=>K("historyPositions",!1),historyOrders:()=>K("historyOrders",!1),symbolsList:()=>ps(!1)}[e];if(!s||Oi(e))return;const r=co();if(!(!r.baseUrl||!r.apiKey))try{await s(),_("oms_tab_autoload",{tab:e})}catch(i){_("oms_tab_autoload_error",{tab:e,error:String(i)}),T("error","OMS tab auto reload failed",{tab:e,error:String(i)})}}function Bi(){const t=d("positionTabs"),e=d("systemTabs"),o=s=>{const r=String(s?.detail?.name||"");if(!r)return;Ht(String({openPositions:"paneOpenPositions",openOrders:"paneOpenOrders",deals:"paneDeals",historyPositions:"paneHistoryPositions",historyOrders:"paneHistoryOrders",symbolsList:"paneSymbolsList",ccxtOrders:"paneCcxtOrders",ccxtTrades:"paneCcxtTrades",wsEvents:"paneWsEvents",uiLogs:"paneUiLogs"}[r]||"")),s?.currentTarget===t&&Promise.resolve(Di(r)).catch(a=>{_("oms_tab_autoload_error",{tab:r,error:String(a)})})};t.addEventListener("wa-tab-show",o),e.addEventListener("wa-tab-show",o),Ht("paneOpenPositions"),Ht("paneCcxtOrders")}function Mi(t){const e=je?.[t]||{};return String(e["meta.language_name"]||yi[t]||t)}function n(t,e=""){const o=je?.[m.locale]||je?.["pt-BR"]||{};return String(o[t]||e||t)}function me(t,e){const o=document.getElementById("omsMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"oms"})}}function nt(t,e){const o=document.getElementById("loginMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"login"})}}function Bo(t,e){const o=document.getElementById("adminCreatedApiKeyBox");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"admin_api_keys"})}}function Q(t,e){const o=document.getElementById("adminOmsMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"admin_oms"})}}function St(t,e){const o=document.getElementById("adminAccountsMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"admin_accounts"})}}function X(t,e){const o=document.getElementById("userMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"user"})}}function Ni(t="pt-BR"){const e=d("loginLanguage"),o=Object.keys(je||{});e.innerHTML="";for(const s of o){const r=document.createElement("option");r.value=s,r.textContent=Mi(s),r.selected=s===t,e.appendChild(r)}![...e.options].some(s=>s.selected)&&e.options.length>0&&(e.options[0].selected=!0)}function hs(){document.querySelectorAll("[data-i18n]").forEach(s=>{const r=String(s.getAttribute("data-i18n")||"").trim();r&&(s.textContent=n(r,s.textContent||""))}),document.querySelectorAll("[data-i18n-placeholder]").forEach(s=>{const r=String(s.getAttribute("data-i18n-placeholder")||"").trim();if(!r)return;const i=s.getAttribute("placeholder")||"";s.setAttribute("placeholder",n(r,i))});const t=(s,r,i)=>{const a=document.getElementById(s);a&&(a.textContent=n(r,i))},e=(s,r,i)=>{const a=document.getElementById(s);if(!a)return;const l=a.querySelector("span:last-child");l&&(l.textContent=n(r,i))};e("tabLoginBtn","menu.login_config","Login / Config"),e("tabUserGroupBtn","menu.user","User"),e("tabUserProfileBtn","user.tab_profile","Profile"),e("tabUserApiKeysBtn","user.tab_api_keys","API Keys"),e("tabStrategiesBtn","menu.strategies","Strategies"),e("tabOmsGroupBtn","menu.oms","OMS"),e("tabPositionsBtn","positions.open_positions","Open Positions"),e("tabCommandsBtn","menu.ccxt_commands","CCXT Commands"),e("tabPostTradingGroupBtn","menu.post_trading","Post Trading"),e("tabPostTradingOrdersBtn","menu.post_trading_external_orders","External Orders"),e("tabSystemBtn","menu.system_monitor","System Monitor"),e("tabRiskGroupBtn","menu.risk","Risk"),e("tabRiskAccountsBtn","admin.accounts","Accounts"),e("tabRiskApiKeysBtn","menu.api_keys","API Keys"),e("tabAdminGroupBtn","menu.admin","Administration"),e("tabAdminBtn","admin.accounts","Accounts"),e("tabAdminUsersBtn","admin.users","Users"),e("tabAdminApiKeysBtn","menu.api_keys","API Keys"),e("tabAdminStatusBtn","admin.system_status","System Status"),e("tabAdminOmsBtn","menu.admin_oms_crud","OMS CRUD"),t("loginModeLabel","login.mode","Mode"),t("loginModeApiKeyOption","login.mode_api_key","API Key"),t("loginModeUserPassOption","login.mode_user_password","User + Password"),t("selectAllAccountsBtn","common.select_all","Select All"),t("clearAccountsBtn","common.clear","Clear"),t("viewAccountsLabel","trade.filter_accounts","Filter Accounts"),t("loginAuthBtn","login.authenticate","Authenticate"),t("connectBtn","trade.connect_ws","Connect WS"),t("disconnectBtn","trade.disconnect_ws","Disconnect"),t("refreshOmsBtn","trade.refresh_tables","Refresh Tables"),t("accountsBtn","trade.load_accounts","Reload Accounts"),t("tradeCreateStrategyTitle","trade.create_strategy","Create Strategy"),t("tradeCreateStrategyBtn","trade.create_strategy","Create Strategy"),t("tradeMyStrategiesTitle","trade.my_strategies","My Strategies"),t("loadTradeStrategiesBtn","trade.load_strategies","Load Strategies"),t("tradeStrategyNameLabel","trade.name","Name"),t("tradeStrategyAccountsLabel","trade.accounts","Accounts"),t("loadUserApiKeysBtn","user.load_api_keys","Reload API Keys"),t("userCreateApiKeyBtn","user.create_api_key","Create API Key"),t("userSaveProfileBtn","user.save_profile","Save Profile"),t("userSavePasswordBtn","user.save_password","Save Password"),t("riskSavePermissionBtn","risk.save_permission","Save Permission");const o=document.getElementById("closeByModal");o&&o.setAttribute("label",n("closeby.title","Close By")),oa(),m.tables.adminAccounts&&de(m.tables.adminAccounts,bs()),m.tables.adminUsers&&de(m.tables.adminUsers,Ps()),m.tables.adminUsersKeys&&de(m.tables.adminUsersKeys,Is()),m.tables.adminUsersPermissions&&de(m.tables.adminUsersPermissions,$s()),m.tables.userApiKeys&&de(m.tables.userApiKeys,Ts()),m.tables.userApiKeyPermissions&&de(m.tables.userApiKeyPermissions,Os()),m.tables.riskPermissions&&de(m.tables.riskPermissions,Ds()),$t(m.densityMode,!1),fs(),ys()}function fs(){const t=document.getElementById("apiKey"),e=document.getElementById("toggleApiKeyBtn");if(!t||!e)return;const o=t.type==="password",s=o?n("login.show","show"):n("login.hide","hide");e.setAttribute("aria-label",s),e.setAttribute("title",s),e.innerHTML=o?'<i class="fa-solid fa-eye" aria-hidden="true"></i>':'<i class="fa-solid fa-eye-slash" aria-hidden="true"></i>'}function ys(){const t=document.getElementById("loginPassword"),e=document.getElementById("toggleLoginPasswordBtn");if(!t||!e)return;const o=t.type==="password",s=o?n("login.show","show"):n("login.hide","hide");e.setAttribute("aria-label",s),e.setAttribute("title",s),e.innerHTML=o?'<i class="fa-solid fa-eye" aria-hidden="true"></i>':'<i class="fa-solid fa-eye-slash" aria-hidden="true"></i>'}function zi(){const t=d("tabUserGroupBtn"),e=d("userSubmenu"),o=d("tabAdminGroupBtn"),s=d("adminSubmenu"),r=d("tabOmsGroupBtn"),i=d("omsSubmenu"),a=d("tabPostTradingGroupBtn"),l=d("postTradingSubmenu"),u=d("tabRiskGroupBtn"),h=d("riskSubmenu"),f=c=>{e.classList.toggle("is-hidden",!c),t.classList.toggle("active",c)},y=c=>{s.classList.toggle("is-hidden",!c),o.classList.toggle("active",c)},S=c=>{i.classList.toggle("is-hidden",!c),r.classList.toggle("active",c)},P=c=>{l.classList.toggle("is-hidden",!c),a.classList.toggle("active",c)},$=c=>{h.classList.toggle("is-hidden",!c),u.classList.toggle("active",c)};d("tabLoginBtn").addEventListener("click",()=>N("login")),t.addEventListener("click",()=>{const c=e.classList.contains("is-hidden");f(c),c&&N("userProfile")}),d("tabUserProfileBtn").addEventListener("click",()=>N("userProfile")),d("tabUserApiKeysBtn").addEventListener("click",()=>N("userApiKeys")),r.addEventListener("click",()=>{const c=i.classList.contains("is-hidden");S(c),c&&N("positions")}),d("tabPositionsBtn").addEventListener("click",()=>N("positions")),d("tabCommandsBtn").addEventListener("click",()=>N("commands")),d("tabSystemBtn").addEventListener("click",()=>N("system")),d("tabStrategiesBtn").addEventListener("click",()=>N("strategies")),u.addEventListener("click",()=>{const c=h.classList.contains("is-hidden");$(c),c&&N("riskAccounts")}),d("tabRiskAccountsBtn").addEventListener("click",()=>N("riskAccounts")),d("tabRiskApiKeysBtn").addEventListener("click",()=>N("riskApiKeys")),a.addEventListener("click",()=>{const c=l.classList.contains("is-hidden");P(c),c&&N("postTrading")}),d("tabPostTradingOrdersBtn").addEventListener("click",()=>N("postTrading")),o.addEventListener("click",()=>{const c=s.classList.contains("is-hidden");y(c),c&&N("admin")}),d("tabAdminBtn").addEventListener("click",()=>N("admin")),d("tabAdminUsersBtn").addEventListener("click",()=>N("adminUsers")),d("tabAdminApiKeysBtn").addEventListener("click",()=>N("adminApiKeys")),d("tabAdminStatusBtn").addEventListener("click",()=>N("adminStatus")),d("tabAdminOmsBtn").addEventListener("click",()=>N("adminOms")),f(!1),y(!1),S(!1),P(!1),$(!1)}function Ri(){const t=d("app"),e=d("menuToggleBtn"),o=d("sidebarCollapseBtn"),s=()=>{const r=t.classList.contains("sidebar-collapsed");e.setAttribute("aria-expanded",String(!r)),e.setAttribute("title",r?"Abrir menu":"Fechar menu"),o.setAttribute("title",r?"Menu recolhido":"Recolher menu")};e.addEventListener("click",()=>{t.classList.toggle("sidebar-collapsed"),window.scrollTo({top:0,left:0,behavior:"auto"});const r=document.querySelector(".main-content");r&&typeof r.scrollTo=="function"&&r.scrollTo({top:0,left:0,behavior:"auto"}),s()}),o.addEventListener("click",()=>{t.classList.add("sidebar-collapsed"),s()}),s()}function lo(){const t=[G(d("sendAccountId").value),G(d("cancelOrderAccountId").value),G(d("ccxtAccountId").value),G(d("changeOrderAccountId").value),G(d("positionChangeAccountId").value),G(d("closePositionAccountId").value),G(d("closeByAccountId").value),G(d("riskAccountId").value),G(d("riskStrategyAccountId").value),G(d("riskPermAccountId").value)].filter(e=>Number.isFinite(e)&&e>0);return[...new Set(t)]}function uo(t){const e=i=>{const a=String(i||"").toLowerCase();return a==="id"||a.endsWith("_id")||a.includes("seq")||a.includes("page")},o=i=>{const a=String(i||"").toLowerCase();return a.includes("qty")||a.includes("price")||a.includes("fee")||a.includes("pnl")||a.includes("cost")||a.includes("tick")||a.includes("step")},s=i=>{const a=String(i||"").toLowerCase();return a.startsWith("_")||a.includes("status")||a==="side"||a.includes("state")||a.includes("mode")||a.includes("role")||a.includes("level")||a.includes("kind")||a.includes("reconciled")},r=i=>{if(i==null)return"";const a=String(i).trim();if(!a)return"";const l=Number(a);if(!Number.isFinite(l))return a;const u=Math.max(0,Number(bt.decimalPlaces)||14),h=10**-u;if(Math.abs(l)<h)return"0";const f=(p,g)=>Number(p.toFixed(g)),y=(p,g)=>{const v=p.toFixed(g).replace(/\.?0+$/,"");return v==="-0"?"0":v},S=f(l,u),P=new Set,$=[];for(const p of bt.smartSteps||[]){const g=Math.max(0,Number(p)||0);P.has(g)||(P.add(g),$.push(g))}P.has(u)||$.unshift(u);let c=u;for(const p of $)f(l,p)===S&&(c=p);return y(l,c)};return Array.isArray(t)?t.map(i=>{if(!i||typeof i!="object")return i;const a={...i};return Array.isArray(a.columns)?(a.columns=uo(a.columns),a):(a.hozAlign||(s(a.field)?a.hozAlign="center":e(a.field)||o(a.field)?a.hozAlign="right":a.hozAlign="left"),a.headerHozAlign||(s(a.field)?a.headerHozAlign="center":e(a.field)||o(a.field)?a.headerHozAlign="right":a.headerHozAlign="left"),!a.formatter&&o(a.field)&&(a.formatter=l=>r(l.getValue())),a)}):[]}function R(t,e,o={}){const s=window.Tabulator;if(!s)throw new Error("Tabulator not loaded");const r=document.getElementById(t),i={...o},a=String(i.height||i.maxHeight||"300px");delete i.maxHeight,r&&(r.classList.add("table-resizable"),r.style.height||(r.style.height=a));const l=new s(`#${t}`,{data:[],layout:"fitDataStretch",height:a,placeholder:"sem dados",columns:uo(e),...i});return l.__ccxtBuilt=!1,typeof l.on=="function"&&l.on("tableBuilt",()=>{l.__ccxtBuilt=!0,Array.isArray(l.__pendingColumns)&&typeof l.setColumns=="function"&&l.setColumns(l.__pendingColumns),l.__pendingColumns=null,l.__pendingRedraw&&typeof l.redraw=="function"&&l.redraw(!0),l.__pendingRedraw=!1}),r&&typeof ResizeObserver<"u"&&new ResizeObserver(()=>{gs(l)}).observe(r),l}function Fi(t,e,o="id"){if(e==null)return;const s=t.getData().filter(r=>String(r[o])!==String(e));t.setData(s)}function pe(t,e,o=400){t.addData([e],!0);const s=t.getData();s.length>o&&t.setData(s.slice(0,o))}function Ui(){return[{title:"",field:"_save",hozAlign:"center",headerHozAlign:"center",width:44,minWidth:44,maxWidth:44,widthGrow:0,widthShrink:0,resizable:!1,cssClass:"col-action",headerSort:!1,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-save" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C(),r=await A(`/admin/strategies/${o.strategy_id}`,{method:"PATCH",body:{name:String(o.name||"").trim()||null,status:String(o.status||"").trim()||null,client_strategy_id:ds(o.client_strategy_id,"client_strategy_id"),account_ids:Pi(o.account_ids,m.availableAccountIds)}},s);_("trade_update_strategy",r),await ve(s)}catch(s){_("trade_update_strategy_error",{error:String(s),strategy_id:o.strategy_id})}}},{title:"",field:"_toggle",hozAlign:"center",headerHozAlign:"center",width:44,minWidth:44,maxWidth:44,widthGrow:0,widthShrink:0,resizable:!1,cssClass:"col-action",headerSort:!1,formatter:t=>t.getRow().getData().status==="active"?'<i class="fa-solid fa-xmark icon-danger" title="Disable" aria-hidden="true"></i>':'<i class="fa-solid fa-check icon-ok" title="Enable" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData(),s=o.status==="active"?"disabled":"active";try{const r=C(),i=await A(`/admin/strategies/${o.strategy_id}`,{method:"PATCH",body:{status:s}},r);_("trade_toggle_strategy_status",i),await ve(r)}catch(r){_("trade_toggle_strategy_status_error",{error:String(r),strategy_id:o.strategy_id})}}},{title:n("trade.col_client_strategy_id","Client Strategy ID"),field:"client_strategy_id",editor:"input",width:145,formatter:t=>{const e=t.getValue();return e==null||String(e).trim()===""?"":String(e)}},{title:n("trade.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:n("trade.col_name","Name"),field:"name",editor:"input",width:240},{title:n("trade.col_status","Status"),field:"status",editor:"list",editorParams:{values:["active","disabled"]},width:110},{title:n("trade.col_account_ids","Accounts"),field:"account_ids",widthGrow:1,editor:"input",formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(", "):String(e||"")}}]}function bs(){return[{title:"",field:"_save",hozAlign:"center",headerSort:!1,width:56,minWidth:56,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-ok" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C();let r=o.extra_config_json;typeof r=="string"&&(r=le(r,{}));const i={exchange_id:String(o.exchange_id||"").trim()||null,label:String(o.label||"").trim()||null,position_mode:String(o.position_mode||"").trim()||null,is_testnet:!!o.is_testnet,status:String(o.status||"").trim()||null,extra_config_json:r&&typeof r=="object"?r:{}},a={};String(o.set_api_key||"").trim()&&(a.api_key=String(o.set_api_key||"").trim()),String(o.set_secret||"").trim()&&(a.secret=String(o.set_secret||"").trim()),String(o.set_passphrase||"").trim()&&(a.passphrase=String(o.set_passphrase||"").trim()),Object.keys(a).length>0&&(i.credentials=a);const l=await A(`/admin/accounts/${o.account_id}`,{method:"PATCH",body:i},s);_("admin_update_account",l),await kt(s),St("success",n("admin.accounts_save_ok","Conta salva com sucesso (ID: {id}).").replace("{id}",String(o.account_id||"")))}catch(s){_("admin_update_account_error",{error:String(s),account_id:o.account_id}),St("error",`${n("admin.accounts_save_error","Erro ao salvar conta")}: ${String(s)}`)}}},{title:n("admin.col_account_id","Account ID"),field:"account_id",width:100},{title:n("admin.col_label","Label"),field:"label",editor:"input",width:180},{title:n("admin.col_exchange_id","Exchange ID"),field:"exchange_id",editor:"input",width:140},{title:n("admin.col_position_mode","Position Mode"),field:"position_mode",editor:"list",editorParams:{values:["hedge","netting","strategy_netting"]},width:150},{title:n("admin.col_extra_config_json","Extra Config JSON"),field:"extra_config_json",editor:"textarea",width:260},{title:n("admin.col_testnet","Testnet"),field:"is_testnet",formatter:"tickCross",editor:!0,width:90},{title:n("admin.col_status","Status"),field:"status",editor:"list",editorParams:{values:["active","blocked"]},width:100},{title:n("admin.col_reconcile_enabled","Reconcile Enabled"),field:"reconcile_enabled",width:120},{title:n("admin.col_dispatcher_worker_hint","Dispatcher Worker Hint"),field:"dispatcher_worker_hint",width:150},{title:n("admin.col_raw_storage_mode","Raw Storage Mode"),field:"raw_storage_mode",width:130},{title:n("oms.col_created_at","Created At"),field:"created_at",width:180},{title:n("admin.col_api_key_enc","API Key Enc"),field:"api_key_enc",width:240},{title:n("admin.col_secret_enc","Secret Enc"),field:"secret_enc",width:240},{title:n("admin.col_passphrase_enc","Passphrase Enc"),field:"passphrase_enc",width:220},{title:n("admin.col_credentials_updated_at","Credentials Updated At"),field:"credentials_updated_at",width:180},{title:n("admin.col_set_api_key","Set API Key"),field:"set_api_key",editor:"input",width:180},{title:n("admin.col_set_secret","Set Secret"),field:"set_secret",editor:"input",width:180},{title:n("admin.col_set_passphrase","Set Passphrase"),field:"set_passphrase",editor:"input",width:180}]}function ws(){return new Date().toISOString()}function _(t,e){m.eventSeq+=1,pe(m.tables.events,{seq:m.eventSeq,at:ws(),kind:t,payload:JSON.stringify(e).slice(0,2400)})}function qi(){return typeof indexedDB<"u"}function Ki(t){let e=2166136261;const o=String(t||"");for(let s=0;s<o.length;s+=1)e^=o.charCodeAt(s),e=Math.imul(e,16777619);return`h${(e>>>0).toString(16).padStart(8,"0")}`}function Je(){const t=String(document.getElementById("baseUrl")?.value||"").trim().toLowerCase(),e=String(document.getElementById("apiKey")?.value||"").trim();return!t&&!e?"h_anonymous":Ki(`${t}|${e}`)}function mo(){return new Promise((t,e)=>{if(!qi()){e(new Error("indexeddb_unavailable"));return}const o=indexedDB.open(V.dbName,V.version);o.onupgradeneeded=()=>{const s=o.result;s.objectStoreNames.contains(V.storeName)||s.createObjectStore(V.storeName,{keyPath:"id",autoIncrement:!0})},o.onsuccess=()=>t(o.result),o.onerror=()=>e(o.error||new Error("indexeddb_open_error"))})}function Te(t){return new Promise((e,o)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>o(t.error||new Error("indexeddb_request_error"))})}async function Hi(t){try{const e=await mo();try{const o=e.transaction(V.storeName,"readwrite"),s=o.objectStore(V.storeName),r=Je();await Te(s.add({...t,scope_hash:r,created_ts:Date.now()}));const i=Number(V.maxRows);if(Number.isFinite(i)&&i>0){const a=await Te(s.getAllKeys()),l=Math.max(0,(a?.length||0)-i);if(l>0)for(let u=0;u<l;u+=1)await Te(s.delete(a[u]))}await new Promise((a,l)=>{o.oncomplete=()=>a(!0),o.onerror=()=>l(o.error||new Error("indexeddb_tx_error")),o.onabort=()=>l(o.error||new Error("indexeddb_tx_abort"))})}finally{e.close()}}catch{}}async function vs(){if(m.tables.uiLogs)try{const t=await mo();try{const o=t.transaction(V.storeName,"readonly").objectStore(V.storeName),s=await Te(o.getAll()),r=Je(),i=(s||[]).filter(l=>String(l?.scope_hash||"h_anonymous")===r).map(l=>({seq:Number(l?.seq||0),at:String(l?.at||""),level:String(l?.level||"info"),message:String(l?.message||""),payload:String(l?.payload||"")}));m.tables.uiLogs.setData(i),typeof m.tables.uiLogs.setPage=="function"&&await m.tables.uiLogs.setPage(1);const a=i.reduce((l,u)=>Math.max(l,Number(u.seq||0)),0);m.uiLogSeq=Math.max(m.uiLogSeq,a),Me()}finally{t.close()}}catch{}}async function ji(){try{const t=await mo();try{const e=t.transaction(V.storeName,"readwrite"),o=e.objectStore(V.storeName),s=Je(),r=await Te(o.getAll());for(const i of r||[])String(i?.scope_hash||"h_anonymous")===s&&i?.id!==void 0&&await Te(o.delete(i.id));await new Promise((i,a)=>{e.oncomplete=()=>i(!0),e.onerror=()=>a(e.error||new Error("indexeddb_tx_error")),e.onabort=()=>a(e.error||new Error("indexeddb_tx_abort"))})}finally{t.close()}}catch{}}function Me(){const t=m.tables.uiLogs,e=document.getElementById("uiLogsPageInfo"),o=document.getElementById("uiLogsPageInput");if(!t||!e)return;const s=Number(t.getPage?.()||1),r=Math.max(1,Number(t.getPageMax?.()||1));e.textContent=`${s} / ${r}`,o&&(o.value=String(s))}async function ct(t){const e=m.tables.uiLogs;if(!e||typeof e.setPage!="function")return;const o=Math.max(1,Number(e.getPageMax?.()||1)),s=Math.min(o,Math.max(1,Number(t)||1));await e.setPage(s),Me()}async function Vi(t){const e=m.tables.uiLogs;if(!e||typeof e.setPageSize!="function")return;const o=Math.max(1,Math.min(5e3,Number(t)||100));await e.setPageSize(o),await e.setPage(1),Me()}async function Mo(){m.tables.uiLogs&&m.tables.uiLogs.clearData(),m.uiLogSeq=0,await vs()}function T(t,e,o={}){if(!m.tables.uiLogs)return;m.uiLogSeq+=1;const s={seq:m.uiLogSeq,at:ws(),level:String(t||"info"),message:String(e||""),payload:JSON.stringify(o).slice(0,2400)},r=Number(V.maxRows);Number.isFinite(r)&&r>0?pe(m.tables.uiLogs,s,r):pe(m.tables.uiLogs,s,Number.POSITIVE_INFINITY),Me(),Promise.resolve(Hi(s)).catch(()=>{})}function Tt(t){return t.map(e=>Number(e)).filter(e=>Number.isFinite(e)&&e>0).join(",")}async function Wi(t,e){const o=Tt(t),s=new URLSearchParams({account_ids:o,limit:"5000"}),[r,i]=await Promise.all([A(`/oms/orders/open?${s.toString()}`,{},e),A(`/oms/positions/open?${s.toString()}`,{},e)]);return{openOrders:r.items||[],openPositions:i.items||[]}}function ge(t){const e=new Map;for(const o of t){const s=o.id!==void 0?String(o.id):o.row_id!==void 0?String(o.row_id):JSON.stringify(o);e.set(s,o)}return[...e.values()]}function Ne(t){return[...t||[]].sort((e,o)=>{const s=e?.id??e?.row_id??"",r=o?.id??o?.row_id??"",i=Number(s),a=Number(r),l=Number.isFinite(i),u=Number.isFinite(a);return l&&u?i-a:l&&!u?-1:!l&&u?1:String(s).localeCompare(String(r))})}function ze(t,e){const o=Number(t);if(!Number.isFinite(o)||o<1)return 1;const s=Math.max(1,Number(e)||1);return Math.min(Math.trunc(o),s)}function Ss(t){const e=m.omsPager[t];if(!e)return;const o=`${t}PageInfo`,s=`${t}PageInput`,r=document.getElementById(o),i=document.getElementById(s);r&&(r.textContent=`${e.page} / ${e.totalPages}`),i&&(i.value=String(e.page))}function Ot(t,e,o=1,s=m.omsPageSize){const r=Math.max(1,Number(s)||m.omsPageSize),i=Math.max(0,Number(e)||0),a=Math.max(1,Math.ceil(i/r)),l=ze(o,a);m.omsPager[t]={page:l,pageSize:r,total:i,totalPages:a},Ss(t)}function Gi(t){const e=m.adminPager[t];if(!e)return;const o=document.getElementById(`${t}PageInfo`),s=document.getElementById(`${t}PageInput`);o&&(o.textContent=`${e.page} / ${e.totalPages}`),s&&(s.value=String(e.page))}function Ji(t,e,o=1,s=m.adminPager[t]?.pageSize||20){const r=Math.max(1,Number(s)||20),i=Math.max(0,Number(e)||0),a=Math.max(1,Math.ceil(i/r)),l=ze(o,a);m.adminPager[t]={page:l,pageSize:r,total:i,totalPages:a},Gi(t)}function po(t){const e=m.tables[t];if(!e)return;const o=Array.isArray(m.adminLocalData[t])?[...m.adminLocalData[t]]:[],s=m.adminPager[t]||{page:1,pageSize:20},r=Math.max(1,Number(s.pageSize||20)),i=Math.max(1,Math.ceil(o.length/r)),a=ze(s.page||1,i),l=(a-1)*r,u=o.slice(l,l+r);Ji(t,o.length,a,r),e.setData(u)}function Qt(t,e,o=Ne){const s=Array.isArray(e)?[...e]:[];m.adminLocalData[t]=typeof o=="function"?o(s):s,po(t)}function tt(t){const o={openPositions:"openPositions",openOrders:"openOrders",symbolsList:"omsSymbols"}[t]||"openOrders",s=t==="symbolsList"?[...ge(m.omsLocalData[t]||[])].sort((f,y)=>String(f?.symbol||f?.market_id||"").localeCompare(String(y?.symbol||y?.market_id||""))):Ne(ge(m.omsLocalData[t]||[])),r=m.omsPager[t],i=Math.max(1,Number(r?.pageSize||m.omsPageSize)),a=Math.max(1,Math.ceil(s.length/i)),l=ze(r?.page||1,a),u=(l-1)*i,h=s.slice(u,u+i);m.omsLocalData[t]=s,Ot(t,s.length,l,i),m.tables[o].setData(h)}function xe(t,e,o=null){m.omsLocalData[t]=t==="symbolsList"?[...ge(e||[])].sort((s,r)=>String(s?.symbol||s?.market_id||"").localeCompare(String(r?.symbol||r?.market_id||""))):Ne(ge(e||[])),o!==null&&(m.omsPager[t].page=Math.max(1,Number(o)||1)),tt(t)}function No(t,e){const o=[...m.omsLocalData[t]||[]],s=o.findIndex(r=>String(r.id)===String(e.id));s>=0?o[s]={...o[s],...e}:o.push(e),m.omsLocalData[t]=Ne(o),tt(t)}function lt(t,e){const o=(m.omsLocalData[t]||[]).filter(s=>String(s.id)!==String(e));m.omsLocalData[t]=o,tt(t)}function zo(t,e,o){const s=Array.isArray(o)?o.filter(a=>a&&typeof a=="object"):[];if(!Number.isFinite(Number(e))||Number(e)<=0){xe(t,s);return}const r=Number(e),i=(m.omsLocalData[t]||[]).filter(a=>Number(a.account_id)!==r);xe(t,[...i,...s])}function Qi(t=new Date){const e=new Date(t.getFullYear(),t.getMonth()+1,0),o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${o}-${s}-${r}`}function Xi(t){const e=new Date;e.setDate(e.getDate()-Math.max(0,Number(t)||0));const o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${o}-${s}-${r}`}function Yi(t=new Date){const e=new Date(t.getFullYear(),t.getMonth(),1),o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${o}-${s}-${r}`}function Zi(){const t=Yi(),e=Xi(7);return{startDate:e<t?e:t,endDate:Qi()}}function ea(){const t=Zi(),e=[["dealsStartDate","dealsEndDate"],["historyPositionsStartDate","historyPositionsEndDate"],["historyOrdersStartDate","historyOrdersEndDate"],["ccxtOrdersStartDate","ccxtOrdersEndDate"],["ccxtTradesStartDate","ccxtTradesEndDate"],["postTradingStartDate","postTradingEndDate"],["adminOmsStartDate","adminOmsEndDate"]];for(const[o,s]of e){const r=document.getElementById(o),i=document.getElementById(s);r&&!r.value&&(r.value=t.startDate),i&&!i.value&&(i.value=t.endDate)}}function ta(t){const o={deals:["dealsStartDate","dealsEndDate"],historyPositions:["historyPositionsStartDate","historyPositionsEndDate"],historyOrders:["historyOrdersStartDate","historyOrdersEndDate"],ccxtOrders:["ccxtOrdersStartDate","ccxtOrdersEndDate"],ccxtTrades:["ccxtTradesStartDate","ccxtTradesEndDate"]}[t];if(!o)throw new Error("invalid history kind");const s=String(d(o[0]).value||"").trim(),r=String(d(o[1]).value||"").trim();if(!s||!r)throw new Error("start_date e end_date são obrigatórios");return{startDate:s,endDate:r}}async function K(t,e=!1){const o=C(),s=await et(o),r=Tt(s),i=m.omsPager[t],a=e?1:Math.max(1,Number(i?.page||1)),l=Math.max(1,Number(i?.pageSize||m.omsPageSize)),{startDate:u,endDate:h}=ta(t),y={deals:"/oms/deals",historyPositions:"/oms/positions/history",historyOrders:"/oms/orders/history",ccxtOrders:"/ccxt/orders/raw",ccxtTrades:"/ccxt/trades/raw"}[t],S=new URLSearchParams({account_ids:r,start_date:u,end_date:h,page:String(a),page_size:String(l)}),P=await A(`${y}?${S.toString()}`,{},o),$=ge(P.items||[]);m.tables[t].setData($),Ot(t,Number(P.total||0),Number(P.page||a),Number(P.page_size||l))}const _o=["openPositions","openOrders","symbolsList","deals","historyPositions","historyOrders","ccxtOrders","ccxtTrades","postTrading","adminOms"],Dt=new Set(["openPositions","openOrders","symbolsList"]);function oa(){const t=n("common.previous","Previous"),e=n("common.next","Next"),o=n("common.copy","Copy"),s=n("common.export_csv","Export CSV"),r=n("common.export_excel","Export Excel"),i=n("common.export_json","Export JSON"),a=n("common.export_html","Export HTML");for(const l of[..._o,...ns]){const u=document.getElementById(`${l}PrevPageBtn`),h=document.getElementById(`${l}NextPageBtn`),f=document.getElementById(`${l}CopyBtn`),y=document.getElementById(`${l}ExportCsvBtn`),S=document.getElementById(`${l}ExportExcelBtn`),P=document.getElementById(`${l}ExportJsonBtn`),$=document.getElementById(`${l}ExportHtmlBtn`);u&&(u.setAttribute("title",t),u.setAttribute("aria-label",t)),h&&(h.setAttribute("title",e),h.setAttribute("aria-label",e)),f&&(f.setAttribute("title",o),f.setAttribute("aria-label",o)),y&&(y.setAttribute("title",s),y.setAttribute("aria-label",s)),S&&(S.setAttribute("title",r),S.setAttribute("aria-label",r)),P&&(P.setAttribute("title",i),P.setAttribute("aria-label",i)),$&&($.setAttribute("title",a),$.setAttribute("aria-label",a))}}function ks(t){return Dt.has(t)?Ne(ge(m.omsLocalData[t]||[])):t==="postTrading"?[...m.tables[t]?.getData()||[]]:Ne(ge(m.tables[t]?.getData()||[]))}function As(t){const e=m.tables[t];return e?e.getColumns().map(o=>o.getDefinition()).filter(o=>o&&o.field&&!String(o.field).startsWith("_")).map(o=>({field:String(o.field),title:String(o.title||o.field)})):[]}function Ro(t){const e=t==null?"":String(t);return/[",\n\r]/.test(e)?`"${e.replace(/"/g,'""')}"`:e}function Cs(t,e){const o=e.map(r=>Ro(r.title)).join(","),s=t.map(r=>e.map(i=>Ro(r[i.field])).join(",")).join(`
`);return`${o}
${s}`}function Fo(t,e){const o=i=>String(i??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s=e.map(i=>`<th>${o(i.title)}</th>`).join(""),r=t.map(i=>`<tr>${e.map(a=>`<td>${o(i[a.field])}</td>`).join("")}</tr>`).join(`
`);return`<!doctype html><html><head><meta charset="utf-8"><title>OMS Export</title></head><body><table border="1"><thead><tr>${s}</tr></thead><tbody>${r}</tbody></table></body></html>`}function dt(t,e,o="text/plain;charset=utf-8"){const s=new Blob([e],{type:o}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(r)}async function sa(t){const e=ks(t),o=As(t),s=Cs(e,o);await navigator.clipboard.writeText(s),T("info",`OMS copy ok (${t})`,{rows:e.length})}function ut(t,e){const o=ks(t),s=As(t),r=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");if(e==="csv"){dt(`oms-${t}-${r}.csv`,Cs(o,s),"text/csv;charset=utf-8");return}if(e==="excel"){dt(`oms-${t}-${r}.xls`,Fo(o,s),"application/vnd.ms-excel;charset=utf-8");return}if(e==="json"){dt(`oms-${t}-${r}.json`,JSON.stringify(o,null,2),"application/json;charset=utf-8");return}dt(`oms-${t}-${r}.html`,Fo(o,s),"text/html;charset=utf-8")}async function mt(t,e){const o=m.omsPager[t];if(!o)return;const s=ze(e,o.totalPages);if(m.omsPager[t].page=s,t==="adminOms"){await _e(!1);return}if(t==="postTrading"){await st(!1);return}if(Dt.has(t)){tt(t);return}await K(t,!1)}async function ra(t,e){const o=Math.max(1,Math.min(500,Number(e)||m.omsPageSize));if(m.omsPager[t].pageSize=o,m.omsPager[t].page=1,t==="adminOms"){await _e(!0);return}if(t==="postTrading"){await st(!0);return}if(Dt.has(t)){tt(t);return}await K(t,!0)}function pt(t,e){const o=m.adminPager[t];if(!o)return;const s=ze(e,o.totalPages);m.adminPager[t].page=s,po(t)}function ia(t,e){const o=m.adminPager[t];if(!o)return;const s=Math.max(1,Math.min(500,Number(e)||o.pageSize||20));m.adminPager[t].pageSize=s,m.adminPager[t].page=1,po(t)}async function aa(){const t=C(),e=await et(t),o=await Wi(e,t);xe("openOrders",o.openOrders,1),xe("openPositions",o.openPositions,1),await Promise.all([K("deals",!0),K("historyPositions",!0),K("historyOrders",!0),K("ccxtOrders",!0),K("ccxtTrades",!0)]),ke(`connected ${m.wsConnections.size} ws | viewing ${e.length} account(s)`,m.connected)}async function Re(){const t=C(),e=await et(t),o=Tt(e),s=await A(`/oms/positions/open?account_ids=${encodeURIComponent(o)}&limit=5000`,{},t);xe("openPositions",s.items||[])}async function ot(){const t=C(),e=await et(t),o=Tt(e),s=await A(`/oms/orders/open?account_ids=${encodeURIComponent(o)}&limit=5000`,{},t);xe("openOrders",s.items||[])}async function na(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("order account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("order id inválido");const r=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"cancel_order",payload:{order_id:s}}},e);Ze(r,"cancel_order"),_("open_order_cancel_inline",{account_id:o,order_id:s,out:r}),await ot()}async function ca(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("order account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("order id inválido");const r={order_id:s},i=String(t.qty??"").trim(),a=String(t.price??"").trim();if(i&&(r.new_qty=i),a&&(r.new_price=a),!r.new_qty&&!r.new_price)throw new Error("edite qty e/ou price antes de aplicar");const l=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"change_order",payload:r}},e);Ze(l,"change_order"),_("open_order_change_inline",{account_id:o,order_id:s,out:l}),await ot()}async function la(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("position account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("position id inválido");const r=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"close_position",payload:{position_id:s,order_type:"market"}}},e);Ze(r,"close_position"),_("open_position_close_inline",{account_id:o,position_id:s,out:r}),await Re()}async function Uo(t){const e=C(),o=Number(t.account_id||0),s=Number(t.id||0);if(!Number.isFinite(o)||o<=0)throw new Error("position account_id inválido");if(!Number.isFinite(s)||s<=0)throw new Error("position id inválido");const r={position_id:s},i=t.stop_loss,a=t.stop_gain,l=t.comment;i!==void 0&&(r.oms_stop_loss=i===""||i===null?null:String(i).trim()),a!==void 0&&(r.oms_stop_gain=a===""||a===null?null:String(a).trim()),l!==void 0&&(r.comment=l===""||l===null?null:String(l));const u=await A("/oms/commands",{method:"POST",body:{account_id:o,command:"position_change",payload:r}},e);Ze(u,"position_change"),_("open_position_change_inline",{account_id:o,position_id:s,out:u}),await Re()}async function da(){const e=(m.tables.openPositions?.getSelectedData?.()||[]).filter(u=>Number(u?.account_id)>0&&Number(u?.id)>0);if(e.length===0)throw new Error("select_rows");const o=C(),s=e.map(u=>({account_id:Number(u.account_id),command:"close_position",payload:{position_id:Number(u.id),order_type:"market"}})),r=await A("/oms/commands",{method:"POST",body:s},o),i=Array.isArray(r?.results)?r.results:[],a=i.filter(u=>u&&u.ok===!0).length,l=i.map((u,h)=>({r:u,idx:h})).filter(u=>!u.r||u.r.ok===!1).map(u=>{const h=s[u.idx]||{},f=u.r?.error||{};return{index:u.idx,account_id:h.account_id,position_id:h?.payload?.position_id,error:String(f.message||f.code||"dispatcher_error")}});_("open_positions_close_selected",{requested:e.length,ok:a,errors:l}),l.length>0?(me("error",`${n("oms.bulk_close_positions_partial","Close selected positions finished with errors")} (${a}/${e.length})`),T("warn",n("oms.bulk_close_positions_partial","Close selected positions finished with errors"),{requested:e.length,ok:a,errors:l})):(me("success",`${n("oms.bulk_close_positions_ok","Close selected positions ok")} (${a}/${e.length})`),T("info",n("oms.bulk_close_positions_ok","Close selected positions ok"),{requested:e.length,ok:a})),await Re()}async function ua(){const e=(m.tables.openOrders?.getSelectedData?.()||[]).filter(f=>Number(f?.account_id)>0&&Number(f?.id)>0);if(e.length===0)throw new Error("select_rows");const o=C(),s=new Map;for(const f of e){const y=Number(f.account_id),S=Number(f.id);s.has(y)||s.set(y,[]),s.get(y).push(S)}const r=[...s.entries()].map(([f,y])=>{const S=[...new Set(y)];return{account_id:f,command:"cancel_order",payload:{order_ids:S,order_ids_csv:S.join(",")}}}),i=await A("/oms/commands",{method:"POST",body:r},o),l=(Array.isArray(i?.results)?i.results:[]).map((f,y)=>({r:f,idx:y})).filter(f=>!f.r||f.r.ok===!1).map(f=>{const y=r[f.idx]||{},S=f.r?.error||{};return{index:f.idx,account_id:y.account_id,order_ids:y?.payload?.order_ids||[],error:String(S.message||S.code||"dispatcher_error")}}),u=new Set(l.flatMap(f=>Array.isArray(f.order_ids)?f.order_ids:[])),h=e.filter(f=>!u.has(Number(f.id))).length;_("open_orders_cancel_selected",{requested:e.length,ok:h,errors:l}),l.length>0?(me("error",`${n("oms.bulk_cancel_orders_partial","Cancel selected orders finished with errors")} (${h}/${e.length})`),T("warn",n("oms.bulk_cancel_orders_partial","Cancel selected orders finished with errors"),{requested:e.length,ok:h,errors:l})):(me("success",`${n("oms.bulk_cancel_orders_ok","Cancel selected orders ok")} (${h}/${e.length})`),T("info",n("oms.bulk_cancel_orders_ok","Cancel selected orders ok"),{requested:e.length,ok:h})),await ot()}function xs(){m.closeBySourceRow=null,d("closeBySourceId").value="",d("closeByTargetSelect").innerHTML="",d("closeBySourceInfo").textContent="",d("closeByModal").open=!1}function ma(t){const e=Number(t?.account_id||0),o=Number(t?.id||0),s=String(t?.symbol||""),r=String(t?.side||"").toLowerCase();if(!Number.isFinite(e)||e<=0||!Number.isFinite(o)||o<=0)throw new Error("source position inválida");const i=r==="buy"?"sell":"buy",l=(m.tables.openPositions.getData()||[]).filter(h=>Number(h.account_id)===e&&Number(h.id)!==o&&String(h.symbol||"")===s&&String(h.side||"").toLowerCase()===i);if(l.length===0)throw new Error("nenhuma posição oposta encontrada para close by");m.closeBySourceRow={...t},d("closeBySourceId").value=String(o),d("closeBySourceInfo").textContent=`${n("closeby.source_prefix","Source")} #${o} | ${n("closeby.account","account")} ${e} | ${s} | ${r}`;const u=d("closeByTargetSelect");u.innerHTML="";for(const h of l){const f=document.createElement("option");f.value=String(h.id),f.textContent=`#${h.id} | ${h.side} | qty=${h.qty}`,u.appendChild(f)}d("closeByModal").open=!0}async function pa(){const t=m.closeBySourceRow;if(!t)throw new Error("source position ausente");const e=Number(t.account_id||0),o=Number(t.id||0),s=Number(d("closeByTargetSelect").value||0);if(!Number.isFinite(e)||e<=0)throw new Error("account_id inválido");if(!Number.isFinite(o)||o<=0)throw new Error("position_id_a inválido");if(!Number.isFinite(s)||s<=0)throw new Error("position_id_b inválido");const r=C(),i=await A("/oms/commands",{method:"POST",body:{account_id:e,command:"close_by",payload:{position_id_a:o,position_id_b:s}}},r);Ze(i,"close_by"),_("open_position_close_by_inline",{account_id:e,position_id_a:o,position_id_b:s,out:i}),xs(),await Re()}function _a(t,e=null){const o=t.namespace||"system",s=t.event||"event",r={...t.payload||{}};r.oms_stop_loss!==void 0&&r.stop_loss===void 0&&(r.stop_loss=r.oms_stop_loss),r.oms_stop_gain!==void 0&&r.stop_gain===void 0&&(r.stop_gain=r.oms_stop_gain);const i=r.account_id||e;if(_(`${o}:${s}`,{account_id:i,payload:t.payload||{}}),!r.account_id&&i&&(r.account_id=i),o==="position"){if(s==="snapshot_open_orders"&&Array.isArray(r.items)){zo("openOrders",r.account_id||e,r.items);return}if(s==="snapshot_open_positions"&&Array.isArray(r.items)){zo("openPositions",r.account_id||e,r.items);return}if(r.order_id||r.order_type||r.exchange_order_id){const a={...r};if(!a.id&&r.order_id&&(a.id=r.order_id),a.__deleted){lt("openOrders",a.id);return}new Set(["FILLED","CANCELED","REJECTED","CLOSED"]).has(String(a.status||"").toUpperCase())?lt("openOrders",a.id):No("openOrders",a)}if(r.exchange_trade_id||r.position_id){if(r.__deleted&&r.id){Fi(m.tables.deals,r.id);return}pe(m.tables.deals,r)}if(r.state||r.avg_price||r.side){const a={...r};if(!a.id&&r.position_id&&(a.id=r.position_id),a.__deleted){lt("openPositions",a.id);return}String(a.state||"").toLowerCase()==="closed"||String(a.qty||"")==="0"?lt("openPositions",a.id):No("openPositions",a)}}}function Xt(){const t=co();be(M.baseUrls,t.baseUrl),be(M.apiKeys,t.apiKey);for(const e of t.viewAccountIds)be(M.accountIds,e);for(const e of lo())be(M.accountIds,e);[vt("sendStrategyId"),vt("ccxtStrategyId")].forEach(e=>be(M.strategyIds,e)),Bt()}function Bt(){He("baseUrlHistory",se(M.baseUrls)),He("apiKeyHistory",se(M.apiKeys)),bi(se(M.accountIds)),He("strategyHistory",se(M.strategyIds))}function Ls(){m.pingTimer&&(clearInterval(m.pingTimer),m.pingTimer=null);for(const t of m.wsConnections.values())t.close();m.wsConnections.clear(),m.subscribedAccountIds=[],m.connected=!1,ke("disconnected",!1)}async function ga(){const t=C();Xt(),Ls();const e=await et(t),o=Ti(t.baseUrl),s=new WebSocket(o);m.wsConnections.set("main",s),m.subscribedAccountIds=[...e],s.onopen=async()=>{s.send(JSON.stringify({id:`auth-${Date.now()}`,action:"auth",payload:{api_key:t.apiKey}})),s.send(JSON.stringify({id:`sub-${Date.now()}`,action:"subscribe",payload:{account_ids:e,namespaces:["position","ccxt"],with_snapshot:!0}})),m.connected=!0,ke(`connected 1 ws | viewing ${e.length} account(s)`,!0)},s.onmessage=r=>{try{const i=JSON.parse(r.data);_a(i,null)}catch(i){_("ws_parse_error",{raw:r.data,error:String(i)})}},s.onerror=()=>ke("ws error",!1),s.onclose=()=>{m.wsConnections.delete("main"),ke("disconnected",!1),m.connected=!1},m.pingTimer=setInterval(()=>{for(const[r,i]of m.wsConnections.entries())i.readyState===WebSocket.OPEN&&i.send(JSON.stringify({id:`ping-${r}-${Date.now()}`,action:"ping"}))},2e4)}function fe(t){return{title:"#",field:"_rownum",width:52,minWidth:52,maxWidth:52,hozAlign:"right",headerHozAlign:"right",headerSort:!1,cssClass:"col-rownum",formatter:e=>{const o=m.omsPager[t]||{page:1,pageSize:100},s=Math.max(1,Number(o.page)||1),r=Math.max(1,Number(o.pageSize)||100),i=Number(e.getRow().getPosition(!0)||1);return`<span class="rownum-badge">${(s-1)*r+i}</span>`}}}function qo(t,e="loss"){if(t==null||String(t).trim()==="")return"";const o=String(t).trim();return`<span class="risk-pill ${e==="gain"?"risk-pill-gain":"risk-pill-loss"}">${o}</span>`}function te(t){const e=String(t||"").trim(),o=e.toLowerCase();return o==="buy"?`<span class="side-pill side-buy">${e}</span>`:o==="sell"?`<span class="side-pill side-sell">${e}</span>`:e}function Ko(t){const e=t.getValue();if(e==null)return"";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}}function Es(t){const e=[{title:n("oms.col_id","ID"),field:"id",width:84,editor:"input"},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:100,editor:"input"}];return t==="open_orders"||t==="history_orders"?[...e,{title:n("oms.col_command_id","Command ID"),field:"command_id",width:100,editor:"input"},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120,editor:"input"},{title:n("oms.col_side","Side"),field:"side",width:90,editor:"input",formatter:o=>te(o.getValue())},{title:n("oms.col_order_type","Order Type"),field:"order_type",width:100,editor:"input"},{title:n("oms.col_status","Status"),field:"status",width:120,editor:"input"},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100,editor:"input"},{title:n("oms.col_position_id","Position ID"),field:"position_id",width:100,editor:"input"},{title:"Prev Position ID",field:"previous_position_id",width:130,editor:"input"},{title:n("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:n("oms.col_price","Price"),field:"price",width:110,editor:"input"},{title:n("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120,editor:"input"},{title:n("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120,editor:"input"},{title:n("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:100,editor:"input"},{title:n("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:120,editor:"input"},{title:n("oms.col_reason","Reason"),field:"reason",width:120,editor:"input"},{title:n("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:n("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:140,editor:"input"},{title:n("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150,editor:"input"},{title:"Edit Replace State",field:"edit_replace_state",width:150,editor:"input"},{title:"Edit Replace At",field:"edit_replace_at",width:170,editor:"input"},{title:"Replace Orphan Order",field:"edit_replace_orphan_order_id",width:170,editor:"input"},{title:"Replace Origin Order",field:"edit_replace_origin_order_id",width:170,editor:"input"},{title:n("oms.col_created_at","Created At"),field:"created_at",width:170,editor:"input"},{title:n("oms.col_updated_at","Updated At"),field:"updated_at",width:170,editor:"input"},{title:n("oms.col_closed_at","Closed At"),field:"closed_at",width:170,editor:"input"}]:t==="open_positions"||t==="history_positions"?[...e,{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120,editor:"input"},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100,editor:"input"},{title:n("oms.col_side","Side"),field:"side",width:90,editor:"input",formatter:o=>te(o.getValue())},{title:n("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:n("oms.col_avg_price","Avg Price"),field:"avg_price",width:120,editor:"input"},{title:n("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120,editor:"input"},{title:n("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120,editor:"input"},{title:n("oms.col_state","State"),field:"state",width:100,editor:"input"},{title:n("oms.col_reason","Reason"),field:"reason",width:120,editor:"input"},{title:n("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:n("oms.col_opened_at","Opened At"),field:"opened_at",width:170,editor:"input"},{title:n("oms.col_updated_at","Updated At"),field:"updated_at",width:170,editor:"input"},{title:n("oms.col_closed_at","Closed At"),field:"closed_at",width:170,editor:"input"}]:[...e,{title:n("oms.col_order_id","Order ID"),field:"order_id",width:90,editor:"input"},{title:n("oms.col_position_id","Position ID"),field:"position_id",width:100,editor:"input"},{title:"Prev Position ID",field:"previous_position_id",width:130,editor:"input"},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120,editor:"input"},{title:n("oms.col_side","Side"),field:"side",width:90,editor:"input",formatter:o=>te(o.getValue())},{title:n("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:n("oms.col_price","Price"),field:"price",width:110,editor:"input"},{title:n("oms.col_fee","Fee"),field:"fee",width:100,editor:"input"},{title:n("oms.col_fee_currency","Fee Ccy"),field:"fee_currency",width:100,editor:"input"},{title:n("oms.col_pnl","PnL"),field:"pnl",width:100,editor:"input"},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100,editor:"input"},{title:n("oms.col_reason","Reason"),field:"reason",width:120,editor:"input"},{title:n("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:n("oms.col_reconciled","Reconciled"),field:"reconciled",width:110,editor:!0},{title:n("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:150,editor:"input"},{title:n("oms.col_created_at","Created At"),field:"created_at",width:170,editor:"input"},{title:n("oms.col_executed_at","Executed At"),field:"executed_at",width:170,editor:"input"}]}function Ps(){return[{title:n("user.user_id","User ID"),field:"user_id",width:90},{title:n("user.user_name","User Name"),field:"user_name",width:190},{title:n("user.role","Role"),field:"role",width:120},{title:n("user.status","Status"),field:"status",width:110},{title:n("oms.col_created_at","Created At"),field:"created_at",width:180}]}function Is(){return[{title:n("user.user_id","User ID"),field:"user_id",width:90},{title:n("user.user_name","User Name"),field:"user_name",width:180},{title:n("user.role","Role"),field:"role",width:120},{title:n("admin.col_user_status","User Status"),field:"user_status",width:120},{title:n("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110},{title:n("admin.col_api_key_status","API Key Status"),field:"api_key_status",editor:"list",editorParams:{values:["active","disabled"]},width:140},{title:n("oms.col_created_at","Created At"),field:"created_at",width:180},{title:"",field:"_save",hozAlign:"center",headerSort:!1,width:56,minWidth:56,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-save" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C(),r=Number(o.api_key_id||0);if(!Number.isFinite(r)||r<=0)throw new Error("api_key_id inválido");const i=String(o.api_key_status||"").trim().toLowerCase();if(!["active","disabled"].includes(i))throw new Error("api_key_status inválido");const a=await A(`/admin/api-keys/${r}`,{method:"PATCH",body:{status:i}},s);_("admin_update_api_key_status",a),await Oe(s)}catch(s){_("admin_update_api_key_status_error",{error:String(s)}),T("error","Admin update API key status failed",{error:String(s)})}}}]}function $s(){return[{title:n("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110},{title:n("user.user_id","User ID"),field:"user_id",width:90},{title:n("user.user_name","User Name"),field:"user_name",width:180},{title:n("common.account_id","Account ID"),field:"account_id",width:110},{title:n("risk.can_read","Read"),field:"can_read",width:95},{title:n("risk.can_trade","Trade"),field:"can_trade",width:95},{title:n("risk.can_close_position","Close Position"),field:"can_close_position",width:130},{title:n("risk.can_risk_manage","Risk Manage"),field:"can_risk_manage",width:130},{title:n("risk.can_block_new_positions","Block New Positions"),field:"can_block_new_positions",width:165},{title:n("risk.can_block_account","Block Account"),field:"can_block_account",width:125},{title:n("risk.restrict_to_strategies","Restrict To Strategies"),field:"restrict_to_strategies",width:170},{title:n("risk.strategy_ids","Strategy IDs"),field:"strategy_ids",width:170,formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(","):""}},{title:n("user.status","Status"),field:"status",width:100}]}function Ts(){return[{title:n("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:n("user.user_id","User ID"),field:"user_id",width:100,hozAlign:"right",headerHozAlign:"right"},{title:n("user.user_name","User Name"),field:"user_name",width:200},{title:n("user.role","Role"),field:"role",width:120},{title:n("admin.col_api_key_status","API Key Status"),field:"status",editor:"list",editorParams:{values:["active","disabled"]},width:130},{title:n("oms.col_created_at","Created At"),field:"created_at",width:180},{title:"",field:"_save",hozAlign:"center",headerSort:!1,width:56,minWidth:56,formatter:()=>'<i class="fa-solid fa-floppy-disk icon-save" title="Save" aria-hidden="true"></i>',cellClick:async(t,e)=>{const o=e.getRow().getData();try{const s=C(),r=Number(o.api_key_id||0);if(!Number.isFinite(r)||r<=0)throw new Error("api_key_id invalido");const i=String(o.status||"").trim().toLowerCase();if(!["active","disabled"].includes(i))throw new Error("status invalido");const a=await A(`/user/api-keys/${r}`,{method:"PATCH",body:{status:i}},s);_("user_update_api_key_status",a),await Promise.all([Ct(s),xt(s)]),X("success",n("user.api_key_status_updated","Status da API Key atualizado."))}catch(s){_("user_update_api_key_status_error",{error:String(s)}),X("error",`${n("user.api_key_status_update_error","Erro ao atualizar status da API Key")}: ${String(s)}`)}}}]}function Os(){return[{title:n("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:n("common.account_id","Account ID"),field:"account_id",width:110,hozAlign:"right",headerHozAlign:"right"},{title:n("risk.can_read","Read"),field:"can_read",width:100},{title:n("risk.can_trade","Trade"),field:"can_trade",width:100},{title:n("risk.can_close_position","Close Position"),field:"can_close_position",width:150},{title:n("risk.can_risk_manage","Risk Manage"),field:"can_risk_manage",width:140},{title:n("risk.can_block_new_positions","Block New Positions"),field:"can_block_new_positions",width:180},{title:n("risk.can_block_account","Block Account"),field:"can_block_account",width:150},{title:n("risk.restrict_to_strategies","Restrict To Strategies"),field:"restrict_to_strategies",width:170},{title:n("risk.strategy_ids","Strategy IDs"),field:"strategy_ids",width:180,formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(","):""}},{title:n("user.status","Status"),field:"status",width:100}]}function Ds(){return[{title:n("admin.col_api_key_id","API Key ID"),field:"api_key_id",width:100,hozAlign:"right",headerHozAlign:"right"},{title:n("common.account_id","Account ID"),field:"account_id",width:100,hozAlign:"right",headerHozAlign:"right"},{title:n("risk.can_read","Read"),field:"can_read",width:95},{title:n("risk.can_trade","Trade"),field:"can_trade",width:95},{title:n("risk.can_close_position","Close Position"),field:"can_close_position",width:130},{title:n("risk.can_risk_manage","Risk Manage"),field:"can_risk_manage",width:130},{title:n("risk.can_block_new_positions","Block New Positions"),field:"can_block_new_positions",width:160},{title:n("risk.can_block_account","Block Account"),field:"can_block_account",width:140},{title:n("risk.restrict_to_strategies","Restrict To Strategies"),field:"restrict_to_strategies",width:160},{title:n("risk.strategy_ids","Strategy IDs"),field:"strategy_ids",width:160,formatter:t=>{const e=t.getValue();return Array.isArray(e)?e.join(","):""}},{title:n("user.status","Status"),field:"status",width:95}]}function ha(){m.tables.openPositions=R("openPositionsTable",[fe("openPositions"),{title:"",field:"_close",width:86,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='close' class='row-icon-btn' title='${n("common.close","Close")}' aria-label='${n("common.close","Close")}'><i class='fa-solid fa-xmark icon-danger' aria-hidden='true'></i></button> <button data-act='close_by' class='row-icon-btn' title='${n("cmd.position_close_by","Position Close By")}' aria-label='${n("cmd.position_close_by","Position Close By")}'><i class='fa-solid fa-right-left icon-ok' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(!s)return;const r=e.getRow().getData();try{if(s==="close"){await la(r);return}if(s==="close_by"){ma(r);return}}catch(i){_("open_position_inline_error",{action:s,error:String(i),row:r}),T("error",`Open position action failed (${s})`,{error:String(i),row:r})}}},{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("oms.col_side","Side"),field:"side",width:90,formatter:t=>te(t.getValue())},{title:n("oms.col_qty","Qty"),field:"qty",width:110},{title:n("oms.col_avg_price","Avg Price"),field:"avg_price",width:130},{title:n("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120,editor:"input",formatter:t=>qo(t.getValue(),"loss")},{title:n("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120,editor:"input",formatter:t=>qo(t.getValue(),"gain")},{title:"",field:"_save_targets",width:46,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='save_targets' class='row-icon-btn' title='${n("common.apply","Apply")}' aria-label='${n("common.apply","Apply")}'><i class='fa-solid fa-floppy-disk icon-save' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(s!=="save_targets")return;const r=e.getRow().getData();try{await Uo(r)}catch(i){_("open_position_inline_error",{action:s,error:String(i),row:r}),T("error",`Open position action failed (${s})`,{error:String(i),row:r})}}},{title:n("oms.col_state","State"),field:"state",width:90},{title:n("oms.col_reason","Reason"),field:"reason",width:120},{title:n("oms.col_comment","Comment"),field:"comment",width:180,editor:"input"},{title:"",field:"_save_comment",width:46,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='save_comment' class='row-icon-btn' title='${n("common.apply","Apply")}' aria-label='${n("common.apply","Apply")}'><i class='fa-solid fa-floppy-disk icon-save' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(s!=="save_comment")return;const r=e.getRow().getData();try{await Uo(r)}catch(i){_("open_position_inline_error",{action:s,error:String(i),row:r}),T("error",`Open position action failed (${s})`,{error:String(i),row:r})}}},{title:n("oms.col_opened_at","Opened At"),field:"opened_at",width:170},{title:n("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:n("oms.col_closed_at","Closed At"),field:"closed_at",width:170}],{selectableRows:!0,rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.openOrders=R("openOrdersTable",[fe("openOrders"),{title:"",field:"_close",width:46,hozAlign:"left",headerHozAlign:"left",headerSort:!1,formatter:()=>`<button data-act='cancel' class='row-icon-btn' title='${n("common.cancel","Cancel")}' aria-label='${n("common.cancel","Cancel")}'><i class='fa-solid fa-xmark icon-danger' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(!s)return;const r=e.getRow().getData();try{s==="cancel"&&await na(r)}catch(i){_("open_order_inline_error",{action:s,error:String(i),row:r}),T("error",`Open order action failed (${s})`,{error:String(i),row:r})}}},{title:n("oms.col_command_id","Command ID"),field:"command_id",width:100},{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:110},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:n("oms.col_position_id","Position ID"),field:"position_id",width:100},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("oms.col_side","Side"),field:"side",width:80,formatter:t=>te(t.getValue())},{title:n("oms.col_order_type","Order Type"),field:"order_type",width:100},{title:n("oms.col_status","Status"),field:"status",width:110},{title:n("oms.col_qty","Qty"),field:"qty",width:100,editor:"input"},{title:n("oms.col_price","Price"),field:"price",width:110,editor:"input"},{title:n("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120},{title:n("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120},{title:n("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:100},{title:n("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:120},{title:n("oms.col_reason","Reason"),field:"reason",width:120},{title:n("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:140},{title:n("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:140},{title:n("oms.col_comment","Comment"),field:"comment",width:180},{title:n("oms.col_created_at","Created At"),field:"created_at",width:170},{title:n("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:n("oms.col_closed_at","Closed At"),field:"closed_at",width:170},{title:"",field:"_save",width:46,hozAlign:"right",headerHozAlign:"right",headerSort:!1,formatter:()=>`<button data-act='apply' class='row-icon-btn' title='${n("common.apply","Apply")}' aria-label='${n("common.apply","Apply")}'><i class='fa-solid fa-floppy-disk icon-save' aria-hidden='true'></i></button>`,cellClick:async(t,e)=>{const s=(t?.target?.closest?t.target.closest("[data-act]"):null)?.dataset?.act;if(s!=="apply")return;const r=e.getRow().getData();try{await ca(r)}catch(i){_("open_order_inline_error",{action:s,error:String(i),row:r}),T("error",`Open order action failed (${s})`,{error:String(i),row:r})}}}],{selectableRows:!0,rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.historyPositions=R("historyPositionsTable",[fe("historyPositions"),{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("oms.col_side","Side"),field:"side",width:90,formatter:t=>te(t.getValue())},{title:n("oms.col_qty","Qty"),field:"qty",width:110},{title:n("oms.col_avg_price","Avg Price"),field:"avg_price",width:130},{title:n("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120},{title:n("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120},{title:n("oms.col_state","State"),field:"state",width:90},{title:n("oms.col_reason","Reason"),field:"reason",width:120},{title:n("oms.col_comment","Comment"),field:"comment",width:180},{title:n("oms.col_opened_at","Opened At"),field:"opened_at",width:170},{title:n("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:n("oms.col_closed_at","Closed At"),field:"closed_at",width:170}]),m.tables.historyOrders=R("historyOrdersTable",[fe("historyOrders"),{title:n("oms.col_command_id","Command ID"),field:"command_id",width:100},{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:n("oms.col_position_id","Position ID"),field:"position_id",width:100},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("oms.col_side","Side"),field:"side",width:80,formatter:t=>te(t.getValue())},{title:n("oms.col_order_type","Order Type"),field:"order_type",width:100},{title:n("oms.col_status","Status"),field:"status",width:110},{title:n("oms.col_qty","Qty"),field:"qty",width:100},{title:n("oms.col_price","Price"),field:"price",width:110},{title:n("oms.col_stop_loss","Stop Loss"),field:"stop_loss",width:120},{title:n("oms.col_stop_gain","Stop Gain"),field:"stop_gain",width:120},{title:n("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:100},{title:n("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:120},{title:n("oms.col_reason","Reason"),field:"reason",width:120},{title:n("oms.col_comment","Comment"),field:"comment",width:180},{title:n("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:140},{title:n("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:140},{title:n("oms.col_created_at","Created At"),field:"created_at",width:170},{title:n("oms.col_updated_at","Updated At"),field:"updated_at",width:170},{title:n("oms.col_closed_at","Closed At"),field:"closed_at",width:170}]),m.tables.omsSymbols=R("omsSymbolsTable",[{title:n("oms.col_symbol","Symbol"),field:"symbol",width:220},{title:n("oms.col_market_id","Market ID"),field:"market_id",width:220},{title:n("oms.col_base","Base"),field:"base",width:120},{title:n("oms.col_quote","Quote"),field:"quote",width:120},{title:n("oms.col_market_type","Type"),field:"type",width:120},{title:n("oms.col_market_active","Active"),field:"active",width:100,formatter:"tickCross"},{title:n("oms.col_price_decimals","Price Decimals"),field:"price_decimals",width:120},{title:n("oms.col_qty_decimals","Qty Decimals"),field:"qty_decimals",width:120},{title:n("oms.col_price_min","Min Price"),field:"price_min",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_price_max","Max Price"),field:"price_max",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_qty_min","Min Qty"),field:"qty_min",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_qty_max","Max Qty"),field:"qty_max",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_cost_min","Min Cost"),field:"cost_min",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_cost_max","Max Cost"),field:"cost_max",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_tick_size","Tick Size"),field:"tick_size",width:120,formatter:t=>ce(t.getValue())},{title:n("oms.col_step_size","Step Size"),field:"step_size",width:120,formatter:t=>ce(t.getValue())}]),m.tables.deals=R("dealsTable",[fe("deals"),{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:n("oms.col_order_id","Order ID"),field:"order_id",width:84},{title:n("oms.col_position_id","Position ID"),field:"position_id",width:90},{title:n("oms.col_strategy_id","Strategy ID"),field:"strategy_id",width:100},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("oms.col_side","Side"),field:"side",width:80,formatter:t=>te(t.getValue())},{title:n("oms.col_qty","Qty"),field:"qty",width:100},{title:n("oms.col_price","Price"),field:"price",width:120},{title:n("oms.col_fee","Fee"),field:"fee",width:100},{title:n("oms.col_fee_currency","Fee Ccy"),field:"fee_currency",width:100},{title:n("oms.col_pnl","PnL"),field:"pnl",width:100},{title:n("oms.col_reason","Reason"),field:"reason",width:120},{title:n("oms.col_reconciled","Reconciled"),field:"reconciled",width:110},{title:n("oms.col_comment","Comment"),field:"comment",width:180},{title:n("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:130},{title:n("oms.col_created_at","Created At"),field:"created_at",width:170},{title:n("oms.col_executed_at","Executed At"),field:"executed_at",width:170}]),m.tables.ccxtTrades=R("ccxtTradesTable",[fe("ccxtTrades"),{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:n("system.col_exchange_id","Exchange ID"),field:"exchange_id",width:140},{title:n("oms.col_exchange_trade_id","Exchange Trade ID"),field:"exchange_trade_id",width:150},{title:n("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("system.col_raw","Raw"),field:"raw_json",widthGrow:1,formatter:Ko},{title:n("system.col_observed_at","Observed At"),field:"observed_at",width:170}]),m.tables.ccxtOrders=R("ccxtOrdersTable",[fe("ccxtOrders"),{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:96},{title:n("system.col_exchange_id","Exchange ID"),field:"exchange_id",width:140},{title:n("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:n("oms.col_client_order_id","Client Order ID"),field:"client_order_id",width:150},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:120},{title:n("system.col_raw","Raw"),field:"raw_json",widthGrow:1,formatter:Ko},{title:n("system.col_observed_at","Observed At"),field:"observed_at",width:170}]),m.tables.events=R("eventsTable",[{title:n("system.col_seq","Seq"),field:"seq",width:70},{title:n("system.col_at","At"),field:"at",width:185},{title:n("system.col_kind","Kind"),field:"kind",width:170},{title:n("system.col_payload","Payload"),field:"payload",widthGrow:1}]),m.tables.uiLogs=R("uiLogsTable",[{title:n("system.col_seq","Seq"),field:"seq",width:70},{title:n("system.col_at","At"),field:"at",width:185},{title:n("system.col_level","Level"),field:"level",width:110},{title:n("system.col_message","Message"),field:"message",width:300},{title:n("system.col_payload","Payload"),field:"payload",widthGrow:1}],{pagination:!0,paginationMode:"local",paginationSize:100,paginationSizeSelector:[50,100,200,500,1e3]}),m.tables.postTrading=R("postTradingTable",[{title:n("oms.col_id","ID"),field:"id",width:84},{title:n("oms.col_account_id","Account ID"),field:"account_id",width:100},{title:n("system.col_exchange_id","Exchange"),field:"exchange_id",width:140},{title:n("oms.col_exchange_order_id","Exchange Order ID"),field:"exchange_order_id",width:150},{title:n("oms.col_symbol","Symbol"),field:"symbol",width:130},{title:n("oms.col_side","Side"),field:"side",width:80,formatter:t=>te(t.getValue())},{title:n("oms.col_qty","Qty"),field:"qty",width:120,hozAlign:"right",headerHozAlign:"right"},{title:n("oms.col_price","Price"),field:"price",width:120,hozAlign:"right",headerHozAlign:"right"},{title:n("oms.col_filled_qty","Filled Qty"),field:"filled_qty",width:120,hozAlign:"right",headerHozAlign:"right"},{title:n("oms.col_avg_fill_price","Avg Fill Price"),field:"avg_fill_price",width:130,hozAlign:"right",headerHozAlign:"right"},{title:n("oms.col_status","Status"),field:"status",width:120},{title:n("oms.col_reconciled","Reconciled"),field:"reconciled",width:110},{title:"Edit Replace State",field:"edit_replace_state",width:150},{title:"Edit Replace At",field:"edit_replace_at",width:170},{title:"Replace Origin Order",field:"edit_replace_origin_order_id",width:160},{title:"Replace Orphan Order",field:"edit_replace_orphan_order_id",width:160},{title:"Prev Position ID",field:"previous_position_id",width:130},{title:n("post_trading.col_target_strategy_id","Target Strategy ID"),field:"target_strategy_id",width:140,editor:"input",hozAlign:"right",headerHozAlign:"right"},{title:n("oms.col_strategy_id","Current Strategy ID"),field:"strategy_id",width:140,hozAlign:"right",headerHozAlign:"right"},{title:n("oms.col_created_at","Created At"),field:"created_at",width:170},{title:n("oms.col_executed_at","Executed At"),field:"executed_at",width:170}],{selectableRows:!0,rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.tradeStrategies=R("tradeStrategiesTable",Ui()),m.tables.adminOms=R("adminOmsTable",Es("open_orders"),{selectableRows:!0,movableColumns:!0,maxHeight:"420px",rowHeader:{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,resizable:!1,frozen:!0,width:40,minWidth:40}}),m.tables.adminAccounts=R("adminAccountsTable",bs()),m.tables.adminUsers=R("adminUsersTable",Ps()),m.tables.adminUsersKeys=R("adminUsersKeysTable",Is()),m.tables.adminUsersPermissions=R("adminUsersPermissionsTable",$s()),m.tables.userApiKeys=R("userApiKeysTable",Ts()),m.tables.userApiKeyPermissions=R("userApiKeyPermissionsTable",Os()),m.tables.riskPermissions=R("riskPermissionsTable",Ds())}async function kt(t=null){const e=t||C(),s=((await A("/admin/accounts",{},e)).items||[]).map(r=>({...r,extra_config_json:JSON.stringify(r.extra_config_json||{},null,2),set_api_key:"",set_secret:"",set_passphrase:""}));m.tables.adminAccounts.setData(s)}async function Oe(t=null){const e=t||C(),o=await A("/admin/users-api-keys",{},e),s=Array.isArray(o.items)?o.items:[];Qt("adminUsersKeys",s);const r=[];if(s.length>0){const i=new Map;for(const l of s)i.set(Number(l.api_key_id||0),l);const a=await Promise.all(s.map(async l=>{const u=Number(l.api_key_id||0);if(!Number.isFinite(u)||u<=0)return[];try{const h=await A(`/admin/api-keys/${u}/permissions`,{},e);return(Array.isArray(h.items)?h.items:[]).map(y=>{const S=i.get(u)||{};return{...y,api_key_id:u,user_id:Number(S.user_id||0)||null,user_name:String(S.user_name||"")}})}catch(h){return _("admin_load_api_key_permissions_error",{api_key_id:u,error:String(h)}),[]}}));for(const l of a)r.push(...l)}Qt("adminUsersPermissions",r,i=>[...i].sort((a,l)=>{const u=Number(a?.account_id||0),h=Number(l?.account_id||0);if(u!==h)return u-h;const f=Number(a?.api_key_id||0),y=Number(l?.api_key_id||0);return f-y}))}async function Yt(t=null){const e=t||C(),o=await A("/admin/users",{},e),s=Array.isArray(o.items)?o.items:[];Qt("adminUsers",s),Ci(s)}function Qe(t,e="info"){const o=document.getElementById("adminSystemStatusBox");o&&(o.textContent=String(t||"-"),o.classList.remove("notice-info","notice-success","notice-error"),e==="success"?o.classList.add("notice-success"):e==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"))}function z(t){return String(t??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function Bs(t,e,o=0){const s=Array.isArray(e);if(s||e!==null&&typeof e=="object"&&!s){const u=s?e.map((f,y)=>[String(y),f]):Object.entries(e);return u.length===0?`<li class="system-tree-leaf"><span class="k">${z(t)}</span><span class="v">${s?"[]":"{}"}</span></li>`:`<li class="system-tree-branch"><details open><summary><span class="folder">[+]</span><span class="k">${z(t)}</span><span class="meta">${z(s?`[${u.length}]`:`{${u.length}}`)}</span></summary><ul class="system-tree-list">${u.map(([f,y])=>Bs(f,y,o+1)).join("")}</ul></details></li>`}const i=e===null?"null":String(e),a=i.trim().toLowerCase();let l="v";return a==="ok"||a==="active"||a==="true"?l="v is-ok":a==="error"||a==="failed"||a==="false"?l="v is-error":/^-?\d+(\.\d+)?$/.test(a)?l=Number(a)>0?"v is-warn":"v is-muted":a==="null"&&(l="v is-muted"),`<li class="system-tree-leaf"><span class="k">${z(t)}</span><span class="${l}">${z(i)}</span></li>`}function Ho(t,e){const o=e===void 0?null:e;return`<div class="system-panel"><h4>${z(t)}</h4><ul class="system-tree-list root">${Bs("root",o,0)}</ul></div>`}function fa(t,e,o="",s=""){const r=document.getElementById("adminSystemStatusKpis"),i=document.getElementById("adminSystemStatusDetails");if(!r||!i)return;const a=Number(e?.started_at||0),l=a>0?new Date(a*1e3).toISOString():"-",u=Number(e?.ccxt_session_count_total??0),h=e?.ccxt_session_count_by_engine||{},f=Array.isArray(e?.ccxt_session_account_ids)?e.ccxt_session_account_ids:[],y=Number(e?.ccxt_session_oldest_age_seconds??0),S=Number(e?.ccxt_session_ttl_seconds??0);r.innerHTML=[`<div class="system-kpi"><span>${z(n("admin.api_status","API"))}</span><strong class="${t?"ok":"error"}">${z(t?String(t.status||"ok"):"error")}</strong></div>`,`<div class="system-kpi"><span>${z(n("admin.dispatcher_status","Dispatcher"))}</span><strong class="${e?"ok":"error"}">${z(e?"ok":"error")}</strong></div>`,`<div class="system-kpi"><span>DB</span><strong>${z(String(t?.db_engine||"-"))}</strong></div>`,`<div class="system-kpi"><span>Env</span><strong>${z(String(t?.env||"-"))}</strong></div>`,`<div class="system-kpi"><span>accounts_mapped</span><strong>${z(String(e?.accounts_mapped??"-"))}</strong></div>`,`<div class="system-kpi"><span>total_requests</span><strong>${z(String(e?.total_requests??"-"))}</strong></div>`,`<div class="system-kpi"><span>total_errors</span><strong>${z(String(e?.total_errors??"-"))}</strong></div>`,`<div class="system-kpi"><span>control_queue_depth</span><strong>${z(String(e?.control_queue_depth??"-"))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_count_total</span><strong>${z(String(u))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_count_by_engine</span><strong>${z(`${Number(h.ccxt||0)}/${Number(h.ccxtpro||0)}`)}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_accounts</span><strong>${z(String(f.length))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_oldest_age_s</span><strong>${z(String(y))}</strong></div>`,`<div class="system-kpi"><span>ccxt_session_ttl_s</span><strong>${z(String(S))}</strong></div>`,`<div class="system-kpi"><span>started_at</span><strong>${z(l)}</strong></div>`].join(""),i.innerHTML=[Ho("healthz",t||(o?{error:o}:{})),Ho("dispatcher/status",e||(s?{error:s}:{}))].join("")}function jo(t){const e=document.getElementById("adminSystemStatusDetails");e&&e.querySelectorAll("details").forEach(o=>{o.open=!!t})}async function At(t=null){const e=t||C();let o=null,s=null,r="",i="";try{const l=await fetch(`${e.baseUrl}/healthz`,{method:"GET"});if(!l.ok)throw new Error(`health ${l.status}`);o=await l.json()}catch(l){r=String(l)}try{s=(await A("/dispatcher/status",{},e))?.result||{}}catch(l){i=String(l)}if(fa(o,s,r,i),o&&s){const l=`${n("admin.api_status","API")}: ${String(o.status||"ok")} | ${n("admin.dispatcher_status","Dispatcher")}: ok`;Qe(l,"success");return}const a=`${n("admin.api_status","API")}: ${o?"ok":"error"}${r?` (${r})`:""} | ${n("admin.dispatcher_status","Dispatcher")}: ${s?"ok":"error"}${i?` (${i})`:""}`;Qe(a,"error")}async function ya(t=null){const e=t||C(),o=await A("/oms/cache/clear",{method:"POST"},e),s=o?.result||{},r=String(s.scope||"unknown"),i=Number(s.cleared_before||0);return Qe(n("admin.clear_oms_cache_ok","Cache OMS limpo ({scope}, antes={count}).").replace("{scope}",r).replace("{count}",String(i)),"success"),await At(e),o}async function Zt(t=null){const e=t||C(),o=await A("/user/profile",{},e),s=String(o.role||""),r=d("userProfileRole");if(r&&!Array.from(r.options||[]).some(i=>String(i.value)===s)){const i=document.createElement("option");i.value=s,i.textContent=s,r.appendChild(i)}return d("userProfileUserId").value=String(o.user_id||""),d("userProfileName").value=String(o.user_name||""),d("userProfileRole").value=s,d("userProfileRole").dataset.currentValue=s,d("userProfileStatus").value=String(o.status||""),d("userProfileApiKeyId").value=String(o.api_key_id||""),o}async function Ct(t=null){const e=t||C(),o=await A("/user/api-keys",{},e);return m.tables.userApiKeys.setData(o.items||[]),o}async function xt(t=null){const e=t||C();try{const o=await A("/user/api-keys/permissions",{},e);return m.tables.userApiKeyPermissions.setData(o.items||[]),o}catch(o){const s=String(o||""),r=s.match(/^(\d+)\b/),i=r?Number(r[1]):0;if(i===404||i===405)try{const a=await A("/user/api-keys",{},e),u=(Array.isArray(a?.items)?a.items:[]).map(y=>Number(y?.api_key_id||0)).filter(y=>Number.isFinite(y)&&y>0).map(async y=>{try{const S=await A(`/user/api-keys/${y}/permissions`,{},e);return Array.isArray(S?.items)?S.items:[]}catch{return[]}}),h=await Promise.all(u),f=ge(h.flat());return m.tables.userApiKeyPermissions.setData(f),f.length===0&&T("warn","User API key permissions endpoint unavailable",{status:i,error:s}),{items:f}}catch{return m.tables.userApiKeyPermissions.setData([]),T("warn","User API key permissions unavailable",{status:i,error:s}),{items:[]}}throw o}}async function ve(t=null){const e=t||C(),s=((await A("/strategies",{},e)).items||[]).slice().sort((r,i)=>{const a=f=>{const y=String(f||"").toLowerCase();return y==="active"?0:y==="disabled"?1:2},l=a(r?.status)-a(i?.status);if(l!==0)return l;const u=Number(r?.strategy_id||0),h=Number(i?.strategy_id||0);return u-h});m.tables.tradeStrategies.setData(s),Ai(s);for(const r of s)Number(r.strategy_id)>0&&be(M.strategyIds,Number(r.strategy_id));Bt()}async function Vo(t=null){const e=t||C(),o=Number(d("riskApiKeyId").value||0);if(!Number.isFinite(o)||o<=0)throw new Error("risk api_key_id is required");const s=await A(`/admin/api-keys/${o}/permissions`,{},e);m.tables.riskPermissions.setData(s.items||[]),_("risk_load_permissions",{api_key_id:o,rows:(s.items||[]).length})}async function Ms(t=null){const e=t||C(),o=await A("/meta/exchanges",{},e),s=d("adminExchangeIdSelect"),r=String(s.value||"").trim();s.innerHTML="";const i=l=>{const u=String(l||"").trim();if(!u)return"";const h=u.toLowerCase();return h.startsWith("ccxt.")||h.startsWith("ccxtpro.")?u:`ccxt.${u}`},a=(Array.isArray(o.items)?o.items:[]).map(l=>i(l)).filter(l=>!!l);for(const l of a){const u=document.createElement("option");u.value=String(l),u.textContent=String(l),s.appendChild(u)}r&&a.includes(r)?s.value=r:a.includes("ccxt.binance")?s.value="ccxt.binance":a[0]&&(s.value=String(a[0]))}async function Se(t=null){const e=t||C(),s=((await A("/oms/accounts",{},e)).items||[]).map(i=>({account_id:Number(i.account_id),label:String(i.label||"").trim(),trader_name:String(i.trader_name||"").trim(),exchange_id:String(i.exchange_id||"unknown").trim()||"unknown"})),r=s.map(i=>i.account_id).filter(i=>Number.isFinite(i)&&i>0);if(m.accountLabels.clear(),m.accountExchanges.clear(),s.forEach(i=>{if(Number.isFinite(i.account_id)&&i.account_id>0){const a=i.trader_name,l=i.label,u=m.userRole==="trader"?a||l:l||a;u&&m.accountLabels.set(i.account_id,u),m.accountExchanges.set(i.account_id,i.exchange_id)}}),m.availableAccountIds=r,r.length>0){if(cs(r),ls(r),r.forEach(i=>be(M.accountIds,i)),Pe().length===0)for(const i of d("viewAccountsSelect").options)i.selected=!0;Bt(),d("sendAccountId").value||(d("sendAccountId").value=String(r[0])),d("omsSymbolsAccountId").value||(d("omsSymbolsAccountId").value=String(r[0])),d("cancelOrderAccountId").value||(d("cancelOrderAccountId").value=String(r[0])),d("ccxtAccountId").value||(d("ccxtAccountId").value=String(r[0])),d("changeOrderAccountId").value||(d("changeOrderAccountId").value=String(r[0])),d("positionChangeAccountId").value||(d("positionChangeAccountId").value=String(r[0])),d("closeByAccountId").value||(d("closeByAccountId").value=String(r[0])),d("riskAccountId").value||(d("riskAccountId").value=String(r[0])),d("riskStrategyAccountId").value||(d("riskStrategyAccountId").value=String(r[0])),d("riskPermAccountId").value||(d("riskPermAccountId").value=String(r[0]))}_("accounts_loaded",{ids:r,labels:Object.fromEntries(m.accountLabels.entries())})}function ba(){Ri(),zi(),d("themeModeBtn").addEventListener("click",()=>Si()),d("densityModeBtn").addEventListener("click",()=>ki()),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{m.themeMode==="system"&&wt("system",!1)});try{Bi()}catch(c){_("bind_wa_tabs_error",{error:String(c)})}const t=()=>{const c=d("loginMode").value;d("loginApiKeyFields").classList.toggle("is-hidden",c!=="api_key"),d("loginUserPassFields").classList.toggle("is-hidden",c!=="user_password")};d("loginLanguage").addEventListener("change",()=>{const c=String(d("loginLanguage").value||"").trim();c&&(m.locale=c,localStorage.setItem(M.language,c),hs(),wt(m.themeMode,!1),$t(m.densityMode,!1))}),d("loginMode").addEventListener("change",t),t(),nt("info",""),d("loginForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=d("loginMode").value,g=d("baseUrl").value.trim().replace(/\/+$/,"");if(!g)throw new Error("base_url is required");if(p==="api_key"){m.userRole="";const b=d("apiKey").value.trim();if(!b)throw new Error("api_key is required");d("baseUrl").value=g,d("apiKey").value=b,Xt(),await Mo(),await Se({baseUrl:g,apiKey:b,viewAccountIds:[]}),await ve({baseUrl:g,apiKey:b,viewAccountIds:[]}),_("login_api_key_ok",{base_url:g}),nt("success",n("login.success","Autenticação concluída com sucesso."))}else{const b=d("loginUserName").value.trim(),v=d("loginPassword").value;if(!b||!v)throw new Error("user_name e password sao obrigatorios");const k={user_name:b,password:v},E=await fetch(`${g}/auth/login-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),I=await E.text(),D=I?JSON.parse(I):{};if(!E.ok)throw new Error(`${E.status} ${JSON.stringify(D)}`);d("baseUrl").value=g;const O=String(D.token||"");d("apiKey").value=O,m.userRole=String(D.role||"").trim().toLowerCase(),Xt(),await Mo(),await Se({baseUrl:g,apiKey:O,viewAccountIds:[]}),await ve({baseUrl:g,apiKey:O,viewAccountIds:[]}),_("login_user_password_ok",{user_id:D.user_id,role:D.role,api_key_id:D.api_key_id,expires_at:D.expires_at}),nt("success",n("login.success","Autenticação concluída com sucesso."))}}catch(p){_("login_error",{error:String(p)}),nt("error",`${n("login.error","Erro na autenticação")}: ${String(p)}`)}}),d("toggleApiKeyBtn").addEventListener("click",()=>{const c=d("apiKey"),p=c.type==="password"?"text":"password";c.type=p,fs()}),d("toggleLoginPasswordBtn").addEventListener("click",()=>{const c=d("loginPassword"),p=c.type==="password"?"text":"password";c.type=p,ys()}),d("connectBtn").addEventListener("click",async()=>{try{await ga()}catch(c){ke(String(c),!1)}}),d("disconnectBtn").addEventListener("click",()=>Ls()),d("refreshOmsBtn").addEventListener("click",async()=>{try{await aa(),_("refresh_ok",{})}catch(c){_("refresh_error",{error:String(c)})}}),d("accountsBtn").addEventListener("click",async()=>{try{await Se()}catch(c){_("accounts_error",{error:String(c)})}}),d("refreshOpenPositionsBtn").addEventListener("click",async()=>{try{await Re(),_("refresh_open_positions_ok",{})}catch(c){_("refresh_open_positions_error",{error:String(c)})}}),d("closeSelectedPositionsBtn").addEventListener("click",async()=>{try{await da()}catch(c){const p=String(c||"");p.includes("select_rows")?me("error",n("oms.select_open_positions_first","Select one or more open positions first")):(_("close_selected_positions_error",{error:p}),me("error",`${n("oms.bulk_close_positions_failed","Close selected positions failed")}: ${p}`))}}),d("refreshOpenOrdersBtn").addEventListener("click",async()=>{try{await ot(),_("refresh_open_orders_ok",{})}catch(c){_("refresh_open_orders_error",{error:String(c)})}}),d("cancelSelectedOrdersBtn").addEventListener("click",async()=>{try{await ua()}catch(c){const p=String(c||"");p.includes("select_rows")?me("error",n("oms.select_open_orders_first","Select one or more open orders first")):(_("cancel_selected_orders_error",{error:p}),me("error",`${n("oms.bulk_cancel_orders_failed","Cancel selected orders failed")}: ${p}`))}}),d("refreshDealsBtn").addEventListener("click",async()=>{try{await K("deals",!0),_("refresh_deals_ok",{})}catch(c){_("refresh_deals_error",{error:String(c)})}}),d("refreshHistoryPositionsBtn").addEventListener("click",async()=>{try{await K("historyPositions",!0),_("refresh_history_positions_ok",{})}catch(c){_("refresh_history_positions_error",{error:String(c)})}}),d("refreshHistoryOrdersBtn").addEventListener("click",async()=>{try{await K("historyOrders",!0),_("refresh_history_orders_ok",{})}catch(c){_("refresh_history_orders_error",{error:String(c)})}}),d("refreshOmsSymbolsBtn").addEventListener("click",async()=>{try{await ps(!0),_("refresh_oms_symbols_ok",{})}catch(c){_("refresh_oms_symbols_error",{error:String(c)}),T("error","OMS symbol list load failed",{error:String(c)})}});for(const c of _o){const p=document.getElementById(`${c}PrevPageBtn`),g=document.getElementById(`${c}NextPageBtn`),b=document.getElementById(`${c}PageInput`),v=document.getElementById(`${c}PageSize`),k=document.getElementById(`${c}CopyBtn`),E=document.getElementById(`${c}ExportCsvBtn`),I=document.getElementById(`${c}ExportExcelBtn`),D=document.getElementById(`${c}ExportJsonBtn`),O=document.getElementById(`${c}ExportHtmlBtn`);p&&p.addEventListener("click",async()=>{try{await mt(c,(m.omsPager[c]?.page||1)-1)}catch(x){_("oms_pager_prev_error",{key:c,error:String(x)})}}),g&&g.addEventListener("click",async()=>{try{await mt(c,(m.omsPager[c]?.page||1)+1)}catch(x){_("oms_pager_next_error",{key:c,error:String(x)})}}),b&&(b.addEventListener("keydown",async x=>{if(x.key==="Enter"){x.preventDefault();try{await mt(c,Number(b.value||1))}catch(H){_("oms_pager_page_input_error",{key:c,error:String(H)})}}}),b.addEventListener("blur",async()=>{try{await mt(c,Number(b.value||1))}catch(x){_("oms_pager_page_blur_error",{key:c,error:String(x)})}})),v&&v.addEventListener("change",async()=>{try{await ra(c,Number(v.value||m.omsPageSize))}catch(x){_("oms_pager_size_error",{key:c,error:String(x)})}}),k&&k.addEventListener("click",async()=>{try{await sa(c)}catch(x){_("oms_copy_error",{key:c,error:String(x)}),T("error",`OMS copy failed (${c})`,{error:String(x)})}}),E&&E.addEventListener("click",()=>{try{ut(c,"csv")}catch(x){_("oms_export_csv_error",{key:c,error:String(x)})}}),I&&I.addEventListener("click",()=>{try{ut(c,"excel")}catch(x){_("oms_export_excel_error",{key:c,error:String(x)})}}),D&&D.addEventListener("click",()=>{try{ut(c,"json")}catch(x){_("oms_export_json_error",{key:c,error:String(x)})}}),O&&O.addEventListener("click",()=>{try{ut(c,"html")}catch(x){_("oms_export_html_error",{key:c,error:String(x)})}})}for(const c of ns){const p=document.getElementById(`${c}PrevPageBtn`),g=document.getElementById(`${c}NextPageBtn`),b=document.getElementById(`${c}PageInput`),v=document.getElementById(`${c}PageSize`);p&&p.addEventListener("click",()=>{try{pt(c,(m.adminPager[c]?.page||1)-1)}catch(k){_("admin_pager_prev_error",{key:c,error:String(k)})}}),g&&g.addEventListener("click",()=>{try{pt(c,(m.adminPager[c]?.page||1)+1)}catch(k){_("admin_pager_next_error",{key:c,error:String(k)})}}),b&&(b.addEventListener("keydown",k=>{if(k.key==="Enter"){k.preventDefault();try{pt(c,Number(b.value||1))}catch(E){_("admin_pager_page_input_error",{key:c,error:String(E)})}}}),b.addEventListener("blur",()=>{try{pt(c,Number(b.value||1))}catch(k){_("admin_pager_page_blur_error",{key:c,error:String(k)})}})),v&&v.addEventListener("change",()=>{try{ia(c,Number(v.value||m.adminPager[c]?.pageSize||20))}catch(k){_("admin_pager_size_error",{key:c,error:String(k)})}})}d("closeByModalCancelBtn").addEventListener("click",()=>xs()),d("closeByModalConfirmBtn").addEventListener("click",async()=>{try{await pa()}catch(c){_("open_position_close_by_inline_error",{error:String(c)}),T("error","Open position action failed (close_by)",{error:String(c)})}}),d("refreshCcxtOrdersBtn").addEventListener("click",async()=>{try{await K("ccxtOrders",!0),_("refresh_ccxt_orders_ok",{})}catch(c){_("refresh_ccxt_orders_error",{error:String(c)}),T("error","Refresh CCXT orders failed",{error:String(c)})}}),d("refreshCcxtTradesBtn").addEventListener("click",async()=>{try{await K("ccxtTrades",!0),_("refresh_ccxt_trades_ok",{})}catch(c){_("refresh_ccxt_trades_error",{error:String(c)}),T("error","Refresh CCXT trades failed",{error:String(c)})}}),d("postTradingPreviewBtn").addEventListener("click",async()=>{try{await st(!0),_("post_trading_preview_ok",{})}catch(c){_("post_trading_preview_error",{error:String(c)}),oe("error",`${n("post_trading.preview_error","Preview failed")}: ${String(c)}`)}}),d("postTradingReconcileBtn").addEventListener("click",async()=>{try{await va()}catch(c){const p=String(c||"");p.includes("period_requires_date_range")?oe("error",n("post_trading.period_requires_date_range","Para scope Período, preencha Data Início e Data Fim.")):oe("error",`${n("post_trading.reconcile_error","Erro ao reconciliar")}: ${p}`),_("post_trading_reconcile_error",{error:String(c)})}}),d("postTradingApplyBtn").addEventListener("click",async()=>{try{await Sa()}catch(c){const p=String(c||"");p.includes("post_trading_select_rows")?oe("error",n("post_trading.select_rows","Select one or more rows to apply reassign.")):p.includes("post_trading_target_strategy_required")?oe("error",n("post_trading.target_strategy_required","Preencha o ID da estratégia alvo (> 0) nas linhas selecionadas.")):oe("error",`${n("post_trading.apply_error","Apply reassign failed")}: ${p}`),_("post_trading_apply_error",{error:String(c)})}}),d("clearEventsBtn").addEventListener("click",()=>m.tables.events.clearData()),d("clearUiLogsViewBtn").addEventListener("click",()=>{m.tables.uiLogs.clearData(),m.uiLogSeq=0,Me(),T("info","UI logs view cleared",{scope_hash:Je()})}),d("clearUiLogsDbBtn").addEventListener("click",async()=>{try{await ji(),m.tables.uiLogs.clearData(),m.uiLogSeq=0,Me(),T("warn","UI logs local db cleared",{scope_hash:Je()})}catch(c){T("error","UI logs local db clear failed",{error:String(c)})}}),d("uiLogsPrevPageBtn").addEventListener("click",async()=>{try{await ct(Number(m.tables.uiLogs.getPage?.()||1)-1)}catch(c){_("ui_logs_pager_prev_error",{error:String(c)})}}),d("uiLogsNextPageBtn").addEventListener("click",async()=>{try{await ct(Number(m.tables.uiLogs.getPage?.()||1)+1)}catch(c){_("ui_logs_pager_next_error",{error:String(c)})}}),d("uiLogsPageInput").addEventListener("keydown",async c=>{if(c.key==="Enter"){c.preventDefault();try{await ct(Number(d("uiLogsPageInput").value||1))}catch(p){_("ui_logs_pager_input_error",{error:String(p)})}}}),d("uiLogsPageInput").addEventListener("blur",async()=>{try{await ct(Number(d("uiLogsPageInput").value||1))}catch(c){_("ui_logs_pager_blur_error",{error:String(c)})}}),d("uiLogsPageSize").addEventListener("change",async()=>{try{await Vi(Number(d("uiLogsPageSize").value||100))}catch(c){_("ui_logs_pager_size_error",{error:String(c)})}}),d("selectAllAccountsBtn").addEventListener("click",()=>{for(const c of d("viewAccountsSelect").options)c.selected=!0}),d("clearAccountsBtn").addEventListener("click",()=>{for(const c of d("viewAccountsSelect").options)c.selected=!1}),d("tradeStrategyAccountsAllBtn").addEventListener("click",()=>{for(const c of d("tradeStrategyAccountIds").options)c.selected=!0}),d("tradeStrategyAccountsClearBtn").addEventListener("click",()=>{for(const c of d("tradeStrategyAccountIds").options)c.selected=!1}),d("goToCreateStrategyBtn").addEventListener("click",()=>{N("strategies");const c=document.getElementById("tradeCreateStrategyForm"),p=c?c.querySelector("input[name='name']"):null;p&&typeof p.focus=="function"&&p.focus()});const e=()=>{const c=d("ccxtMode").value;d("ccxtGenericFields").classList.toggle("is-hidden",c!=="generic"),d("ccxtCoreFields").classList.toggle("is-hidden",c!=="core")},o={load_markets:{reload:!1,params:{}},fetch_markets:{params:{}},fetch_ticker:{symbol:"BTC/USDT",params:{}},fetch_tickers:{symbols:null,params:{}},fetch_balance:{},fetch_open_orders:{symbol:"BTC/USDT",since:null,limit:200,params:{}},fetch_order:{id:"",symbol:null,params:{}},cancel_order:{id:"",symbol:null,params:{}},create_order:{symbol:"BTC/USDT",side:"buy",order_type:"market",amount:"0.001",params:{}}},s=()=>{const c=d("ccxtCoreFunc").value,p=o[c]||{};d("ccxtCoreBody").value=JSON.stringify(p,null,2)};d("ccxtMode").addEventListener("change",e),d("ccxtCoreFunc").addEventListener("change",s),e(),s(),d("loadSymbolsBtn").addEventListener("click",async()=>{try{const c=C(),p=U("sendAccountId","send_order"),g=await A(`/ccxt/${p}/load_markets`,{method:"POST",body:{args:[],kwargs:{}}},c),b=us(g.result),v=ms(b);He("symbolHistory",v.slice(0,2e3)),!d("sendSymbol").value&&v[0]&&(d("sendSymbol").value=v[0]),_("load_symbols",{account_id:p,count:v.length}),T("info","Load symbols ok",{account_id:p,count:v.length,sample:v.slice(0,5)})}catch(c){_("load_symbols_error",{error:String(c)}),T("error","Load symbols failed",{error:String(c)})}}),d("sendOrderForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=new FormData(c.currentTarget),b=U("sendAccountId","send_order"),v=vt("sendStrategyId"),k={account_id:b,command:"send_order",payload:{symbol:String(g.get("symbol")||""),side:String(g.get("side")||"buy"),order_type:String(g.get("order_type")||"market"),qty:String(g.get("qty")||""),strategy_id:v,position_id:Number(g.get("position_id")||0)||0,post_only:g.get("post_only")==="on",reduce_only:g.get("reduce_only")==="on"}},E=String(g.get("time_in_force")||"").trim(),I=String(g.get("price")||"").trim(),D=String(g.get("trigger_price")||"").trim(),O=String(g.get("stop_price")||"").trim(),x=String(g.get("take_profit_price")||"").trim(),H=String(g.get("trailing_amount")||"").trim(),ne=String(g.get("trailing_percent")||"").trim();I&&(k.payload.price=I),E&&(k.payload.time_in_force=E),D&&(k.payload.trigger_price=D),O&&(k.payload.stop_price=O),x&&(k.payload.take_profit_price=x),H&&(k.payload.trailing_amount=H),ne&&(k.payload.trailing_percent=ne);const rt=String(g.get("oms_stop_loss")||"").trim(),go=String(g.get("oms_stop_gain")||"").trim(),ho=String(g.get("comment")||"").trim(),fo=String(g.get("params_json")||"").trim();rt&&(k.payload.oms_stop_loss=rt),go&&(k.payload.oms_stop_gain=go),ho&&(k.payload.comment=ho),fo&&(k.payload.params=le(fo,{}));const Vs=await A("/oms/commands",{method:"POST",body:k},p);_("send_order",Vs)}catch(p){_("send_order_error",{error:String(p)})}}),d("cancelOrderForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("cancelOrderAccountId","cancel_order"),b=new FormData(c.currentTarget),v=String(b.get("order_ids_csv")||"").trim();if(!v)throw new Error("order_ids_csv is required");const k=ht(v);if(k.length===0)throw new Error("nenhum order_id válido no CSV");const E={account_id:g,command:"cancel_order",payload:{order_id:k.length===1?k[0]:null,order_ids:k,order_ids_csv:v}},I=await A("/oms/commands",{method:"POST",body:E},p);_("cancel_order",{account_id:g,count:k.length,out:I})}catch(p){_("cancel_order_error",{error:String(p)})}}),d("cancelAllBtn").addEventListener("click",async()=>{try{const c=C(),p=U("cancelOrderAccountId","cancel_all_orders"),g=String(d("cancelAllStrategyIdsCsv").value||"").trim(),b=ht(g),k=await A("/oms/commands",{method:"POST",body:{account_id:p,command:"cancel_all_orders",payload:{strategy_ids:b,strategy_ids_csv:g||null}}},c);_("cancel_all_orders",{account_id:p,strategy_ids:b,out:k})}catch(c){_("cancel_all_orders_error",{error:String(c)})}}),d("changeOrderForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("changeOrderAccountId","change_order"),b=new FormData(c.currentTarget),k={order_id:Number(b.get("order_id"))},E=String(b.get("new_qty")||"").trim(),I=String(b.get("new_price")||"").trim();E&&(k.new_qty=E),I&&(k.new_price=I);const O=await A("/oms/commands",{method:"POST",body:{account_id:g,command:"change_order",payload:k}},p);_("change_order",{account_id:g,out:O})}catch(p){_("change_order_error",{error:String(p)})}}),d("positionChangeForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("positionChangeAccountId","position_change"),b=new FormData(c.currentTarget),k={position_id:Number(b.get("position_id"))},E=String(b.get("oms_stop_loss")||"").trim(),I=String(b.get("oms_stop_gain")||"").trim(),D=String(b.get("comment")||"").trim(),O=d("positionChangeUseStopLoss").checked,x=d("positionChangeUseStopGain").checked,H=d("positionChangeUseComment").checked;if(O&&(k.oms_stop_loss=E||null),x&&(k.oms_stop_gain=I||null),H&&(k.comment=D||null),!O&&!x&&!H)throw new Error("marque ao menos um campo para alterar");const rt=await A("/oms/commands",{method:"POST",body:{account_id:g,command:"position_change",payload:k}},p);_("position_change",{account_id:g,out:rt})}catch(p){_("position_change_error",{error:String(p)})}}),d("closePositionForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("closePositionAccountId","close_position"),b=new FormData(c.currentTarget),v=Number(b.get("position_id"));if(!Number.isFinite(v)||v<=0)throw new Error("position_id is required");const k=String(b.get("oms_stop_loss")||"").trim(),E=String(b.get("oms_stop_gain")||"").trim(),I=String(b.get("comment")||"").trim(),D=String(b.get("params_json")||"").trim(),O={position_id:v,order_type:"market",post_only:b.get("post_only")==="on",reduce_only:b.get("reduce_only")==="on"};k&&(O.oms_stop_loss=k),E&&(O.oms_stop_gain=E),I&&(O.comment=I),D&&(O.params=le(D,{}));const H=await A("/oms/commands",{method:"POST",body:{account_id:g,command:"close_position",payload:O}},p);_("close_position",{account_id:g,position_id:v,out:H})}catch(p){_("close_position_error",{error:String(p)})}}),d("closeByForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("closeByAccountId","close_by"),b=new FormData(c.currentTarget),v=Number(b.get("position_id_a")),k=Number(b.get("position_id_b"));if(!Number.isFinite(v)||v<=0)throw new Error("position_id_a is required");if(!Number.isFinite(k)||k<=0)throw new Error("position_id_b is required");const E=String(b.get("qty")||"").trim(),I={account_id:g,command:"close_by",payload:{position_id_a:v,position_id_b:k}};E&&(I.payload.qty=E);const D=await A("/oms/commands",{method:"POST",body:I},p);_("close_by",{account_id:g,out:D})}catch(p){_("close_by_error",{error:String(p)})}}),d("mergePositionsForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("mergePositionsAccountId","merge_positions"),b=new FormData(c.currentTarget),v=Number(b.get("source_position_id")),k=Number(b.get("target_position_id"));if(!Number.isFinite(v)||v<=0)throw new Error("source_position_id is required");if(!Number.isFinite(k)||k<=0)throw new Error("target_position_id is required");if(v===k)throw new Error("source_position_id and target_position_id must differ");const E={source_position_id:v,target_position_id:k,stop_mode:String(b.get("stop_mode")||"keep").trim()||"keep"},I=String(b.get("oms_stop_loss")||"").trim(),D=String(b.get("oms_stop_gain")||"").trim();I&&(E.oms_stop_loss=I),D&&(E.oms_stop_gain=D);const x=await A("/oms/commands",{method:"POST",body:{account_id:g,command:"merge_positions",payload:E}},p);_("merge_positions",{account_id:g,out:x})}catch(p){_("merge_positions_error",{error:String(p)})}}),d("ccxtCallForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=U("ccxtAccountId","ccxt_call"),b=vt("ccxtStrategyId"),v=new FormData(c.currentTarget);if(d("ccxtMode").value==="core"){const E=String(v.get("core_func")||"").trim(),I=le(String(v.get("core_body")||"{}"),{}),D=await A(`/ccxt/core/${g}/${encodeURIComponent(E)}`,{method:"POST",body:I},p);Kt(D),_("ccxt_core_call",{strategy_id:b,func:E,out:D});const O=D.result||{};O.account_id=O.account_id||g,(O.exchange_trade_id||E.includes("trade"))&&pe(m.tables.ccxtTrades,O),(O.exchange_order_id||E.includes("order"))&&pe(m.tables.ccxtOrders,O)}else{const E=String(v.get("func")||"").trim(),I=le(String(v.get("args")||"[]"),[]),D=le(String(v.get("kwargs")||"{}"),{}),O=await A(`/ccxt/${g}/${encodeURIComponent(E)}`,{method:"POST",body:{args:I,kwargs:D}},p);Kt(O),_("ccxt_call",{strategy_id:b,func:E,out:O});const x=O.result||{};x.account_id=x.account_id||g,(x.exchange_trade_id||E.includes("trade"))&&pe(m.tables.ccxtTrades,x),(x.exchange_order_id||E.includes("order"))&&pe(m.tables.ccxtOrders,x)}}catch(p){Kt({ok:!1,error:String(p)}),_("ccxt_call_error",{error:String(p)})}}),d("adminCreateAccountForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=new FormData(c.currentTarget),b=await A("/admin/accounts",{method:"POST",body:{exchange_id:String(g.get("exchange_id")||"").trim(),label:String(g.get("label")||"").trim(),position_mode:String(g.get("position_mode")||"hedge"),is_testnet:g.get("is_testnet")==="on",extra_config_json:le(String(g.get("extra_config_json")||"{}"),{})}},p);_("admin_create_account",b),await Se(p),await kt(p)}catch(p){_("admin_create_account_error",{error:String(p)})}}),d("userProfileForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=String(d("userProfileName").value||"").trim();if(!g)throw new Error("user_name is required");const b=await A("/user/profile",{method:"PATCH",body:{user_name:g}},p);_("user_profile_update",b),await Zt(p),X("success",n("user.profile_updated","Perfil atualizado com sucesso."))}catch(p){_("user_profile_update_error",{error:String(p)}),X("error",`${n("user.profile_update_error","Erro ao atualizar perfil")}: ${String(p)}`)}}),d("userPasswordForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=String(d("userCurrentPassword").value||""),b=String(d("userNewPassword").value||"");if(!g||!b)throw new Error("current_password and new_password are required");const v=await A("/user/password",{method:"POST",body:{current_password:g,new_password:b}},p);_("user_password_update",v),d("userCurrentPassword").value="",d("userNewPassword").value="",X("success",n("user.password_updated","Senha atualizada com sucesso."))}catch(p){_("user_password_update_error",{error:String(p)}),X("error",`${n("user.password_update_error","Erro ao atualizar senha")}: ${String(p)}`)}}),d("userCreateApiKeyForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=String(d("userNewApiKeyValue").value||"").trim(),b={};g&&(b.api_key=g);const v=await A("/user/api-keys",{method:"POST",body:b},p);_("user_create_api_key",v),d("userNewApiKeyValue").value="";const k=d("userCreatedApiKeyBox");k.textContent=n("user.api_key_created","API Key criada. id={api_key_id} key={key}").replace("{api_key_id}",String(v.api_key_id||"")).replace("{key}",String(v.api_key_plain||"")),k.classList.remove("is-hidden","notice-error"),k.classList.add("notice-info"),await Promise.all([Ct(p),xt(p)]),X("success",n("user.api_key_created_success","API Key criada com sucesso."))}catch(p){_("user_create_api_key_error",{error:String(p)});const g=d("userCreatedApiKeyBox");g.textContent=`${n("user.api_key_create_error","Erro ao criar API Key")}: ${String(p)}`,g.classList.remove("is-hidden","notice-info"),g.classList.add("notice-error"),X("error",`${n("user.api_key_create_error","Erro ao criar API Key")}: ${String(p)}`)}}),d("loadUserApiKeysBtn").addEventListener("click",async()=>{try{const c=C();await Promise.all([Zt(c),Ct(c),xt(c)]),X("success",n("user.reloaded","Dados do usuário recarregados."))}catch(c){_("user_load_error",{error:String(c)}),X("error",`${n("user.load_error","Erro ao carregar dados do usuário")}: ${String(c)}`)}}),d("adminCreateUserApiKeyForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=new FormData(c.currentTarget),b=le(String(g.get("permissions")||"[]"),[]),v=await A("/admin/users-with-api-key",{method:"POST",body:{user_name:String(g.get("user_name")||"").trim(),role:String(g.get("role")||"trader").trim(),password:String(g.get("password")||"").trim()||null,permissions:b}},p);_("admin_create_user_api_key",v),v.api_key_plain&&(d("loginMode").value="api_key",d("apiKey").value=String(v.api_key_plain),t()),await Yt(p),await Oe(p)}catch(p){_("admin_create_user_api_key_error",{error:String(p)})}});const r=document.getElementById("adminOmsViewTabs");if(r){const c=()=>{const p=String(r.active||r.getAttribute("active")||"open_orders");m.adminOmsView=p||"open_orders"};c(),r.addEventListener("click",async p=>{const g=p.target&&p.target.closest?p.target.closest("wa-tab"):null,b=String(g?.getAttribute?.("panel")||"").trim();if(b){m.adminOmsView=b,r.active=b,r.setAttribute("active",b);try{await _e(!0)}catch(v){_("admin_oms_change_view_error",{error:String(v)})}}}),r.addEventListener("wa-tab-show",async()=>{c();try{await _e(!0)}catch(p){_("admin_oms_change_view_error",{error:String(p)})}})}d("adminOmsLoadBtn").addEventListener("click",async()=>{try{await _e(!0),Q("info",""),_("admin_oms_load",{ok:!0})}catch(c){_("admin_oms_load_error",{error:String(c)}),Q("error",`${n("admin.oms_load_error","Erro ao carregar Admin OMS")}: ${String(c)}`),T("error","Admin OMS load failed",{error:String(c)})}}),d("adminOmsAddRowBtn").addEventListener("click",()=>xa()),d("adminOmsSaveSelectedBtn").addEventListener("click",async()=>{try{await La()}catch(c){_("admin_oms_save_error",{error:String(c)});const p=String(c||"");p.includes("admin_oms_unlock_required")?Q("error",n("admin.oms_unlock_before_save","Ative 'Unlock dangerous mode' antes de salvar.")):p.includes("admin_oms_select_rows")?Q("error",n("admin.oms_select_rows","Selecione uma ou mais linhas no checkbox da esquerda.")):Q("error",`${n("admin.oms_save_error","Erro ao salvar")}: ${p}`),T("error","Admin OMS save failed",{error:String(c)})}}),d("adminOmsDeleteSelectedBtn").addEventListener("click",async()=>{try{await Ea()}catch(c){_("admin_oms_delete_error",{error:String(c)});const p=String(c||"");p.includes("admin_oms_unlock_required")?Q("error",n("admin.oms_unlock_before_delete","Ative 'Unlock dangerous mode' antes de deletar.")):p.includes("admin_oms_select_rows")?Q("error",n("admin.oms_select_rows","Selecione uma ou mais linhas no checkbox da esquerda.")):Q("error",`${n("admin.oms_delete_error","Erro ao deletar")}: ${p}`),T("error","Admin OMS delete failed",{error:String(c)})}}),d("loadAdminAccountsBtn").addEventListener("click",async()=>{try{await kt(),_("admin_load_accounts",{ok:!0}),St("info",n("admin.accounts_loaded","Contas carregadas."))}catch(c){_("admin_load_accounts_error",{error:String(c)}),St("error",`${n("admin.accounts_load_error","Erro ao carregar contas")}: ${String(c)}`)}}),d("adminRefreshSystemStatusBtn").addEventListener("click",async()=>{try{await At(),_("admin_system_status_refresh_ok",{ok:!0})}catch(c){_("admin_system_status_refresh_error",{error:String(c)}),Qe(`${n("admin.status_error","Erro ao consultar estado")}: ${String(c)}`,"error")}});const i=document.getElementById("adminClearOmsCacheBtn");i&&i.addEventListener("click",async()=>{try{const c=await ya();_("admin_oms_cache_clear_ok",c?.result||{})}catch(c){_("admin_oms_cache_clear_error",{error:String(c)}),Qe(`${n("admin.clear_oms_cache_error","Erro ao limpar cache OMS")}: ${String(c)}`,"error")}});const a=document.getElementById("adminExpandSystemTreeBtn");a&&a.addEventListener("click",()=>jo(!0));const l=document.getElementById("adminCollapseSystemTreeBtn");l&&l.addEventListener("click",()=>jo(!1)),d("loadAdminUsersKeysBtn").addEventListener("click",async()=>{try{await Oe(),_("admin_load_users_keys",{ok:!0})}catch(c){_("admin_load_users_keys_error",{error:String(c)})}}),d("loadAdminUsersBtn").addEventListener("click",async()=>{try{await Yt(),_("admin_load_users",{ok:!0})}catch(c){_("admin_load_users_error",{error:String(c)})}}),d("adminCreateApiKeyForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=Number(d("adminApiKeyUserId").value||0);if(!Number.isFinite(g)||g<=0)throw new Error("user_id inválido");const b=String(d("adminApiKeyLabel").value||"").trim(),v=String(d("adminApiKeyValue").value||"").trim(),k={user_id:g};v&&(k.api_key=v),b&&(k.label=b);const E=await A("/admin/api-keys",{method:"POST",body:k},p);_("admin_create_api_key",E);const I=String(E.api_key_plain||"");Bo("success",n("admin.api_key_created","API Key criada. user_id={user_id} api_key_id={api_key_id} key={key}").replace("{user_id}",String(E.user_id)).replace("{api_key_id}",String(E.api_key_id)).replace("{key}",I)),xi({userId:g,apiKeyId:Number(E.api_key_id||0),key:I,label:b}),await Oe(p)}catch(p){_("admin_create_api_key_error",{error:String(p)}),Bo("error",`${n("admin.api_key_create_error","Erro ao criar API Key")}: ${String(p)}`),T("error","Admin create API key failed",{error:String(p)})}});const u=document.getElementById("adminApiKeyCreatedCopyBtn");u&&u.addEventListener("click",async()=>{const c=document.getElementById("adminApiKeyCreatedValue"),p=c?String(c.value||""):"";try{if(!p)throw new Error("api_key_empty");if(!navigator.clipboard||typeof navigator.clipboard.writeText!="function")throw new Error("clipboard_unavailable");await navigator.clipboard.writeText(p),T("success",n("admin.api_key_modal_copy_success","API Key copied to clipboard"))}catch(g){T("error","API key copy failed",{error:String(g)})}});const h=document.getElementById("adminApiKeyCreatedCloseBtn");h&&h.addEventListener("click",()=>Li()),d("loadCcxtExchangesBtn").addEventListener("click",async()=>{try{await Ms(),_("admin_load_ccxt_exchanges",{ok:!0})}catch(c){_("admin_load_ccxt_exchanges_error",{error:String(c)})}}),d("tradeCreateStrategyForm").addEventListener("submit",async c=>{c.preventDefault();try{const p=C(),g=new FormData(c.currentTarget),b=await A("/strategies",{method:"POST",body:{name:String(g.get("name")||"").trim(),account_ids:Ei(),client_strategy_id:ds(g.get("client_strategy_id"),"client_strategy_id")}},p);_("trade_create_strategy",b),await ve(p)}catch(p){_("trade_create_strategy_error",{error:String(p)})}}),d("loadTradeStrategiesBtn").addEventListener("click",async()=>{try{await ve(),_("trade_load_strategies",{ok:!0})}catch(c){_("trade_load_strategies_error",{error:String(c)})}}),d("riskAllowNewPositionsBtn").addEventListener("click",async()=>{try{const c=C(),p=U("riskAccountId","risk"),g=String(d("riskAccountComment").value||"").trim();if(!g)throw new Error("risk comment is required");const b=await A(`/oms/risk/${p}/allow_new_positions`,{method:"POST",body:{allow_new_positions:!0,comment:g}},c);_("risk_allow_new_positions",b)}catch(c){_("risk_allow_new_positions_error",{error:String(c)})}}),d("riskBlockNewPositionsBtn").addEventListener("click",async()=>{try{const c=C(),p=U("riskAccountId","risk"),g=String(d("riskAccountComment").value||"").trim();if(!g)throw new Error("risk comment is required");const b=await A(`/oms/risk/${p}/allow_new_positions`,{method:"POST",body:{allow_new_positions:!1,comment:g}},c);_("risk_block_new_positions",b)}catch(c){_("risk_block_new_positions_error",{error:String(c)})}}),d("riskSetAccountActiveBtn").addEventListener("click",async()=>{try{const c=C(),p=U("riskAccountId","risk"),g=String(d("riskAccountComment").value||"").trim();if(!g)throw new Error("risk comment is required");const b=await A(`/oms/risk/${p}/status`,{method:"POST",body:{status:"active",comment:g}},c);_("risk_set_account_active",b)}catch(c){_("risk_set_account_active_error",{error:String(c)})}}),d("riskSetAccountBlockedBtn").addEventListener("click",async()=>{try{const c=C(),p=U("riskAccountId","risk"),g=String(d("riskAccountComment").value||"").trim();if(!g)throw new Error("risk comment is required");const b=await A(`/oms/risk/${p}/status`,{method:"POST",body:{status:"blocked",comment:g}},c);_("risk_set_account_blocked",b)}catch(c){_("risk_set_account_blocked_error",{error:String(c)})}}),d("riskAllowStrategyBtn").addEventListener("click",async()=>{try{const c=C(),p=U("riskStrategyAccountId","risk_strategy"),g=Number(d("riskStrategyId").value||0),b=String(d("riskStrategyComment").value||"").trim();if(!Number.isFinite(g)||g<0)throw new Error("strategy_id inválido");if(!b)throw new Error("risk comment is required");const v=await A(`/oms/risk/${p}/strategies/allow_new_positions`,{method:"POST",body:{strategy_id:g,allow_new_positions:!0,comment:b}},c);_("risk_allow_strategy",v)}catch(c){_("risk_allow_strategy_error",{error:String(c)})}}),d("riskBlockStrategyBtn").addEventListener("click",async()=>{try{const c=C(),p=U("riskStrategyAccountId","risk_strategy"),g=Number(d("riskStrategyId").value||0),b=String(d("riskStrategyComment").value||"").trim();if(!Number.isFinite(g)||g<0)throw new Error("strategy_id inválido");if(!b)throw new Error("risk comment is required");const v=await A(`/oms/risk/${p}/strategies/allow_new_positions`,{method:"POST",body:{strategy_id:g,allow_new_positions:!1,comment:b}},c);_("risk_block_strategy",v)}catch(c){_("risk_block_strategy_error",{error:String(c)})}}),d("riskLoadPermissionsBtn").addEventListener("click",async()=>{try{await Vo()}catch(c){_("risk_load_permissions_error",{error:String(c)})}}),d("riskSavePermissionBtn").addEventListener("click",async()=>{try{const c=C(),p=Number(d("riskApiKeyId").value||0),g=U("riskPermAccountId","risk_permission");if(!Number.isFinite(p)||p<=0)throw new Error("risk api_key_id is required");const b={account_id:g,can_read:d("riskCanRead").checked,can_trade:d("riskCanTrade").checked,can_close_position:d("riskCanClosePosition").checked,can_risk_manage:d("riskCanRiskManage").checked,can_block_new_positions:d("riskCanBlockNewPositions").checked,can_block_account:d("riskCanBlockAccount").checked,restrict_to_strategies:d("riskRestrictStrategies").checked,strategy_ids:ht(d("riskStrategyIdsCsv").value)},v=await A(`/admin/api-keys/${p}/permissions`,{method:"PUT",body:b},c);_("risk_save_permission",{api_key_id:p,account_id:g,out:v}),await Vo(c)}catch(c){_("risk_save_permission_error",{error:String(c)})}});const f=d("adminCreateUserApiKeyForm"),y=d("userProfileRole"),S=f.querySelector("select[name='role']"),P=f.querySelector("textarea[name='permissions']");y.addEventListener("change",()=>{const c=String(y.dataset.currentValue||y.value||"");y.value=c});const $=()=>{const c=String(S.value||"trader").trim();P.value=JSON.stringify($i(c),null,2)};S.addEventListener("change",$),$()}function N(t){let e=t==="user"?"userProfile":t;e==="risk"&&(e="riskAccounts");const s=new Set(["login","userProfile","userApiKeys","commands","positions","postTrading","system","strategies","riskAccounts","riskApiKeys","admin","adminUsers","adminApiKeys","adminStatus","adminOms"]).has(e)?e:"login";localStorage.setItem(M.activeMenu,s);const r=s==="login",i=s==="userProfile",a=s==="userApiKeys",l=i||a,u=s==="commands",h=s==="positions",f=u||h,y=s==="postTrading",S=s==="system",P=s==="strategies",$=s==="riskAccounts",c=s==="riskApiKeys",p=$||c,g=s==="admin",b=s==="adminUsers",v=s==="adminApiKeys",k=s==="adminStatus",E=s==="adminOms",I=(x,H)=>{const ne=d(x);ne.classList.toggle("active",H),ne.setAttribute("variant","neutral")};I("tabLoginBtn",r),I("tabUserProfileBtn",i),I("tabUserApiKeysBtn",a),I("tabCommandsBtn",u),I("tabPositionsBtn",h),I("tabPostTradingOrdersBtn",y),I("tabSystemBtn",S),I("tabStrategiesBtn",P),I("tabRiskAccountsBtn",$),I("tabRiskApiKeysBtn",c),I("tabAdminBtn",g),I("tabAdminUsersBtn",b),I("tabAdminApiKeysBtn",v),I("tabAdminStatusBtn",k),I("tabAdminOmsBtn",E),d("tabUserGroupBtn").classList.toggle("active",l),d("tabOmsGroupBtn").classList.toggle("active",f),d("tabPostTradingGroupBtn").classList.toggle("active",y),d("tabRiskGroupBtn").classList.toggle("active",p);const D=g||b||v||k||E;d("tabAdminGroupBtn").classList.toggle("active",D),d("userSubmenu").classList.toggle("is-hidden",!l),d("omsSubmenu").classList.toggle("is-hidden",!f),d("riskSubmenu").classList.toggle("is-hidden",!p),d("adminSubmenu").classList.toggle("is-hidden",!D),d("postTradingSubmenu").classList.toggle("is-hidden",!y),d("loginPanel").classList.toggle("is-hidden",!r),d("userPanel").classList.toggle("is-hidden",!l),d("commandsPanel").classList.toggle("is-hidden",!u),d("positionsPanel").classList.toggle("is-hidden",!h),d("postTradingPanel").classList.toggle("is-hidden",!y),d("systemPanel").classList.toggle("is-hidden",!S),d("strategiesPanel").classList.toggle("is-hidden",!P),d("riskPanel").classList.toggle("is-hidden",!p),d("riskAccountsSection").classList.toggle("is-hidden",!$),d("riskApiKeysSection").classList.toggle("is-hidden",!c),d("adminPanel").classList.toggle("is-hidden",!(g||b||v||k)),d("adminOmsPanel").classList.toggle("is-hidden",!E),d("adminStatusSection").classList.toggle("is-hidden",!k),d("adminAccountsSection").classList.toggle("is-hidden",!g),d("adminUsersSection").classList.toggle("is-hidden",!b),d("adminApiKeysSection").classList.toggle("is-hidden",!v),window.scrollTo({top:0,left:0,behavior:"auto"});const O=document.querySelector(".main-content");if(O&&typeof O.scrollTo=="function"&&O.scrollTo({top:0,left:0,behavior:"auto"}),g&&Promise.all([kt(),Ms(),At()]).catch(x=>{_("admin_load_accounts_error",{error:String(x)})}),k&&At().catch(x=>{_("admin_system_status_load_error",{error:String(x)})}),b&&Promise.all([Yt(),Oe()]).catch(x=>{_("admin_load_users_error",{error:String(x)})}),v&&Promise.all([Oe()]).catch(x=>{_("admin_load_users_keys_error",{error:String(x)})}),E&&_e(!0).catch(x=>{_("admin_oms_load_error",{error:String(x)})}),l){const x=document.getElementById("userProfileSection"),H=document.getElementById("userApiKeysSection");x&&x.classList.toggle("is-hidden",!i),H&&H.classList.toggle("is-hidden",!a),Promise.all([Zt(),Ct(),xt()]).catch(ne=>{_("user_load_error",{error:String(ne)})})}y&&st(!0).catch(x=>{_("post_trading_load_error",{error:String(x)})}),(u||P)&&ve().catch(x=>{_("trade_load_strategies_error",{error:String(x)})}),p&&Se().catch(x=>{_("risk_load_accounts_error",{error:String(x)})})}function wa(){const t=se(M.baseUrls),e=se(M.apiKeys),o=se(M.accountIds),s=se(M.strategyIds),r=String(localStorage.getItem(M.themeMode)||"system").trim();wt(r,!1);const i=String(localStorage.getItem(M.densityMode)||"normal").trim();$t(i,!1);const a=String(localStorage.getItem(M.language)||"pt-BR").trim();m.locale=je[a]?a:"pt-BR",Ni(m.locale),hs(),t[0]?d("baseUrl").value=String(t[0]):d("baseUrl").value="http://127.0.0.1:8000",e[0]&&(d("apiKey").value=String(e[0]));const l=o[0]?String(o[0]):"1";d("sendAccountId").value=l,d("ccxtAccountId").value=l,d("cancelOrderAccountId").value=l,d("closePositionAccountId").value=l,d("riskAccountId").value=l,d("riskStrategyAccountId").value=l,d("riskPermAccountId").value=l,cs([]),ls([]);const u=s[0]!==void 0?String(s[0]):"0";d("sendStrategyId").value=u,d("ccxtStrategyId").value=u;const h=d("adminExchangeIdSelect");if(h.options.length===0){const f=document.createElement("option");f.value="",f.textContent="",h.appendChild(f),h.value=""}ea();for(const f of _o){const y=document.getElementById(`${f}PageSize`),S=Math.max(1,Number(y?.value||m.omsPageSize));m.omsPager[f]={page:1,pageSize:S,total:0,totalPages:1},Ss(f)}Bt()}function Mt(){return String(m.adminOmsView||"open_orders")}function oe(t,e){const o=document.getElementById("postTradingMessage");if(o){if(!e){o.textContent="",o.classList.add("is-hidden"),o.classList.remove("notice-success","notice-error","notice-info");return}o.textContent=String(e),o.classList.remove("is-hidden","notice-success","notice-error","notice-info"),t==="success"?o.classList.add("notice-success"):t==="error"?o.classList.add("notice-error"):o.classList.add("notice-info"),T(t,String(e),{source:"post_trading"})}}function Ns(){const t=String(document.getElementById("postTradingAccountIds")?.value||"").trim();if(t)return t;const e=Pe();return e.length>0?e.join(","):""}function zs(t=!1){const e=m.omsPager.postTrading,o=t?1:Math.max(1,Number(e?.page||1)),s=Math.max(1,Number(e?.pageSize||m.omsPageSize)),r=String(document.getElementById("postTradingStartDate")?.value||"").trim(),i=String(document.getElementById("postTradingEndDate")?.value||"").trim(),a=document.getElementById("postTradingReconciled"),l=a?[...a.selectedOptions].map($=>String($.value||"").trim().toLowerCase()).filter($=>!!$):["true","false"],u=String(document.getElementById("postTradingOrderStatuses")?.value||"").trim(),h=new Set(l),f=h.has("true"),y=h.has("false"),S=f&&!y?!0:y&&!f?!1:void 0,P=u?u.split(",").map($=>String($||"").trim()).filter($=>!!$):[];return{account_ids:Ns(),start_date:r||null,end_date:i||null,...S===void 0?{}:{reconciled:S},reconciled_values:l,order_statuses:P,kinds:["order"],preview:!0,page:o,page_size:s}}async function st(t=!1){const e=C(),o=zs(t),s=await A("/oms/reassign",{method:"POST",body:o},e);let r=Array.isArray(s.items)?s.items:[];const i=new Set((o.reconciled_values||[]).map(l=>String(l||"").toLowerCase()));i.size>0&&i.size<2&&(r=r.filter(l=>{const u=l?.reconciled;if(u==null)return!1;const h=u?"true":"false";return i.has(h)}));const a=r.map(l=>{const u=Number(l?.strategy_id||0);return{...l,target_strategy_id:u>0?u:null}});m.tables.postTrading.setData(a),m.postTradingLastPreview=s,Ot("postTrading",Number((s.deals_total||0)+(s.orders_total||0)),Number(s.page||o.page),Number(s.page_size||o.page_size)),oe("info",n("post_trading.preview_result","Preview: deals={deals} orders={orders}").replace("{deals}",String(s.deals_total||0)).replace("{orders}",String(s.orders_total||0)))}async function va(){const t=C(),e=String(document.getElementById("postTradingReconcileScope")?.value||"short").trim().toLowerCase(),o=String(document.getElementById("postTradingStartDate")?.value||"").trim(),s=String(document.getElementById("postTradingEndDate")?.value||"").trim(),r={account_ids:Ns(),scope:e};if(e==="period"){if(!o||!s)throw new Error("period_requires_date_range");r.start_date=o,r.end_date=s}const i=await A("/oms/reconcile",{method:"POST",body:r},t);oe("success",n("post_trading.reconcile_ok","Reconciliação disparada: {count} conta(s).").replace("{count}",String(i?.triggered_count||0))),_("post_trading_reconcile",i)}async function Sa(){const t=m.tables.postTrading;if(!t)return;const e=t.getSelectedData?t.getSelectedData():[];if(!Array.isArray(e)||e.length===0)throw new Error("post_trading_select_rows");const o=C(),s=zs(!1),r=new Map;for(const l of e){const u=Number(l?.id||0),h=Number(l?.target_strategy_id||0);if(!Number.isFinite(u)||u<=0)continue;if(!Number.isFinite(h)||h<=0)throw new Error("post_trading_target_strategy_required");const f=String(h);r.has(f)||r.set(f,{targetStrategyId:h,orderIds:[]}),r.get(f).orderIds.push(u)}if(r.size===0)throw new Error("post_trading_select_rows");let i=0,a=0;for(const l of r.values()){const u=await A("/oms/reassign",{method:"POST",body:{...s,preview:!1,target_strategy_id:Number(l.targetStrategyId),order_ids:[...new Set(l.orderIds)]}},o);i+=Number(u?.deals_updated||0),a+=Number(u?.orders_updated||0)}oe("success",n("post_trading.apply_result","Applied: deals_updated={deals} orders_updated={orders}").replace("{deals}",String(i)).replace("{orders}",String(a))),_("post_trading_apply",{deals_updated:i,orders_updated:a,groups:r.size}),await st(!1)}function Rs(t){return t==="open_orders"||t==="history_orders"?"orders":t==="open_positions"||t==="history_positions"?"positions":"deals"}function ka(){const t=String(document.getElementById("adminOmsStartDate")?.value||"").trim(),e=String(document.getElementById("adminOmsEndDate")?.value||"").trim();if(t&&!e||!t&&e)throw new Error("start_date and end_date must be together");return{start:t,end:e}}function Aa(){const t=String(document.getElementById("adminOmsAccountIds")?.value||"").trim();if(t)return t;const e=Pe();return e.length>0?e.join(","):""}function Fs(){return!!document.getElementById("adminOmsUnsafeToggle")?.checked}function Us(t){return new Promise(e=>{const o=document.getElementById("adminOmsConfirmDialog"),s=document.getElementById("adminOmsConfirmText"),r=document.getElementById("adminOmsConfirmOkBtn"),i=document.getElementById("adminOmsConfirmCancelBtn");if(!o||!r||!i){e(!1);return}s&&(s.textContent=String(t||"Confirm?"));const a=()=>{r.removeEventListener("click",l),i.removeEventListener("click",u),o.open=!1},l=()=>{a(),e(!0)},u=()=>{a(),e(!1)};r.addEventListener("click",l),i.addEventListener("click",u),o.open=!0})}function qs(t){const e={};for(const[o,s]of Object.entries(t||{}))o.startsWith("_")||s!==void 0&&(e[o]=s);return e}function Ks(){const t=new Date,e=t.getUTCFullYear(),o=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0"),r=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0"),a=String(t.getUTCSeconds()).padStart(2,"0");return`${e}-${o}-${s} ${r}:${i}:${a}`}function Ca(t){const e={...t||{}},o=Ks(),s=r=>{const i=e[r],a=String(i??"").trim().toLowerCase();(i==null||a===""||a==="null")&&(e[r]=o)};for(const r of["created_at","updated_at","opened_at","executed_at"])s(r);return e}function Hs(t){const o=(Array.isArray(t?.results)?t.results:[]).filter(i=>i&&i.ok===!1);if(o.length===0)return;const s=o[0]||{},r=String(s.error||"unknown_error");throw new Error(r)}function js(t){const o=(Array.isArray(t?.results)?t.results:[]).filter(s=>s&&s.ok===!0&&Number(s.id||0)>0).map(s=>Number(s.id)).filter((s,r,i)=>i.indexOf(s)===r);return o.length===0?"":` IDs: ${o.join(", ")}`}async function _e(t=!1){const e=C(),o=Mt(),s=m.omsPager.adminOms,r=t?1:Math.max(1,Number(s?.page||1)),i=Math.max(1,Number(s?.pageSize||m.omsPageSize)),{start:a,end:l}=ka(),u=Aa(),h=new URLSearchParams({account_ids:u,page:String(r),page_size:String(i)});a&&l&&(h.set("start_date",a),h.set("end_date",l));const f=await A(`/admin/oms/${encodeURIComponent(o)}?${h.toString()}`,{},e),y=m.tables.adminOms;if(y){const S=Es(o);de(y,S),y.setData(Array.isArray(f.items)?f.items:[])}Ot("adminOms",Number(f.total||0),Number(f.page||r),Number(f.page_size||i))}function xa(){const t=Mt(),e=m.tables.adminOms;if(!e)return;const o=Number(Pe()[0]||m.availableAccountIds[0]||0),s={account_id:o>0?o:"",created_at:Ks()};t.includes("orders")?Object.assign(s,{symbol:"BTC/USDT",side:"buy",order_type:"market",status:"SUBMITTED",qty:"0",strategy_id:0,position_id:0,reason:"admin",filled_qty:"0"}):t.includes("positions")?Object.assign(s,{symbol:"BTC/USDT",side:"buy",qty:"0",avg_price:"0",strategy_id:0,state:"open",reason:"admin"}):Object.assign(s,{order_id:null,position_id:0,symbol:"BTC/USDT",side:"buy",qty:"0",price:"0",strategy_id:0,reason:"admin",reconciled:!0});const r=e.addData([s],!0);if(r&&typeof r.then=="function"){r.then(i=>{Array.isArray(i)&&i[0]&&typeof i[0].select=="function"&&i[0].select()}).catch(()=>{});return}Array.isArray(r)&&r[0]&&typeof r[0].select=="function"&&r[0].select()}async function La(){const t=C(),e=m.tables.adminOms;if(!e)return;const o=e.getSelectedData?e.getSelectedData():[];if(!Array.isArray(o)||o.length===0)throw new Error("admin_oms_select_rows");if(!Fs())throw new Error("admin_oms_unlock_required");if(!await Us(n("admin.oms_confirm_save",`Save ${o.length} row(s) to database?`).replace("{count}",String(o.length))))return;const r=Mt(),i=Rs(r),a=o.map(u=>{let h=qs(u);const f=Number(h.id||0);return f<=0&&(h=Ca(h)),{op:f>0?"update":"insert",row:h}}),l=await A(`/admin/oms/${i}/mutate`,{method:"POST",body:a},t);Hs(l),_("admin_oms_save_selected",l),T("info","Admin OMS save selected",{entity:i,count:a.length}),Q("success",n("admin.oms_save_success",`Saved successfully (${a.length} row(s)).`).replace("{count}",String(a.length))+js(l)),await _e(!1)}async function Ea(){const t=C(),e=m.tables.adminOms;if(!e)return;const o=e.getSelectedData?e.getSelectedData():[];if(!Array.isArray(o)||o.length===0)throw new Error("admin_oms_select_rows");if(!Fs())throw new Error("admin_oms_unlock_required");const s=Mt(),r=Rs(s),i=o.map(u=>qs(u)).filter(u=>Number(u.id||0)>0).map(u=>({op:"delete",row:{id:Number(u.id),account_id:Number(u.account_id||0)||null}}));if(i.length===0)throw new Error("only rows with id can be deleted");if(!await Us(n("admin.oms_confirm_delete",`DELETE ${i.length} row(s) from database?`).replace("{count}",String(i.length))))return;const l=await A(`/admin/oms/${r}/mutate`,{method:"POST",body:i},t);Hs(l),_("admin_oms_delete_selected",l),T("warn","Admin OMS delete selected",{entity:r,count:i.length}),Q("success",n("admin.oms_delete_success",`Deleted successfully (${i.length} row(s)).`).replace("{count}",String(i.length))+js(l)),await _e(!1)}ha();wa();ba();vs().catch(()=>{});{const t=String(localStorage.getItem(M.activeMenu)||"login").trim();N(t)}ke("ready",!1);Se().catch(t=>{_("accounts_error",{error:String(t)})});
